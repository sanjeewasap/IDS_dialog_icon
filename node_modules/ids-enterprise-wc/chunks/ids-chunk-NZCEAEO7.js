import{a as V}from"./ids-chunk-YXHOBTS7.js";import{a as q}from"./ids-chunk-J3OLORFB.js";import{a as W}from"./ids-chunk-E2RRN5KD.js";import{a as R}from"./ids-chunk-N7RNTKMO.js";import{a as C,b as T,c as O,f as E,g as m,h as x,j as A}from"./ids-chunk-4W3JMIJK.js";import{a as $}from"./ids-chunk-AKCO43TX.js";import{a as L,b as _}from"./ids-chunk-CK6SA7FU.js";import{a as S,b as M}from"./ids-chunk-XE4WFW5M.js";import{a as N}from"./ids-chunk-GFV2Z7F5.js";import{e as p,f as g}from"./ids-chunk-QPDOZZIG.js";import{a as s}from"./ids-chunk-EQJWBFQ2.js";import{a as I}from"./ids-chunk-U7OOVFXE.js";var z=`
:host {
  contain: content;
  height: 100%;
}

.ids-week-view {
  display: flex;
  background-color: var(--ids-week-view-color-background);
  color: var(--ids-week-view-color-text);
  border: 1px solid var(--ids-week-view-color-border);
  flex-direction: column;
  overflow: hidden;
  max-height: calc(100vh - 25px);
}
.ids-week-view .week-view-table-header th {
  background-clip: padding-box;
  border-top: 0;
  height: 24px;
  line-height: 24px;
  text-align: left;
  z-index: 3;
}
.ids-week-view .week-view-table-header .week-view-header-wrapper {
  padding: 0 5px;
  text-align: center;
}
.ids-week-view .week-view-table-header .week-view-header-wrapper .week-view-header-day-of-week {
  line-height: var(--ids-week-view-row-height);
}
.ids-week-view .week-view-table-header .week-view-header-wrapper.is-day-view .week-view-header-day-of-week.is-emphasis {
  line-height: 40px;
}
.ids-week-view .week-view-table-header .week-view-all-day-wrapper {
  position: relative;
  box-sizing: border-box;
  border-color: var(--ids-week-view-color-border);
  height: 44px;
  text-transform: unset;
  border-top-width: 1px;
  border-top-style: solid;
}
.ids-week-view .week-view-table-header th:nth-child(1) .week-view-all-day-wrapper {
  border-top-color: transparent;
  padding: 5px;
}
.ids-week-view .week-view-table {
  border-collapse: separate;
  border-spacing: 0;
  width: 100%;
}
.ids-week-view .week-view-table .week-view-allday-row {
  height: 40px;
}
.ids-week-view .week-view-table .week-view-hour-row,
.ids-week-view .week-view-table .week-view-half-hour-row {
  height: var(--ids-week-view-row-height);
}
.ids-week-view .week-view-table th,
.ids-week-view .week-view-table td {
  border-bottom: 1px solid;
  border-color: var(--ids-week-view-color-border);
  padding: 0;
  height: var(--ids-week-view-row-height);
}
.ids-week-view .week-view-table th:nth-child(1) {
  width: 60px;
}
.ids-week-view .week-view-table tr td:nth-child(1) .week-view-cell-wrapper {
  padding: 0 5px;
}
.ids-week-view .week-view-table tr:nth-child(odd) td {
  border-bottom: 1px solid var(--ids-week-view-row-odd-color-border);
}
.ids-week-view .week-view-table th:not(:last-child),
.ids-week-view .week-view-table td:not(:last-child) {
  border-right-width: 1px;
  border-right-style: solid;
}
.ids-week-view .week-view-header-wrapper.is-today {
  color: var(--ids-week-view-today-color);
  box-shadow: 0 4px 0 0 var(--ids-week-view-today-color);
}
.ids-week-view .week-view-container {
  background-color: var(--ids-week-view-color-background);
  overflow: auto;
}
.ids-week-view .week-view-container th {
  background-color: var(--ids-week-view-header-color-background);
  position: sticky;
  top: 0;
  z-index: 3;
}
.ids-week-view .week-view-cell-wrapper {
  position: relative;
  padding: 0;
  height: var(--ids-week-view-row-height);
  min-width: 50px;
}
.ids-week-view .week-view-time-marker {
  display: block;
  position: relative;
  z-index: 2;
  box-sizing: border-box;
  border: 1px solid var(--ids-week-view-time-marker-color);
  height: 1px;
  margin-top: -2px;
  top: var(--timeline-shift);
}

ids-toolbar ids-menu-button[menu=view-picker] {
  margin-inline-end: 8px;
}

:host([dir=rtl]) .week-view-all-day-wrapper {
  text-align: right;
}
:host([dir=rtl]) .ids-week-view .week-view-table th:not(:first-child),
:host([dir=rtl]) .ids-week-view .week-view-table td:not(:first-child) {
  border-right-width: 1px;
  border-right-style: solid;
}
:host([dir=rtl]) .ids-week-view .week-view-table th:first-child,
:host([dir=rtl]) .ids-week-view .week-view-table td:first-child {
  border-right-width: 0;
}`;var F=q(V(R($(N)))),k=class extends F{dayMap=[];vetoableEventTypes=["beforeweekrendered"];ro=null;constructor(){super()}connectedCallback(){super.connectedCallback(),this.setDirection(),this.#e(),this.#o()}disconnectedCallback(){super.disconnectedCallback(),this.timer?.destroy(),this.timer=null,this.state={},this.ro?.unobserve(this.container),this.ro=null}static get attributes(){return[...super.attributes,s.END_DATE,s.END_HOUR,s.FIRST_DAY_OF_WEEK,s.SHOW_TIMELINE,s.SHOW_TODAY,s.START_DATE,s.START_HOUR,s.TIMELINE_INTERVAL]}template(){return'<div class="ids-week-view"></div>'}#o(){return this.ro=new ResizeObserver(e=>{requestAnimationFrame(()=>{for(let t of e)t.contentRect.width>0&&this.#s()})}),this.ro.observe(this.container),this}onLocaleChange=()=>{this.#e()};onLanguageChange=()=>{this.#e(),this.#s()};changeDate(e){let t=E(this.startDate,this.endDate),r=t!==7,i,a;e==="next"&&(i=m(this.startDate,t,"days"),a=m(this.endDate,t-1,"days")),e==="previous"&&(i=x(this.startDate,t,"days"),a=x(this.endDate,t+1,"days")),e==="today"&&(i=r?new Date:T(new Date,this.firstDayOfWeek),a=m(i,t-1,"days")),this.#l(()=>{this.startDate=i,this.endDate=a}),this.state.activeDate=this.startDate,this.triggerDateChange(this.startDate,e)}#l(e){this.state.wait=!0,e(),this.state.wait=!1,this.#e()}#e(){if(!this.locale||this.state.wait||!this.container||!this.triggerVetoableEvent("beforeweekrendered"))return;let t=E(this.startDate,this.endDate),r=this.endHour-this.startHour+1,i=t===1||t===0,a=this.localeAPI.locale.options.calendars,v=a[0]?.dateFormat?.dayOfWeek,d=v&&v.split(" ")[0]==="EEE",n=u=>u?i?32:20:16;this.dayMap=[];let w=Array.from({length:t},(u,c)=>{let l=this.startDate.setDate(this.startDate.getDate()+c),D=this.localeAPI.formatDate(l,{day:"numeric"}),H=this.localeAPI.formatDate(l,{weekday:"short"}),y=C(new Date(l));return`
        <th data-key="${this.generateDateKey(new Date(l))}">
          <div class="week-view-header-wrapper${y?" is-today":""}${i?" is-day-view":""}">
            <ids-text
              class="week-view-header-day-of-week${d?"":" is-emphasis"}"
              font-size="${n(!d)}"
              ${y?'font-weight="semi-bold"':""}
            >${d?H:D}</ids-text>
            <ids-text
              class="week-view-header-day-of-week${d?" is-emphasis":""}"
              font-size="${n(d)}"
              ${y?'font-weight="semi-bold"':""}
            >${d?D:H}</ids-text>
          </div>
          <div class="week-view-all-day-wrapper"></div>
        </th>
      `}).join(""),o=Array.from({length:t}).map((u,c)=>{let l=this.startDate;return l.setDate(l.getDate()+c),`<td data-date="${l.getDate()}">
        <div class="week-view-cell-wrapper"></div>
      </td>`}).join(""),h=this.startHour,f=Array.from({length:r}).map((u,c)=>{let l=h+c;return`
      <tr class="week-view-hour-row" data-hour="${l}">
        <td>
          <div class="week-view-cell-wrapper">
            <ids-text font-size="12">${a?this.localeAPI.formatHour(this.startHour+c):""}</ids-text>
          </div>
        </td>
        ${o}
      </tr>
      <tr class="week-view-half-hour-row" data-hour="${l}.5">
        <td>
          <div class="week-view-cell-wrapper"></div>
        </td>
        ${o}
      </tr>`}).join(""),b=`<div class="week-view-container">
      <table class="week-view-table">
        <thead class="week-view-table-header">
          <tr>
            <th>
              <div class="week-view-header-wrapper${i?" is-day-view":""}">
                <ids-text translate-text="true" audible="true">Hour</ids-text>
              </div>
              <div class="week-view-all-day-wrapper">
                <ids-text font-size="12" translate-text="true">AllDay</ids-text>
              </div>
            </th>
            ${w}
          </tr>
        </thead>
        <tbody>
          ${f}
        </tbody>
      </table>
    </div>`;this.container.querySelector(".week-view-container")?.remove(),this.container.insertAdjacentHTML("beforeend",b),this.state.hasRendered=!0,this.triggerEvent("afterweekrendered",this),this.container.querySelectorAll("th").forEach(u=>{let c=u.getAttribute("data-key");if(c){let l=parseInt(c);this.dayMap.push({key:l,elem:u})}}),this.#t(),this.renderEventsData()}#t(){if(this.container?.querySelectorAll(".week-view-time-marker").forEach(a=>a.remove()),this.timer&&this.timer?.destroy(!0),!this.showTimeline||!this.state.hasRendered)return;this.container?.querySelectorAll(".week-view-hour-row:nth-child(1) td").forEach(a=>a.insertAdjacentHTML("afterbegin",'<div class="week-view-time-marker"></div>'));let e=this.endHour-this.startHour+1,t=this.container?.querySelector(".week-view-hour-row"),r=this.timelineInterval,i=()=>{let a=new Date,v=a.getHours(),d=a.getMinutes(),n=v-this.startHour+d/60,w=a.getTime()-this.startDate.getTime(),o=n>0&&n<=e?n*52:0;t&&(t.style.setProperty("--timeline-shift",`${o}px`),t.dataset.diffInMilliseconds=w.toString())};i(),this.#d(),this.#i=L(()=>i(),r)}#d(){this.#i&&_(this.#i)}#i;#s(){let e=this.container?.offsetTop;this.container?.style.setProperty("--offset-top",`${e}px`)}#a(e,t){let r=e.getHours(),i=e.getMinutes(),a=e.getSeconds();return t?r+(i>=30?.5:0):r+i/60+a/600}async renderEventsData(e=!1){if(!e&&typeof this.state.beforeEventsRender=="function"){this.eventsData=await this.state.beforeEventsRender(this.startDate,this.endDate);return}this.removeAllEvents(),!(!this.state.hasRendered||!this.eventsData?.length)&&this.eventsData.forEach(t=>{let r=new Date(t.starts),i=new Date(t.ends);this.startDate<=i&&r<this.endDate&&this.#w(t)})}#h(e){let t=new Date(e.starts),r=t.getDate(),i=this.#a(t,!0);return this.container?.querySelector(`[data-hour="${i}"] [data-date="${r}"]`)||null}#r(e,t){let r=new W,i=this.eventTypesData?.find(a=>a.id===e.type);return r.eventTypeData=i,r.eventData=e,t?.length&&(r.cssClass=t),r}#w(e){let t,r,i=new Date(e.starts),a=new Date(e.ends),v=this.generateDateKey(i),d=this.generateDateKey(a),n=this.dayMap.filter(o=>o.key>=v&&o.key<=d),w=p(e.isAllDay);if(n.length===1&&!w){t=this.#r(e),r=this.#h(e),r&&this.#c(r,t);return}if(n.length===1&&w){t=this.#r(e,["all-day"]),r=n[0].elem.querySelector(".week-view-all-day-wrapper"),r&&this.#n(r,t);return}if(n.length>1&&w)for(let o=0;o<n.length;o++){let h=o===0?"calendar-event-start":"calendar-event-continue";o===n.length-1&&(h="calendar-event-ends"),t=this.#r(e,["all-day",h]),r=n[o].elem.querySelector(".week-view-all-day-wrapper"),r&&this.#n(r,t)}}#c(e,t){let r=parseFloat(e.parentElement?.getAttribute("data-hour")||""),i=this.#a(t.startDate,!1),a=e.querySelector(".week-view-cell-wrapper"),v=.25,d=this.endHour+1-i,n=t.duration;if(n=Math.max(v,n),n=Math.min(d,n),t.height=`${n*50+n/.5-1}px`,n<.5&&(t.cssClass=["reduced-padding"]),n<1.5&&(t.cssClass=["is-ellipsis"]),n>=2&&(t.displayTime=!0,t.overflow="normal"),i+n>this.endHour&&(t.cssClass=["is-cutoff"]),i>r){let h=.016666666666666784,f=i-r,b=e.parentElement?.offsetHeight||26;t.yOffset=`${f/h*(b/30)}px`}let w=e.querySelectorAll("ids-calendar-event"),o=w.length;if(o>0){let h=100/(o+1);t.width=`${h}%`,t.xOffset=`${h*o}%`,w.forEach((f,b)=>{f.width=`${h}%`,f.xOffset=`${h*b}%`})}this.triggerEvent("beforeeventrendered",this,{detail:{elem:this,events:this.eventsData,event:t,dateCell:t,container:a},bubbles:!0}),a?.appendChild(t),this.triggerEvent("aftereventrendered",this,{detail:{elem:this,events:this.eventsData,event:t,dateCell:t,container:a},bubbles:!0})}#n(e,t){let i=e.querySelectorAll("ids-calendar-event").length;i>=1&&(t.yOffset=`${22*i}px`),i>=2&&this.container?.querySelectorAll(".week-view-all-day-wrapper").forEach(a=>{a.style.height=`${44+(i-1)*23}px`}),this.triggerEvent("beforeeventrendered",this,{detail:{elem:this,events:this.eventsData,event:t,dateCell:t,container:e},bubbles:!0}),e.appendChild(t),this.triggerEvent("aftereventrendered",this,{detail:{elem:this,events:this.eventsData,event:t,dateCell:t,container:e},bubbles:!0})}get showToday(){let e=this.getAttribute(s.SHOW_TODAY);return p(e)}set showToday(e){p(e)?this.setAttribute(s.SHOW_TODAY,"true"):this.removeAttribute(s.SHOW_TODAY),this.#e()}get startDate(){let e=this.getAttribute(s.START_DATE),t=new Date(e??"");return e&&A(t)?t:T(new Date,this.firstDayOfWeek)}set startDate(e){e?this.setAttribute(s.START_DATE,e.toString()):this.removeAttribute(s.START_DATE),this.#e()}get endDate(){let e=this.getAttribute(s.END_DATE),t=new Date(e??"");return e&&A(t)?m(t,1,"days"):O(new Date,this.firstDayOfWeek)}set endDate(e){e?this.setAttribute(s.END_DATE,e.toString()):this.removeAttribute(s.END_DATE),this.#e()}onFirstDayOfWeekChange(){this.#e()}get startHour(){let e=this.getAttribute(s.START_HOUR),t=g(e);return e&&t>=0&&t<=24?t:7}set startHour(e){e!==null?this.setAttribute(s.START_HOUR,String(e)):this.removeAttribute(s.START_HOUR),this.#e()}get endHour(){let e=this.getAttribute(s.END_HOUR),t=g(e);return e&&t>=0&&t<=24?t:19}set endHour(e){e!==null?this.setAttribute(s.END_HOUR,String(e)):this.removeAttribute(s.END_HOUR),this.#e()}get showTimeline(){let e=this.getAttribute(s.SHOW_TIMELINE);return e?p(e):!0}set showTimeline(e){let t=p(e);this.setAttribute(s.SHOW_TIMELINE,String(t)),this.#t()}get timelineInterval(){let e=this.getAttribute(s.TIMELINE_INTERVAL),t=g(e);return t>0?t:3e4}set timelineInterval(e){e?this.setAttribute(s.TIMELINE_INTERVAL,String(e)):this.removeAttribute(s.TIMELINE_INTERVAL),this.#t()}};k=I([S("ids-week-view"),M(z)],k);export{k as a};
