import{a as m,b as S,c as w,h as F}from"./ids-chunk-GX2AIROS.js";import{b as M}from"./ids-chunk-UR2NLGN4.js";function H(L){return typeof L=="string"||L instanceof String}var E=class{process(e,a={}){if(typeof e!="string")throw new Error("No string provided");a.selection||(a.selection={start:0});let n={},r={originalValue:e,caretPos:a?.selection?.start||0,maskResult:!1};if(typeof a.pattern=="function"){a.patternOptions||(a.patternOptions={});let i=M(a.patternOptions);if(i.caretPos=a.selection.start,i.previousMaskResult=a.previousMaskResult,i.locale=a.locale,n=a.pattern(e,i),Array.isArray(n)&&(n={caretTrapIndexes:[],mask:n}),Array.isArray(n.mask)){let p=this.processCaretTraps(n.mask);n.mask=p.maskWithoutCaretTraps,n.caretTrapIndexes=p.indexes,a.caretTrapIndexes=p.indexes}}else n={caretTrapIndexes:[],mask:a.pattern};try{r=this.conformToMask(e,n,a)}catch{return r}if(typeof a.pipe=="function"){let i={};try{i=a.pipe(r,a)}catch{i=!1}i===!1?(r.pipeResult=!1,r.pipedValue=a.previousMaskResult):H(i)?(r.pipeResult=!0,r.pipedValue=i,r.pipedCharIndexes=[]):(r=M(r),r.pipeResult=i.result,r.pipedValue=i.value,r.pipedCharIndexes=i.characterIndexes)}return r}conformToMask(e,a,n){let r=M(F);Object.assign(r,n),r.placeholder=this.convertMaskToPlaceholder(a.mask,r.placeholderChar);let i=!1,p=r.guide===!1,P=e.length,R=r.previousMaskResult.length,v=a.mask.length,b=r.placeholder.length,g=r.placeholderChar,C=r.selection.start,c=m,u=P-R,l=u>0,o=C+(l?-u:0),A=o+Math.abs(u);if(r.keepCharacterPositions===!0&&!l){let t=m;for(let s=o;s<A;s++)r.placeholder[s]===g&&(t+=g);e=e.slice(0,o)+t+e.slice(o,P)}function d(t,s){return{char:t,isNew:s>=o&&s<A}}let x=e.split(m).map(d);for(let t=P-1;t>=0;t--){let s=x[t];if(s!==r.placeholderChar){let f=t>=o&&R===v;s===r.placeholder[f?t-u:t]&&x.splice(t,1)}}e:for(let t=0;t<b;t++){let s=r.placeholder[t];if(s===g){if(x.length>0)for(;x.length>0;){let f=x.shift(),O=e.slice(t,t+1);if(f.char===g&&p!==!0){c+=g;continue e}else if(a.literalRegex&&a.literalRegex.test(f.char)&&O&&(O===f.char||O===g)){if(l&&a.literals.indexOf(e[t-1])>-1){C++;continue e}let T=new RegExp(`(${f.char})`,"g"),k=r.placeholder.match(T).length;e.match(T)?.length<=k&&(c+=f.char);let y=r.placeholder.slice(t).indexOf(f.char);for(;y>0;)t++,y--;continue e}else if(a.mask[t].test(f.char)){if(r.keepCharacterPositions!==!0||f.isNew===!1||r.previousMaskResult===m||p||!l)c+=f.char;else{let T=x.length,k=null;for(let I=0;I<T;I++){let y=x[I];if(y.char!==g&&y.isNew===!1)break;if(y.char===g){k=I;break}}k!==null?(c+=f.char,x.splice(k,1)):t--}continue e}else i=!0}p===!1&&(c+=r.placeholder.substr(t,b));break}else c+=s}if(p&&l===!1){let t=null;for(let s=0;s<c.length;s++)r.placeholder[s]===g&&(t=s);t!==null?c=c.substr(0,t+1):e!==""&&c.indexOf(e)>-1?C+=e.length:c=m}return{caretPos:C,caretTrapIndexes:r.caretTrapIndexes,conformedValue:c,charactersRejected:i,placeholder:r.placeholder,placeholderChar:g,maskResult:!0}}processCaretTraps(e){let a=[],n=e.indexOf(w);for(;n!==-1;)a.push(n),e.splice(n,1),n=e.indexOf(w);return{maskWithoutCaretTraps:e,indexes:a}}convertMaskToPlaceholder(e,a=S){return e.map(n=>n instanceof RegExp?a:n).join(m)}adjustCaretPosition(e){if(e.caretPos===0)return 0;function a(l){return l!==a}let n=e.rawValue.length,r=e.previousMaskResult.length,i=e.placeholder?e.placeholder.length:0,p=e.conformedValue?e.conformedValue.length:0,P=n-r,R=P>0,v=r===0;if(P>1&&!R&&!v)return e.caretPos;let g=R&&(e.previousMaskResult===e.conformedValue||e.conformedValue===e.placeholder),C=0,c,u;if(g)C=e.caretPos-P;else{let l=e.conformedValue.toLowerCase(),d=e.rawValue.toLowerCase().substr(0,e.caretPos).split(m).filter(h=>l.indexOf(h)!==-1);u=d[d.length-1];let x=e.previousPlaceholder.substr(0,d.length).split(m).filter(a).length,s=e.placeholder.substr(0,d.length).split(m).filter(a).length!==x,f=e.previousPlaceholder[d.length-1]!==void 0&&e.placeholder[d.length-2]!==void 0&&e.previousPlaceholder[d.length-1]!==e.placeholderChar&&e.previousPlaceholder[d.length-1]!==e.placeholder[d.length-1]&&e.previousPlaceholder[d.length-1]===e.placeholder[d.length-2];!R&&(s||f)&&x>0&&e.placeholder.indexOf(u)>-1&&e.rawValue[e.caretPos]!==void 0&&(c=!0,u=e.rawValue[e.caretPos]);let O=[];e.indexesOfPipedChars&&(O=e.indexesOfPipedChars.map(h=>l[h]));let T=O.filter(h=>h===u).length,k=d.filter(h=>h===u).length,y=e.placeholder.substr(0,e.placeholder.indexOf(e.placeholderChar)).split(m).filter((h,V)=>h===u&&e.rawValue[V]!==h).length+k+T+(c?1:0),N=0;for(let h=0;h<p;h++){let V=l[h];if(C=h+1,V===u&&N++,N>=y)break}}if(R){let l=C;for(let o=C;o<=i;o++)if(!e.placeholder||(e.placeholder[o]===e.placeholderChar&&(l=o),e.placeholder[o]===e.placeholderChar||e.caretTrapIndexes.indexOf(o)!==-1||o===i))return l}else if(c){for(let l=C-1;l>=0;l--)if(e.conformedValue[l]===u||e.caretTrapIndexes.indexOf(l)!==-1||l===0)return l}else for(let l=C;l>=0;l--)if(e.placeholder[l-1]===e.placeholderChar||e.caretTrapIndexes.indexOf(l)!==-1||l===0)return l;return 0}getSafeRawValue(e){return typeof e=="string"?e:typeof e=="number"?String(e):""}},G=E;export{G as a};
