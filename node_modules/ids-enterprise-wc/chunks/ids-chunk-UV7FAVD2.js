import{a as r}from"./ids-chunk-EQJWBFQ2.js";var n=["contextmenu","click","custom","hover","immediate"],o=["click.trigger","contextmenu.trigger","hoverend.trigger","mouseenter.trigger","mouseleave.trigger","sloped-mouseleave.trigger"],g=s=>class extends s{constructor(...e){super(...e),this.state||(this.state={}),this.state.triggerType=n[0],this.state.triggerElem=null,this.state.currentTriggerElem=null}static get attributes(){return[...s.attributes,r.TARGET,r.TRIGGER_TYPE,r.TRIGGER_ELEM]}connectedCallback(){super.connectedCallback?.(),this.#e()}disconnectedCallback(){super.disconnectedCallback?.(),this.removeTriggerEvents()}#e(){let e=this.getAttribute(r.TARGET),t=e?this.parentNode?.querySelector(e):null;this.popup&&t&&!this.target&&(this.popup.alignTarget=t),(this.triggerElem||t)&&(this.removeTriggerEvents(),this.refreshTriggerEvents())}hasTriggerEvents=!1;popupDelay=500;get popup(){return this.shadowRoot?.querySelector("ids-popup")}get target(){return this.popup?.alignTarget??null}set target(e){if(this.popup&&e!==this.popup.alignTarget){let t=this.popup.alignTarget;this.removeTriggerEvents(),typeof e=="string"&&(e=this.parentNode?.querySelector(e)||this.parentNode),this.popup.alignTarget=e,this.refreshTriggerEvents(),typeof this.onTargetChange=="function"&&this.onTargetChange(t,e)}}get triggerType(){return this.state.triggerType}set triggerType(e){let t=this.state.triggerType,i=e;n.includes(e)||(i=n[0]),t!==i&&(this.removeTriggerEvents(),this.state.triggerType=i,this.refreshTriggerEvents())}get triggerElem(){return this.state.triggerElem}set triggerElem(e){if(typeof e=="string"){let t=this.parentNode?.querySelector(e);t&&(this.removeTriggerEvents(),this.state.triggerElem=t,this.refreshTriggerEvents())}}refreshTriggerEvents(){if(this.hasTriggerEvents||!this.popup)return;let e=this.triggerElem||this.target||window;switch(this.state.currentTriggerElem=e,this.state.triggerType){case"click":e.id&&!(e instanceof Window)&&e.setAttribute("aria-controls",`${this.id}`),this.offEvent("click.trigger"),this.onEvent("click.trigger",e,t=>typeof this.onTriggerClick=="function"?this.onTriggerClick(t):!0);break;case"contextmenu":if(this.parentMenu)break;this.onEvent("contextmenu.trigger",e,t=>{typeof this.onContextMenu=="function"&&this.onContextMenu(t)});break;case"hover":this.onEvent("hoverend.trigger",e,t=>{typeof this.onTriggerHover=="function"&&this.onTriggerHover(t)},{delay:this.popupDelay}),this.onEvent("sloped-mouseleave.trigger",e,t=>{typeof this.onCancelTriggerHover=="function"&&this.onCancelTriggerHover(t)},{delay:this.popupDelay}),this.onEvent("click.trigger",e,t=>{typeof this.onTriggerHoverClick=="function"&&this.onTriggerHoverClick(t)});break;case"immediate":typeof this.onTriggerImmediate=="function"&&this.onTriggerImmediate();break;case"custom":break;default:break}this.hasTriggerEvents=!0}removeTriggerEvents(){this.currentTargetElem?.removeAttribute("aria-controls"),o.forEach(e=>{this.detachEventsByName(e)}),this.hasTriggerEvents=!1}},p=g;export{p as a};
