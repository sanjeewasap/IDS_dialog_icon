import{e as m,f}from"./ids-chunk-DXGQFMWW.js";import{a as H}from"./ids-chunk-OIS6KGMU.js";import{b as $}from"./ids-chunk-ODGLGMPF.js";import{a as L}from"./ids-chunk-T6ZV4PDM.js";import{a as S}from"./ids-chunk-AKCO43TX.js";import{a as M,b as A}from"./ids-chunk-XE4WFW5M.js";import{a as D}from"./ids-chunk-GFV2Z7F5.js";import{e as T}from"./ids-chunk-QPDOZZIG.js";import{a as l,b as v}from"./ids-chunk-EQJWBFQ2.js";import{a as E}from"./ids-chunk-U7OOVFXE.js";var N=`
/* Ids Menu Component */ /**
 * Base Styles/Mixins for Ids Menu Component and all subcomponents.
 */
:host {
  display: block;
  contain: content;
}

.ids-menu {
  display: block;
}`;var x=L(S(D)),c=class extends x{datasource=new H;lastHovered;lastNavigated;constructor(){super(),this.state={},this.lastHovered=void 0,this.lastNavigated=void 0,this.hasIcons=!1}static get attributes(){return[...super.attributes,l.DISABLED]}get childElements(){let t=[...this.children];return this.children[0]?.tagName==="SLOT"&&(t=this.children[0].assignedElements()),t}attachEventHandlers(){this.offEvent("click"),this.onEvent("click",this,t=>{let e=t.target.closest("ids-menu-item");this.highlightItem(e),this.selectItem(e),this.lastNavigated=e,t.stopPropagation()}),this.offEvent("mouseover"),this.onEvent("mouseover",this,t=>{let e=t.target;if(e&&e.tagName==="IDS-MENU-ITEM"){t.stopPropagation();let s=e;this.highlightItem(s),s.hasAttribute(l.DISABLED)||(this.lastHovered=s)}}),this.offEvent("mouseout"),this.onEvent("mouseout",this,t=>{let e=t.target;if(e&&e.tagName==="IDS-MENU-ITEM"){t.stopPropagation();let s=e;(!s.hasSubmenu||s.submenu?.hidden)&&s.unhighlight()}})}attachKeyboardListeners(){this.unlisten("ArrowUp"),this.listen(["ArrowUp"],this,t=>{t.preventDefault(),t.stopPropagation(),this.navigate(-1,!0)}),this.unlisten("ArrowDown"),this.listen(["ArrowDown"],this,t=>{t.preventDefault(),t.stopPropagation(),this.navigate(1,!0)}),this.unlisten("Enter"),this.unlisten("Spacebar"),this.unlisten(" "),this.listen(["Enter","Spacebar"," "],this,t=>{let e=t.target.closest("ids-menu-item");this.selectItem(e),this.lastNavigated=e,t.preventDefault(),t.stopPropagation()})}connectedCallback(){super.connectedCallback(),this.attachEventHandlers(),this.attachKeyboardListeners(),this.setAttribute(v.ROLE,"none"),this.data&&this.renderFromData(),this.refreshIconAlignment(),requestAnimationFrame(()=>{this.makeTabbable(this.detectTabbable())})}template(){let t;this.id&&(t=` id="${this.id}"`);let e="";this.disabled&&(e=" disabled");let s="";return this.tagName.toLowerCase()==="ids-popup-menu"&&(s=' slot="content"'),`<nav class="ids-menu${e}"${t}${s} part="menu" role="none"><slot></slot></nav>`}menuContentTemplate(t){let e=()=>"<ids-separator></ids-separator>",s=i=>typeof i.text!="string"?"":`<ids-menu-header>${i.text}</ids-menu-header>`,n=i=>{let r="";return i.forEach(a=>{switch(a.type){case"header":r+=s(a);break;case"separator":r+=e();break;case"group":default:r+=d(a);break}}),r},h=i=>{if(!Array.isArray(i?.contents)||!i.contents.length)return"";let r="";i.id&&(r=` id="${i.id}"`);let a=n(i.contents);return`<ids-popup-menu slot="submenu"${r}>${a}</ids-popup-menu>`},o=i=>{if(typeof i.text!="string")return"";let r=`${i.text}`,a="";typeof i.id=="string"&&(a=` id="${i.id}"`);let u="";i.disabled&&(u=' disabled="true"');let g="";typeof i.icon=="string"&&(g=` icon="${i.icon}"`);let p="";i.selected&&(p=' selected="true"');let b="";typeof i.shortcutKeys=="string"&&(b=` shortcut-keys="${i.shortcutKeys}"`);let y="";typeof i.value<"u"&&i.value!==null&&i.value!==""&&(y=` value="${i.value}"`);let I="";return i.submenu&&(I=h(i.submenu)),`<ids-menu-item${a}${u}${g}${p}${b}${y}>
        ${r}
        ${I}
      </ids-menu-item>`},d=i=>{if(!Array.isArray(i?.items)||!i.items.length)return"";let r="";i.id&&(r=` id="${i.id}"`);let a="";return i.items?.forEach(u=>{u?.type==="separator"?a+=e():a+=o(u)}),`<ids-menu-group${r}>${a}</ids-menu-group>`};return n(t)}renderFromData(){if(this.data?.length===0||!this.shadowRoot)return;let t=document.createElement("template"),e=this.template();this.shadowRoot.innerHTML="",t.innerHTML=e,this.shadowRoot.appendChild(t.content.cloneNode(!0)),this.innerHTML="",this.insertAdjacentHTML("beforeend",this.menuContentTemplate(this.data))}set data(t){if(Array.isArray(t)){this.datasource.data=t,this.renderFromData();return}if(t&&typeof t=="object"){let e=t;Array.isArray(e.contents)&&(this.datasource.data=e.contents,e.id&&(this.id=e.id),this.renderFromData());return}this.datasource.data=[]}get data(){return this?.datasource?.data||[]}get groups(){return this.childElements?.filter(t=>t.matches("ids-menu-group"))}get headers(){return this.childElements?.filter(t=>t.matches("ids-menu-header"))}get items(){let t=[];return this.groups.forEach(e=>{t=t.concat([...e.children].filter(s=>s.matches("ids-menu-item")))}),t}get focused(){return this.items.find(t=>$(this)?.activeElement?.isEqualNode(t))}get focusTarget(){if(this.lastHovered)return this.lastHovered;if(this.lastNavigated)return this.lastNavigated;let t=this.items.filter(s=>s.highlighted);if(t.length)return t[t.length-1];let e=this.getSelectedItems();return e.length?e[0]:this.getFirstAvailableItem()}get highlighted(){return this.items.filter(t=>t.highlighted)}get parentMenu(){return this.parentElement?.closest("ids-menu")}get parentMenuItem(){return this.parentElement?.closest("ids-menu-item")}get submenus(){let t=[];return this.items.forEach(e=>{let s=e.submenu;s&&t.push(s)}),t}set disabled(t){T(t)?(this.setAttribute(l.DISABLED,""),this.#t()):(this.removeAttribute(l.DISABLED),this.#e())}get disabled(){return this.hasAttribute(l.DISABLED)}#t(){this.container?.classList.add("disabled"),this.items.forEach(t=>{t.disabled=!0})}#e(){this.container?.classList.remove("disabled"),this.items.forEach(t=>{t.disabled=!1})}highlightItem(t){f(t,this)&&(this.items.forEach(e=>{t.isEqualNode(e)||e.unhighlight()}),t.highlight())}navigate(t=0,e=!1){let s=this.items,n=this.focusTarget;if(typeof t!="number")return n;let h=t<0,o=Math.abs(t),d=s.indexOf(n);for(;o>0;)n=s[d+(h?-1:1)],d=s.indexOf(n),d<0&&(d=h?s.length-1:0,n=s[d]),!n.disabled&&!n.hidden&&(this.makeTabbable(n),o-=1);return this.lastNavigated=n,this.lastHovered&&(this.lastHovered=null),!n.disabled&&!n.hidden&&e&&(n.focus(),this.highlightItem(n)),n}detectTabbable(){let t;for(let e=0;!t&&e<this.items.length;e++)this.items[e].tabIndex>-1&&(t=this.items[e]);return t}makeTabbable(t=this.items[0]){this.items.forEach(e=>{let s=t.isEqualNode(e)?0:-1;e.tabIndex=s})}getFirstAvailableItem(){let t=this.items,e=t.length,s,n=0;for(;!s&&n<e;)!t[n].disabled&&!t[n].hidden&&(s=t[n]),n+=1;return s}getSelectedItems(t){let e=m(t,this);return this.items.filter(s=>e?s.selected&&s.group.isEqualNode(e):s.selected)}getSelectedValues(t){return this.getSelectedItems(t).map(e=>e.value)}setSelectedValues(t,e){if(!t?.length)return;let s=m(e,this);if(!s&&e!==void 0)return;let n=s?s.items:this.items,h=Array.isArray(t)?t:[t];n.forEach(o=>{if(h.indexOf(o.value)===-1){o.deselect();return}o.selected||this.selectItem(o)})}selectItem(t){if(!f(t,this))return;if(t.hasSubmenu){t.showSubmenu();return}t.group.select==="multiple"||t.toggleable?t[t.selected?"deselect":"select"]():t.select()}clearSelectedItems(t){let e=m(t,this);this.items.forEach(s=>{let n;e?n=s.selected&&s.group.isEqualNode(e):n=s.selected,n&&s.deselect()})}hasIcons;detectIcons(){this.hasIcons=!1;for(let t=0,e;t<this.items.length&&!this.hasIcons;t++)e=this.items[t],!e.hidden&&e.icon&&e.icon.length&&(this.hasIcons=!0);return this.hasIcons}refreshIconAlignment(){this.detectIcons(),[...this.items,...this.headers].forEach(t=>{typeof t.decorateForIcon=="function"&&t.decorateForIcon(this.hasIcons)})}};c=E([M("ids-menu"),A(N)],c);export{c as a};
