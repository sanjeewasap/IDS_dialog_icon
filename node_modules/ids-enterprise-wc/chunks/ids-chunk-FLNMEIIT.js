import{f as v}from"./ids-chunk-LCUXCSNZ.js";import{a as b}from"./ids-chunk-AKCO43TX.js";import{a as m}from"./ids-chunk-XE4WFW5M.js";import{a as E}from"./ids-chunk-GFV2Z7F5.js";import{a as f}from"./ids-chunk-U7OOVFXE.js";var h=class extends b(E){rootNode;headerCheckbox;isHeaderExpanderCollapsed=!1;constructor(){super({noShadowRoot:!0}),this.state={headerMenuData:null}}connectedCallback(){super.connectedCallback(),this.#e()}get dataGrid(){return this.rootNode||(this.rootNode=this.getRootNode()),this.rootNode.host}#e(){this.#r(),this.#t(),this.#a(),this.#s()}#t(){this.offEvent("click.sort",this),this.onEvent("click.sort",this,t=>{if(this.dataGrid?.isResizing){this.dataGrid.isResizing=!1;return}if(t.target?.classList?.contains("header-expander")){if(!this.dataGrid?.showHeaderExpander)return;this.isHeaderExpanderCollapsed?this.dataGrid.expandAll():this.dataGrid.collapseAll(),this.isHeaderExpanderCollapsed=!this.isHeaderExpanderCollapsed;return}let e=t.target.closest(".is-sortable")?.closest(".ids-data-grid-header-cell");e&&this.dataGrid?.setSortColumn(e.getAttribute("column-id"),e.getAttribute("aria-sort")!=="ascending")})}#r(){this.headerCheckbox=this.querySelector("ids-data-grid-header .ids-data-grid-checkbox-container .ids-data-grid-checkbox"),this.offEvent("click.select",this.headerCheckbox),this.onEvent("click.select",this.headerCheckbox,t=>{t.target.classList.contains("checked")||t.target.classList.contains("indeterminate")?this.dataGrid?.deSelectAllRows():this.dataGrid?.selectAllRows()})}#a(){let t=0,e=0,a="",s,d=r=>{let i=r.clientX-t;this.dataGrid?.setColumnWidth(a,e+(this.dataGrid.localeAPI.isRTL()?-i:i))},n=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",n),this?.style.setProperty("cursor",""),requestAnimationFrame(()=>{this.dataGrid.isResizing=!1,s?.parentElement?.querySelectorAll("[draggable]").forEach(r=>r.setAttribute("draggable","true"))})};this.offEvent("mousedown.resize",this),this.onEvent("mousedown.resize",this,r=>{let i=r.target;if(!i.classList.contains("resizer"))return;t=r.clientX,s=i.closest(".ids-data-grid-header-cell"),s.parentElement?.querySelectorAll("[draggable]").forEach(c=>c.setAttribute("draggable","false"));let o=window.getComputedStyle(s);a=s.getAttribute("column-id")||"",e=parseInt(o.width,10),document.addEventListener("mousemove",d),document.addEventListener("mouseup",n),this?.style.setProperty("cursor","col-resize"),this.dataGrid.isResizing=!0})}#s(){let t=this.dataGrid?.wrapper?.querySelector(".ids-data-grid-sort-arrows"),e,a=0,s=!1,d;this.offEvent("mousedown.reorder",this),this.onEvent("mousedown.reorder",this,r=>{r.target.nodeName==="IDS-INPUT"&&(d=r.target.closest(".ids-data-grid-header-cell"),d?.setAttribute("draggable","false"))}),this.offEvent("mouseup.reorder",this),this.onEvent("mouseup.reorder",this,()=>{d?.setAttribute("draggable","true")}),this.offEvent("dragstart.reorder",this),this.onEvent("dragstart.reorder",this,r=>{let i=r.target,o=r.target.nodeName;this.dataGrid.isResizing||!i||o==="IDS-INPUT"||(s=!0,i.classList.add("active-drag-column"),e=i.cloneNode(!0),e.classList.add("dragging"),this?.appendChild(e),r?.dataTransfer?.setDragImage(e,this.dataGrid?.localeAPI.isRTL()?100:10,18),a=i.getAttribute("aria-colindex"))}),this.offEvent("dragenter.reorder",this),this.onEvent("dragenter.reorder",this,r=>{if(!s){r.target?.getAttribute("color-variant")==="alternate-formatter"&&(r.target.style.backgroundColor="var(--ids-data-grid-filter-input-drop-background-color)");return}let i=r.target.closest(".ids-data-grid-header-cell");if(i.classList.contains("active-drag-column"))return;let o=i.getBoundingClientRect(),c=i.getAttribute("aria-colindex"),g=o.left+(a<c?o.width+1:1),p=o.left+(a<c?1:o.width+1),l=0;this.offsetParent&&(l=this.offsetParent.getBoundingClientRect().left-this.offsetParent.offsetLeft),t?.style.setProperty("left",`${this.dataGrid?.localeAPI.isRTL()?p-l:g-l}px`),t?.style.setProperty("height",`${o.height-1}px`),t?.style.setProperty("display","block"),r.preventDefault()}),this.offEvent("dragover.reorder",this),this.onEvent("dragover.reorder",this,r=>{s&&(r.dataTransfer.dropEffect="move",r.preventDefault())}),this.offEvent("dragleave.reorder",this),this.onEvent("dragleave.reorder",this,r=>{!s&&r.target?.getAttribute("color-variant")==="alternate-formatter"&&(r.target.style.backgroundColor="")});let n=r=>{this.querySelector(".active-drag-column")?.classList.remove("active-drag-column"),e?.remove(),t?.style.setProperty("display","none"),r.preventDefault()};this.offEvent("dragend.reorder",this),this.onEvent("dragend.reorder",this,r=>{if(!s){r.target?.getAttribute("color-variant")==="alternate-formatter"&&(r.target.style.backgroundColor="");return}s=!1,n(r)}),this.offEvent("drop.reorder",this),this.onEvent("drop.reorder",this,r=>{if(!s){r.target?.getAttribute("color-variant")==="alternate-formatter"&&(r.target.style.backgroundColor="");return}s=!1;let i=r.target.closest(".ids-data-grid-header-cell");this.dataGrid?.moveColumn(a-1,i.getAttribute("aria-colindex")-1),n(r)})}setIsHeaderExpanderCollapsed(){if(!this.dataGrid?.showHeaderExpander)return;let t=this.dataGrid?.rows?.filter(a=>a?.hasAttribute("aria-expanded"))||[],e=t.filter(a=>a?.getAttribute("aria-expanded")==="false");t.length&&t.length===e.length&&(this.isHeaderExpanderCollapsed=!0)}setHeaderCheckbox(){if(!this.dataGrid?.rowSelection||this.dataGrid?.rowSelection==="single"||!this.headerCheckbox)return;let t=this.dataGrid?.selectedRows.length,e=this.dataGrid?.data.length;if(t===0){this.headerCheckbox.classList.remove("indeterminate"),this.headerCheckbox.classList.remove("checked"),this.headerCheckbox.setAttribute("aria-checked","false");return}if(t===e){this.headerCheckbox.classList.remove("indeterminate"),this.headerCheckbox.classList.add("checked"),this.headerCheckbox.setAttribute("aria-checked","true");return}t!==e&&(this.headerCheckbox.classList.add("indeterminate"),this.headerCheckbox.setAttribute("aria-checked","mixed"))}setSortState(t,e){let a=[...this.querySelectorAll(".is-sortable")].map(d=>d.closest(".ids-data-grid-header-cell"));a.forEach(d=>d?.removeAttribute("aria-sort"));let s=this.querySelector(`[column-id="${t}"]`);s&&a.includes(s)&&s.setAttribute("aria-sort",e?"ascending":"descending")}setFilterRow(){return this?.querySelectorAll(".ids-data-grid-header-cell-filter-wrapper")?.forEach(e=>e?.classList?.[this.dataGrid?.filterable?"remove":"add"]("hidden")),this.dataGrid?.triggerEvent(this.dataGrid?.filterable?"filterrowopened":"filterrowclosed",this.dataGrid,{detail:{elem:this,filterable:this.dataGrid?.filterable}}),this}static template(t){let e=`<ids-data-grid-header class="ids-data-grid-header" role="rowgroup" part="header">
      <ids-data-grid-row class="ids-data-grid-row" role="row">
        ${t.visibleColumns.map((a,s)=>`${this.headerCellTemplate(t,a,s)}`).join("")}
      </ids-data-grid-row>
    </ids-data-grid-header>`;return this.columnGroupsTemplate(t)+e}static headerCellTemplate(t,e,a){let s=`
      <span class="ids-data-grid-checkbox-container">
        <span
          role="checkbox"
          aria-checked="false"
          aria-label="${e.name}"
          class="ids-data-grid-checkbox"
        >
        </span>
      </span>
    `,d=`
      <span class="sort-indicator">
        <ids-icon icon="dropdown"></ids-icon>
        <ids-icon icon="dropdown"></ids-icon>
      </span>
    `,n='<ids-icon class="header-expander" icon="plusminus-folder-closed"></ids-icon>',r='<span class="resizer"></span>',i='<div class="reorderer"><ids-icon icon="drag" size="medium"></ids-icon></div>',o=/^(expander|tree)$/g.test(e.formatter?.name||"")?n:"",c=e.id!=="selectionRadio"&&e.id==="selectionCheckbox",g=v(e.name),p=`
      ${c?s:""}
      ${e.id!=="selectionRadio"&&e.id!=="selectionCheckbox"&&g?g:""}
    `.trim(),l="ids-data-grid-header-cell-content";l+=e.sortable?" is-sortable":"",l+=c?" has-selectioncheckbox vertical-align-center":"",l+=e.headerIcon?" has-headericon":"",l+=e.reorderable?" is-reorderable":"";let C=`<span class="${l}">
        ${o}
        <span class="ids-data-grid-header-text">
          ${p}
        </span>
        ${this.headerIconTemplate(e)}
        ${e.sortable?d:""}
      </span>${e.resizable?r:""}${e.reorderable?i:""}`,x=t?.filters?.filterTemplate(e)||"",u=e.align?` align-${e.align}`:"";e.headerAlign&&(u=` align-${e.headerAlign}`);let y=t?.leftFrozenColumns.length,k=e?.frozen?` frozen frozen-${e?.frozen}${a+1===y?" frozen-last":""}`:"";return`
      <span
        class="ids-data-grid-header-cell${(()=>typeof e?.uppercase=="function"?e.uppercase("header-cell",e,a):e?.uppercase==="true"||e?.uppercase===!0)()?" is-uppercase":""}${u}${k}"
        ${e.reorderable?'draggable="true"':""}
        part="header-cell"
        aria-colindex="${a+1}"
        column-id="${e.id}"
        role="columnheader">
        ${C}
        ${x}
      </span>
    `}static headerIconTemplate(t){let e=typeof t?.headerIcon=="string"?t.headerIcon:"";return e===""?"":`
      <span class="ids-data-grid-header-icon" data-headericontooltip="${t.headerIconTooltip||e}">
        <ids-icon icon="${e}" size="medium"></ids-icon>
      </span>`}static columnGroupsTemplate(t){if(!t?.columnGroups)return"";let e=`<ids-data-grid-header class="ids-data-grid-header column-groups" part="header" role="rowgroup">
    <div role="row" class="ids-data-grid-row ids-data-grid-column-groups">`;return t?.columnGroups.forEach(a=>{let s=a.align?` align-${a.align}`:"",d="ids-data-grid-header-cell-content";d+=a.headerIcon?" has-headericon":"";let n=`<span class="ids-data-grid-header-cell${s}" part="header-cell" column-group-id="${a.id||"id"}" role="columnheader">
        <span class="${d}">
          <span class="ids-data-grid-header-text">
            ${a.name||""}
          </span>
          ${this.headerIconTemplate(a)}
        </span>
      </span>`;e+=n}),e+="</div></ids-data-grid-header>",e}};h=f([m("ids-data-grid-header")],h);export{h as a};
