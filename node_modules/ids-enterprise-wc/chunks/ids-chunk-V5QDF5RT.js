import{a as d}from"./ids-chunk-AKCO43TX.js";import{a as u,b as m}from"./ids-chunk-XE4WFW5M.js";import{a as g}from"./ids-chunk-GFV2Z7F5.js";import{g as c}from"./ids-chunk-QPDOZZIG.js";import{a as i}from"./ids-chunk-EQJWBFQ2.js";import{a as h}from"./ids-chunk-U7OOVFXE.js";var f=`
/* Ids Virtual Scroll Component */
:host {
  display: flex;
  width: 100%;
  height: 100vh;
}

:host([hidden]) {
  display: none;
}

.ids-virtual-scroll {
  display: grid;
  grid-auto-flow: column;
  width: 100%;
}
.ids-virtual-scroll:focus {
  outline: 0;
  justify-self: end;
}

.ids-virtual-scroll-content {
  position: relative;
}`;var T="100vh",v=50,s=class extends d(g){datasource={};timeout;initialized=!1;lastStart=NaN;lastEnd=NaN;eventTarget=null;onAfterVirtualScroll;stringTemplate='<div class="ids-virtual-scroll-item" part="list-item">${productName}</div>';constructor(){super(),Object.defineProperty(this,"scrollTop",{get:()=>this.#t,set:t=>{this.#t=t},configurable:!0,enumerable:!0})}connectedCallback(){super.connectedCallback(),this.applyHeight(),this.renderItems(!1),this.#e()}#e(){this.timeout=null,this.scrollTarget=this.parentElement}handleScroll(t){this.timeout&&cancelAnimationFrame(this.timeout);let e=t.target;this.timeout=requestAnimationFrame(()=>{e&&(this.scrollTop=e.scrollTop)})}renderItems(t){!this.data||!t&&this.data.length===0||requestAnimationFrame(()=>{let e=this.startIndex,r=this.startIndex+this.visibleItemCount();if(!(this.lastStart!==e||this.lastEnd!==r))return;this.lastStart=e,this.lastEnd=r;let p=this.data.slice(e,r),n="";p.map((b,a)=>{let o=this.itemTemplate(b,a,e+a+1);return n+=o,o}),this.container?.querySelector(".offset")?.style.setProperty("transform",`translateY(${this.offsetY}px)`);let l=this.querySelector('[part="contents"]');l&&(l.innerHTML=n),this.triggerEvent("aftervirtualscroll",this,{detail:{elem:this,startIndex:e,endIndex:r}}),this.onAfterVirtualScroll&&this.onAfterVirtualScroll({elem:this,startIndex:e,endIndex:r})})}applyHeight(){if(!this.initialized)return;let t=this.container?.querySelector(".ids-virtual-scroll-content");if(typeof this.height=="string"&&this.height?.includes("vh")){let r=this.getBoundingClientRect().y;this.style.height=`calc(${this.height} - ${r+16}px)`}else this.style.height=`${this.height}`;t?.style.setProperty("height",`${this.contentHeight}px`),this.container?.querySelector(".offset")?.style.setProperty("transform",`translateY(${this.offsetY}px)`)}visibleItemCount(){let t=this.getBoundingClientRect().height,e=Math.ceil(t/this.itemHeight)+2*this.bufferSize;return e=Math.min(Number(this.itemCount)-this.startIndex,e),e}static get attributes(){return[i.HEIGHT,i.ITEM_HEIGHT,i.BUFFER_SIZE,i.DATA,i.SCROLL_TOP]}template(){return`
      <div class="ids-virtual-scroll">
        <div class="ids-virtual-scroll-content">
          <div class="offset">
            <slot></slot>
          </div>
        </div>
      </div>
    `}set height(t){if(t){this.setAttribute(i.HEIGHT,t.toString()),this.applyHeight();return}this.removeAttribute(i.HEIGHT)}get height(){return this.getAttribute(i.HEIGHT)||T}set itemHeight(t){if(t){this.setAttribute(i.ITEM_HEIGHT,t.toString()),this.applyHeight(),this.renderItems(!1);return}this.removeAttribute(i.ITEM_HEIGHT)}get itemHeight(){let t=parseFloat(this.getAttribute(i.ITEM_HEIGHT)??"");return Number.isNaN(t)?v:t}set bufferSize(t){if(t){this.setAttribute(i.BUFFER_SIZE,t.toString());return}this.removeAttribute(i.BUFFER_SIZE)}get bufferSize(){let t=parseFloat(this.getAttribute(i.BUFFER_SIZE)??"");return Number.isNaN(t)?10:t}set#t(t){let e=parseFloat(t);if(!Number.isNaN(e)){this.setAttribute(i.SCROLL_TOP,e.toString()),this.container&&(this.container.scrollTop=e),this.renderItems(!1);return}this.removeAttribute(i.SCROLL_TOP)}get#t(){let t=parseFloat(this.getAttribute(i.SCROLL_TOP)??"");return Number.isNaN(t)?0:t}scrollToIndex(t){this.scrollTop=Number(t)*Number(this.itemHeight)}get contentHeight(){return Number(this.itemCount)*Number(this.itemHeight)}get itemCount(){return this.data?.length}get offsetY(){return Number(this.startIndex)*Number(this.itemHeight)}get startIndex(){let t=Math.floor(Number(this.scrollTop)/Number(this.itemHeight))-Number(this.bufferSize);return t=Math.max(0,t),t}itemTemplate(t,e,r){return c(this.stringTemplate,t)}set data(t){if(t&&this.datasource){this.datasource.data=t,this.lastStart=NaN,this.lastEnd=NaN,this.scrollTop=0,this.initialized=!0,this.applyHeight(),this.renderItems(!0);return}this.datasource&&(this.datasource.data=null)}get data(){return this?.datasource?.data}set scrollTarget(t){t&&(this.offEvent("scroll",this.eventTarget),this.eventTarget=t,this.onEvent("scroll",this.eventTarget,e=>{this.handleScroll(e)},{passive:!0}))}get scrollTarget(){return this.eventTarget}};s=h([u("ids-virtual-scroll"),m(f)],s);export{s as a};
