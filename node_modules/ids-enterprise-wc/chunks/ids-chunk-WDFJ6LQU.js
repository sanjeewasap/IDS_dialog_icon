import{a as r}from"./ids-chunk-AYV2UDVJ.js";import{b as f,d as I,e as S}from"./ids-chunk-VYPX2VLX.js";import{b as k,i as d}from"./ids-chunk-GX2AIROS.js";import{e as h}from"./ids-chunk-QPDOZZIG.js";import{a as o}from"./ids-chunk-EQJWBFQ2.js";var g=[o.MASK,o.MASK_GUIDE,o.MASK_RETAIN_POSITIONS,o.MASK_OPTIONS],M=m=>class extends m{maskState={guide:!1,keepCharacterPositions:!1,options:{},previousMaskResult:"",previousPlaceholder:""};constructor(...e){super(...e)}static get attributes(){return[...m.attributes,...g]}connectedCallback(){super.connectedCallback?.(),this.handleMaskEvents(),this.processMaskWithCurrentValue()}get maskAPI(){return r}set maskGuide(e){let t=h(e);this.maskState.guide=t,this.processMaskWithCurrentValue()}get maskGuide(){return this.maskState.guide}get maskOptions(){return this.maskState.options}set maskOptions(e){typeof e=="object"&&(this.maskState.options=e)}get maskPipe(){return this.maskState.pipe}set maskPipe(e){typeof e=="function"&&(this.maskState.pipe=e)}set maskRetainPositions(e){let t=h(e);this.maskState.keepCharacterPositions=t}get maskRetainPositions(){return this.maskState.keepCharacterPositions}get mask(){return this.maskState.pattern}set mask(e){let t;if(Array.isArray(e)||typeof e=="function")t=e;else switch(e){case"date":case"time":t=I,this.onLocaleChange=a=>{this.maskOptions.format||(this.maskOptions.format=a.calendar().dateFormat.short)};break;case"rangeDate":t=S,this.onLocaleChange=a=>{this.maskOptions.format||(this.maskOptions.format=a.calendar().dateFormat.short)};break;case"number":t=f,this.onLocaleChange=a=>{let i=a.locale;this.maskOptions.symbols={currency:i.options.currencySign,decimal:i.options.numbers.decimal,negative:i.options.numbers.minusSign,thousands:i.options.numbers.group}};break;default:t=d(e),this.onLocaleChange=void 0;break}this.maskState.pattern=t,typeof this.onLocaleChange=="function"&&this.locale&&this.onLocaleChange(this.localeAPI)}handleMaskEvents(){this.onEvent("input",this,()=>this.processMaskWithCurrentValue())}processMask=(e,t={},a=!1)=>{if(!this.mask)return!1;let i=this.maskState.previousMaskResult;if(e===i)return!1;let p=this.input.selectionStart||0,u=this.input.selectionEnd||0;e=r.getSafeRawValue(e);let c={caretTrapIndexes:[],guide:this.maskState.guide,locale:this.localeAPI,keepCharacterPositions:this.maskState.keepCharacterPositions,pattern:this.mask,patternOptions:t,placeholderChar:k,previousMaskResult:i,selection:{start:p,end:u,contents:""}};p!==u&&(c.selection.contents=e.substring(p,u)),typeof this.maskPipe=="function"&&(c.pipe=this.maskPipe);let s=r.process(e,c);if(!s.maskResult)return!1;let n=s.conformedValue;s.pipedValue&&(n=s.pipedValue),n!==""&&t.suffix&&!n.includes(t.suffix)&&(n+=`${t.suffix}`);let l={conformedValue:n,rawValue:e,caretPos:s.caretPos,placeholder:s.placeholder,placeholderChar:c.placeholderChar,previousMaskResult:i,previousPlaceholder:this.maskState.previousPlaceholder};return s.pipedCharacterIndexes&&(l.indexesOfPipedChars=s.pipedCharIndexes),s.caretTrapIndexes&&(l.caretTrapIndexes=s.caretTrapIndexes),s.caretPos=r.adjustCaretPosition(l),this.maskState.previousMaskResult=n,this.maskState.previousPlaceholder=s.placeholder,a&&(this.value=n,this.safelySetSelection(this.shadowRoot,s.caretPos,s.caretPos)),n};processMaskWithCurrentValue(){return this.processMask(this.value,this.maskOptions,!0)}processMaskFromProperty(e=""){return this.processMask(e,this.maskOptions,!1)}safelySetSelection(e=document,t=0,a=0){e?.activeElement===this.input&&this.input.setSelectionRange(t,a,"none")}},R=M;export{R as a};
