import{a as w,b as p}from"./ids-chunk-KWUI36H2.js";import{a as b}from"./ids-chunk-ONPEMRJP.js";import{b as I}from"./ids-chunk-LCUXCSNZ.js";import{e as O,f as g}from"./ids-chunk-QPDOZZIG.js";import{a as E}from"./ids-chunk-EQJWBFQ2.js";var A=x=>class extends x{constructor(...e){super(...e)}static get attributes(){return[...x.attributes,E.SUPPRESS_TOOLTIPS]}connectedCallback(){super.connectedCallback?.()}set suppressTooltips(e){O(e)?this.setAttribute(E.SUPPRESS_TOOLTIPS,""):this.removeAttribute(E.SUPPRESS_TOOLTIPS),this.setupTooltip()}get suppressTooltips(){return this.hasAttribute(E.SUPPRESS_TOOLTIPS)}#o;#t={BODY_CELL:"body-cell",FILTER_BUTTON:"filter-button",HEADER_TITLE:"header-title",HEADER_ICON:"header-icon"};setupTooltip(){this.suppressTooltips?this.#h():this.#u()}async#l(e){let t=w(e);if(this.#a(),p(t,".ids-data-grid-body")&&p(t,'[role="gridcell"]')){await this.#c(t);return}if(p(t,".ids-data-grid-header-text")||p(t,".ids-data-grid-header-icon")){await this.#d(t);return}p(t,".ids-data-grid-header-cell-filter-wrapper")&&p(t,"ids-menu-button")&&await this.#p(t)}async#c(e){let t=this,s=p(e,'[role="gridcell"]'),i=p(e,"ids-hyperlink")?s:s.querySelector(".text-ellipsis"),o=g(p(e,'[role="row"]')?.getAttribute("data-index")),a=g(s.getAttribute("aria-colindex"))-1,r=t.data[o],c=t.columns[a];if(c?.tooltip||i?.offsetWidth<i?.scrollWidth){let d=c.id,l=r[d],u=(s.textContent||"").trim(),h={type:this.#t.BODY_CELL,rowData:r,rowIndex:o,columnData:c,columnId:d,columnIndex:a,fieldData:l,text:u,grid:this},f=await this.#e({data:c,callbackArgs:h});if(typeof f=="string"&&f!==""){await this.#i({data:c,callbackArgs:h});let T=await this.#s({defaultOptions:{placement:"top",x:0,y:10},data:c,callbackArgs:h});this.#n({target:s,callbackArgs:h,content:f,options:T})}}}async#d(e){let t=this,s=p(e,'[role="columnheader"]'),n=p(e,".ids-data-grid-header-text"),i=p(e,".ids-data-grid-header-icon"),o=!!i,a,r,c,d,l,u,h=!1,f=s.hasAttribute("column-group-id");if(f?(r=s.getAttribute("column-group-id"),c=t.columnGroupDataById(r),a=c):(d=s.getAttribute("column-id"),l=t.columnIdxById(d),u=t.columns[l],a=u),o?h=!!a?.headerIconTooltip:h=!!a?.headerTooltip,h||o||n?.offsetWidth<n?.scrollWidth){let T=o?i.getAttribute("data-headericontooltip"):null,m={grid:this,text:(T||n.textContent||"").trim(),type:o?this.#t.HEADER_ICON:this.#t.HEADER_TITLE,isHeaderGroup:f};f?m={...m,columnGroupId:r,columnGroupData:c,rowIndex:0,columnGroupIndex:t.columnGroupIdxById(r)}:m={...m,columnId:d,columnIndex:l,columnData:u,rowIndex:t.columnGroups?1:0};let y=await this.#e({callbackArgs:m,data:a});if(typeof y=="string"&&y!==""){await this.#i({data:a,callbackArgs:m});let L=await this.#s({defaultOptions:{placement:"top",x:0,y:o?16:10},callbackArgs:m,data:a});this.#n({target:o?i:s,callbackArgs:m,content:y,options:L})}}}async#p(e){let t=this,s=p(e,'[role="columnheader"]'),n=p(e,"ids-menu-button");if(n){let i=t.columnGroups?1:0,o=s.getAttribute("column-id"),a=t.columnIdxById(o),r=t.columns[a],c=(n.text||"").trim(),d={type:this.#t.FILTER_BUTTON,isFilterButton:!0,rowIndex:i,columnData:r,columnIndex:a,columnId:o,text:c,grid:this},l=await this.#e({data:r,callbackArgs:d});if(typeof l=="string"&&l!==""){await this.#i({data:r,callbackArgs:d});let u=await this.#s({defaultOptions:{placement:"bottom",x:0,y:22},data:r,callbackArgs:d});this.#n({target:n.dropdownIconEl,callbackArgs:d,content:l,options:u})}}}async#i(e){let{data:t,callbackArgs:s}=e,n=s.type,i=null;n===this.#t.BODY_CELL&&(i="tooltipCssPart"),n===this.#t.HEADER_TITLE&&(i="headerTooltipCssPart"),n===this.#t.HEADER_ICON&&(i="headerIconTooltipCssPart"),n===this.#t.FILTER_BUTTON&&(i="filterButtonTooltipCssPart");let o="";i&&t&&typeof t[i]=="string"?o=t[i]:typeof t?.tooltipCssPart=="function"&&(o=await t.tooltipCssPart(s)),o=I(o||"");let a=["tooltip-popup","tooltip-arrow","tooltip-arrow-top","tooltip-arrow-right","tooltip-arrow-bottom","tooltip-arrow-left"];o!==""&&(a=a.map(r=>`${r}: ${o}-${r}`)),this.#o?.setAttribute("exportparts",a.join(", "))}async#e(e){let{data:t,callbackArgs:s}=e,n=s.type,i=null;n===this.#t.BODY_CELL&&(i="tooltip"),n===this.#t.HEADER_TITLE&&(i="headerTooltip"),n===this.#t.HEADER_ICON&&(i="headerIconTooltip"),n===this.#t.FILTER_BUTTON&&(i="filterButtonTooltip");let o="";return i&&t&&typeof t[i]=="string"?o=t[i]:typeof t?.tooltip=="function"?o=await t.tooltip(s):o=s.text,I(o||"")}async#s(e){let{data:t,callbackArgs:s,defaultOptions:n}=e,i=s.type,o={};i===this.#t.BODY_CELL?o={placement:"placement",x:"x",y:"y"}:i===this.#t.HEADER_TITLE?o={placement:"headerPlacement",x:"headerX",y:"headerY"}:i===this.#t.HEADER_ICON?o={placement:"headerIconPlacement",x:"headerIconX",y:"headerIconY"}:i===this.#t.FILTER_BUTTON&&(o={placement:"filterButtonPlacement",x:"filterButtonX",y:"filterButtonY"});let{placement:a,x:r,y:c}=o,d={...n};if(t.tooltipOptions){let l={};typeof t.tooltipOptions=="function"?l=await t.tooltipOptions(s):(l[a]=t.tooltipOptions[a],l[r]=t.tooltipOptions[r],l[c]=t.tooltipOptions[c]);let u=(h,f)=>{let T=parseInt(h,10);Number.isNaN(T)||(d[f?"x":"y"]=T)};u(l[r],!0),u(l[c],!1),/^(top|right|bottom|left)$/g.test(l[a]||"")&&(d.placement=l[a])}return d}#n(e){if(this.#r)return;let{target:t,content:s,options:n,callbackArgs:i}=e,o={...i,content:s,options:n};this.triggerVetoableEvent("beforetooltipshow",o)&&this.#o&&(this.#o.placement=n.placement,this.#o.innerHTML=s,this.#o.target=t,this.#o.visible=!0,this.#o.popup.setPosition(n.x,n.y,!0,!0),this.triggerEvent("showtooltip",this,{bubbles:!0,detail:{elem:this,args:o}}))}#a(){this.#o?.setAttribute("visible","false"),this.triggerEvent("hidetooltip",this,{bubbles:!0,detail:{elem:this}})}#r=!1;#u(){this.#o=this.shadowRoot?.querySelector("ids-tooltip"),this.#o||(this.shadowRoot?.querySelector('slot[name="tooltip"]')?.insertAdjacentHTML("beforeend",'<ids-tooltip id="tooltip" exportparts="tooltip-popup, tooltip-arrow"></ids-tooltip>'),this.#o=this.shadowRoot?.querySelector("ids-tooltip")),this.onEvent("mouseout.data-grid",this.container,b(async()=>{this.#r=!0,this.#a()},250)),this.onEvent("mouseover.data-grid",this.container,b(async e=>{this.#r=!1,this.#l(e)},250)),this.onEvent("scroll.data-grid.tooltip-scroll",this.container,()=>{this.#a(),this.offEvent("scroll.data-grid.tooltip-scroll",this.container)},{capture:!0,passive:!0})}#h(){this.offEvent("mouseover.data-grid",this.container),this.offEvent("mouseout.data-grid",this.container),this.offEvent("scroll.data-grid.tooltip-scroll",this.container),this.#o?.remove(),this.#o=void 0}},_=A;export{_ as a};
