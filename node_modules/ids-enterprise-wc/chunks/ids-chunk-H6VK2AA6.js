import{a as y}from"./ids-chunk-PRFN5Z6E.js";import{a as v}from"./ids-chunk-GUNX4KFT.js";import{b as E}from"./ids-chunk-NZGHOKVC.js";import{a as A}from"./ids-chunk-SEZJIM5Z.js";import{a as p}from"./ids-chunk-WGF76AHI.js";import{a as b}from"./ids-chunk-N7RNTKMO.js";import{a as c}from"./ids-chunk-T6ZV4PDM.js";import{a as m}from"./ids-chunk-AKCO43TX.js";import{a as g,b as u}from"./ids-chunk-XE4WFW5M.js";import{a as f}from"./ids-chunk-GFV2Z7F5.js";import{e as d}from"./ids-chunk-QPDOZZIG.js";import{a as e}from"./ids-chunk-EQJWBFQ2.js";import{a as h}from"./ids-chunk-U7OOVFXE.js";var I=`
/* Ids Lookup Component */
.data-grid-container {
  overflow: auto;
}

ids-trigger-field::part(clearable-button) {
  margin-inline-end: -4px;
}`;var L=A(v(b(c(y(E(p(m(f)))))))),n=class extends L{triggerField;triggerButton;dataGrid;modal;listBox;constructor(){super(),this.state={...this.state,clearable:!0,dataGridSettings:{rowSelection:"multiple"},value:""},Object.defineProperty(this,"title",{get:()=>this.#e,set:t=>{this.#e=t},enumerable:!0,configurable:!0})}isFormComponent=!0;connectedCallback(){super.connectedCallback(),this.triggerField=this.shadowRoot?.querySelector("ids-trigger-field"),this.triggerButton=this.shadowRoot?.querySelector('ids-trigger-button[part="trigger-lookup"]'),this.dataGrid=this.shadowRoot?.querySelector("ids-data-grid"),this.dataGrid?.setAttribute(e.LIST_STYLE,"true"),this.modal=this.querySelector('[slot="lookup-modal"]')||this.shadowRoot?.querySelector("ids-modal"),this.modal&&(this.modal.target=this.triggerButton,this.modal.triggerType="click"),this.#s().#r()}disconnectedCallback(){super.disconnectedCallback?.(),this.dataGrid=void 0,this.modal=void 0,this.triggerField=void 0,this.triggerButton=void 0,this.state={}}static get attributes(){return[...super.attributes,e.AUTOCOMPLETE,e.CLEARABLE,e.DISABLED,e.FIELD,e.READONLY,e.SIZE,e.TABBABLE,e.TITLE,e.VALUE]}template(){return`
    <ids-trigger-field
      label="${this.label}"
      part="trigger-field"
      value="${this.value}"
      ${this.autocomplete?` autocomplete search-field="${this.field}"`:""}
      ${this.clearable?' clearable="true"':""}
      ${this.disabled?' disabled="true"':""}
      ${this.readonly?' readonly="true"':""}
      ${this.dirtyTracker?' dirty-tracker="true"':""}
      ${this.compact?" compact":""}
      ${this.size?` size="${this.size}"`:""}
      ${this.fieldHeight?` field-height="${this.fieldHeight}"`:""}
      ${this.validate?` validate="${this.validate}"`:""}
      ${this.validate&&this.validationEvents?` validation-events="${this.validationEvents}"`:""}>
      <ids-trigger-button
        slot="trigger-end"
        part="trigger-lookup"
        tabbable="${this.tabbable}"
        disabled="${this.disabled}"
        readonly="${this.readonly}">
        <ids-text audible="true">LookupTriggerButton</ids-text>
        <ids-icon icon="search-list" part="icon"></ids-icon>
      </ids-trigger-button>
    </ids-trigger-field>
    <slot name="lookup-modal">
      <ids-modal id="lookup-modal" aria-labelledby="lookup-modal-title" part="modal">
        <ids-text slot="title" font-size="24" type="h2" id="lookup-modal-title">${this.title}</ids-text>
        <ids-layout-grid class="data-grid-container" auto-fit="true" gap="md" no-margins="true" min-col-width="600px">
          <ids-layout-grid-cell>
            <ids-data-grid id="lookup-data-grid" label="${this.label}" part="data-grid">
            </ids-data-grid>
          </ids-layout-grid-cell>
        </ids-layout-grid>

      <ids-modal-button slot="buttons" id="modal-cancel-btn" appearance="secondary">
        <span>Cancel</span>
        </ids-modal-button>
        <ids-modal-button slot="buttons" id="modal-apply-btn" appearance="primary">
          <span>Apply</span>
        </ids-modal-button>
      </ids-modal>
    </slot>
    `}set autocomplete(t){d(t)?this.setAttribute(e.AUTOCOMPLETE,""):this.removeAttribute(e.AUTOCOMPLETE)}get autocomplete(){return this.hasAttribute(e.AUTOCOMPLETE)}onDirtyTrackerChange(t){t?this.container?.setAttribute(e.DIRTY_TRACKER,t.toString()):this.container?.removeAttribute(e.DIRTY_TRACKER)}set value(t){t!==this.state.value&&(this.state.value=(t??"").toString(),this.setAttribute(e.VALUE,this.state.value),this.triggerField&&this.triggerField.value!==this.state.value&&(this.triggerField.value=this.state.value,this.triggerField?.input?.dispatchEvent(new Event("change"))),this.triggerEvent("change",this,{detail:{elem:this,value:this.state.value}}))}get value(){return this.state.value}onLabelChange(){this.input&&(this.input.label=this.label)}onLabelStateChange(){this.input&&(this.input.labelState=this.labelState)}onLabelRequiredChange(){this.input&&(this.input.labelRequired=this.labelRequired)}set readonly(t){let i=d(t);if(this.triggerField){if(i){this.removeAttribute("disabled"),this.triggerField.readonly=!0,this.setAttribute("readonly","true");return}this.triggerField.readonly=!1,this.removeAttribute("readonly")}}get readonly(){return d(this.getAttribute("readonly"))||!1}set disabled(t){let i=d(t);if(this.triggerField){if(i){this.removeAttribute("readonly"),this.triggerField.disabled=!0,this.setAttribute("disabled","true");return}this.triggerField.disabled=!1,this.removeAttribute("disabled")}}get disabled(){return d(this.getAttribute("disabled"))||!1}set tabbable(t){let i=d(t);this.triggerField&&(this.setAttribute(e.TABBABLE,String(i)),this.triggerField.setAttribute(e.TABBABLE,String(i)))}get tabbable(){let t=this.getAttribute(e.TABBABLE);return this.readonly||this.disabled?!1:t===null?!0:d(this.getAttribute(e.TABBABLE))}set columns(t){this.dataGrid&&(this.dataGrid.columns=t)}get columns(){return this.dataGrid?.columns}set data(t){this.dataGrid&&(this.dataGrid.data=t),this.#t()}get data(){return this.dataGrid?this.dataGrid.data:[]}#t(t=this.value){if(t===""){this.dataGrid?.selectedRows.length&&this.dataGrid.deSelectAllRows(),this.value!==t&&(this.value=t);return}let i=(s,l)=>s.findIndex(o=>o[this.field]===l),r=t?.split(this.delimiter)||[],a=[];r.forEach((s,l)=>{let o=i(this.dataGrid?.data,s);o>-1?i(this.dataGrid?.selectedRows.map(T=>T.data),s)===-1&&this.dataGrid?.selectRow(o):a.push(l)}),a.forEach(s=>r.splice(s,1)),a=[],this.dataGrid?.selectedRows&&this.dataGrid?.selectedRows.length>r.length&&this.dataGrid?.selectedRows.forEach(s=>{r.includes(s.data[this.field])||a.push(s.index)}),a.forEach(s=>this.dataGrid?.deSelectRow(s)),this.value!==t&&(this.value=t)}set dataGridSettings(t){this.state.dataGridSettings=t;for(let[i,r]of Object.entries(t))this.dataGrid[i]=r;this.dataGrid&&(this.dataGrid.listStyle=!0)}get dataGridSettings(){return this.state.dataGridSettings}set validate(t){t?(this.setAttribute(e.VALIDATE,t.toString()),this.triggerField?.setAttribute(e.VALIDATE,t.toString()),this.triggerField?.setAttribute(e.VALIDATION_EVENTS,this.validationEvents),this.triggerField?.handleValidation()):(this.removeAttribute(e.VALIDATE),this.triggerField?.removeAttribute(e.VALIDATE),this.triggerField?.removeAttribute(e.VALIDATION_EVENTS),this.triggerField?.handleValidation())}get validate(){return this.getAttribute(e.VALIDATE)}set validationEvents(t){t?(this.setAttribute(e.VALIDATION_EVENTS,t.toString()),this.triggerField?.setAttribute(e.VALIDATION_EVENTS,t.toString())):(this.removeAttribute(e.VALIDATION_EVENTS),this.triggerField?.removeAttribute(e.VALIDATION_EVENTS))}get validationEvents(){return this.getAttribute(e.VALIDATION_EVENTS)||"change blur"}set#e(t){if(t){this.setAttribute(e.TITLE,t);let i=this.modal?.querySelector('[slot="title"]');i&&(i.innerText=t),this.triggerField?.setAttribute(e.TITLE,t)}}get#e(){return this.getAttribute(e.TITLE)||`${this.label}`}set field(t){t&&this.setAttribute(e.FIELD,t)}get field(){return this.getAttribute(e.FIELD)||"id"}set size(t){t?this.setAttribute(e.SIZE,t):this.removeAttribute(e.SIZE),this.triggerField&&this.triggerField.setAttribute(e.SIZE,this.size)}get size(){return this.getAttribute(e.SIZE)??"md"}set delimiter(t){t&&this.setAttribute(e.DELIMITER,t)}get delimiter(){return this.getAttribute(e.DELIMITER)||","}get input(){return this.container}set clearable(t){let i=d(t);i!==this.state.clearable&&(this.state.clearable=i,this.setAttribute(e.CLEARABLE,String(i)),this.triggerField?.setAttribute(e.CLEARABLE,String(i)))}get clearable(){return this.state.clearable}onFieldHeightChange(t){if(t){let i=t==="compact"?{name:"compact",val:""}:{name:"field-height",val:t};this.triggerField?.setAttribute(i.name,i.val)}else this.triggerField?.removeAttribute("compact"),this.triggerField?.removeAttribute("field-height"),this.listBox?.removeAttribute("compact")}#i(){this.value=this.dataGrid?.selectedRows.map(t=>t.data[this.field]).join(this.delimiter)||""}#s(){return this.onEvent("click.lookup",this.modal,t=>{let i=t.target?.getAttribute("id");i==="modal-cancel-btn"&&(this.modal?.hide(),this.#t()),i==="modal-apply-btn"&&(this.modal?.hide(),this.#i())}),this.onEvent("change.lookup",this.triggerField,()=>{let t=this.triggerField?.value,i=t!==this.value;if(!i){let r=this.dataGrid?.selectedRows?.map(s=>s?.data?.[this.field])||[],a=this.value?.split(this.delimiter)||[];if(r.length!==a.length&&(i=!0),!i){for(let s=0,l=a.length;s<l;s++)if(!r.includes(a[s])){i=!0;break}}}i&&this.#t(t)}),this.modal?.addEventListener("beforeshow",t=>{(this.readonly||this.disabled)&&t.detail.response(!1),this.querySelectorAll('[slot="lookup-modal"]').length!==1&&this.data?.length===0&&this.columns?.length===1&&this.columns[0].id===""&&t.detail.response(!1)}),this.dataGrid?.addEventListener("rowselected",t=>{this.triggerEvent("rowselected",this,{detail:t.detail})}),this.dataGrid?.addEventListener("rowdeselected",t=>{this.triggerEvent("rowdeselected",this,{detail:t.detail})}),this.dataGrid?.addEventListener("selectionchanged",t=>{this.triggerEvent("selectionchanged",this,{detail:t.detail})}),this}#r(){return this.listen(["ArrowDown"],this,()=>{this.modal?.show()}),this}};n=h([g("ids-lookup"),u(I)],n);export{n as a};
