import{a as b}from"./ids-chunk-ZDZH37C6.js";import{a as u}from"./ids-chunk-AQUKFERQ.js";import{a as h}from"./ids-chunk-V25MGCID.js";import{a as n,b as c}from"./ids-chunk-XE4WFW5M.js";import{a as d}from"./ids-chunk-U7OOVFXE.js";var p=`
.ids-list-builder {
  display: flex;
  flex-direction: column;
  border: var(--ids-list-builder-border);
  border-radius: var(--ids-list-builder-border-radius);
}
.ids-list-builder .ids-list-view-body div[part=list-item].is-editing > ids-text,
.ids-list-builder .ids-list-view-body .list-item-content.is-editing > ids-text {
  display: none;
}
.ids-list-builder .ids-list-view {
  overflow: auto;
  position: relative;
}
.ids-list-builder .ids-list-view ids-input::part(input) {
  background-color: var(--ids-list-builder-color-background);
  border-width: var(--ids-list-builder-border-width);
  height: var(--ids-list-builder-input-height);
  padding: var(--ids-list-builder-input-padding);
}
.ids-list-builder .ids-list-view ids-input::part(field-container) {
  max-width: 98%;
}
.ids-list-builder .ids-list-view div[part=list-item] {
  border: var(--ids-list-builder-item-border);
  padding: var(--ids-list-builder-item-padding);
  min-height: var(--ids-list-builder-item-height-min);
  height: var(--ids-list-builder-item-height);
  list-style-type: none;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
  width: 100%;
}
.ids-list-builder .ids-list-view div[part=list-item]:hover span::after {
  position: absolute;
  left: 0;
  transform: translate(100%, -8%);
  font-size: var(--ids-list-builder-item-font-size-drag);
  content: var(--ids-list-builder-drag-content);
  cursor: var(--ids-list-builder-item-cursor-drag);
}
.ids-list-builder .ids-list-view div[part=list-item] ids-text::part(text) {
  display: inline;
  user-select: none;
}
.ids-list-builder .ids-list-view div[part=list-item].placeholder {
  background-color: var(--ids-list-builder-item-color-background-placeholder);
  opacity: var(--ids-list-builder-item-placeholder-opacity);
}`;var o=class extends b{constructor(){super()}#t=null;placeholder;actions={ADD:"add",EDIT:"edit",DELETE:"delete",MOVE_UP:"move-up",MOVE_DOWN:"move-down"};connectedCallback(){this.sortable=!0,this.#a(),super.connectedCallback(),this.#s()}static get attributes(){return[...super.attributes]}template(){return`
      <div class="ids-list-builder">
        <div class="toolbar-container" part="toolbar-container">
          <slot name="toolbar"></slot>
        </div>
        ${super.template()}
      </div>
    `}toolbarTemplate(){let t=this.actions;return`
      <ids-toolbar slot="toolbar" type="formatter" tabbable="true">
        <ids-toolbar-section type="buttonset">
          ${this.buttonTemplate({action:t.ADD,icon:"add",text:"Add New"})}
          <ids-separator vertical></ids-separator>
          ${this.buttonTemplate({action:t.MOVE_UP,icon:"arrow-up",text:"Move Up"})}
          ${this.buttonTemplate({action:t.MOVE_DOWN,icon:"arrow-down",text:"Move Down"})}
          <ids-separator vertical></ids-separator>
          ${this.buttonTemplate({action:t.EDIT,icon:"edit",text:"Edit"})}
          ${this.buttonTemplate({action:t.DELETE,icon:"delete",text:"Delete"})}
        </ids-toolbar-section>
      </ids-toolbar>
    `}buttonTemplate(t){let{action:e,icon:i,text:s}=t;return`
      <ids-button list-builder-action="${e}" tooltip="${s}" color-variant="alternate-formatter">
        <span class="audible">${s}</span>
        <ids-icon icon="${i}"></ids-icon>
      </ids-button>
    `}#a(){this.querySelector('[slot="toolbar"]')||this.insertAdjacentHTML("afterbegin",this.toolbarTemplate())}get parentEl(){return this.shadowRoot?.querySelector("ids-swappable")}get toolbar(){return this.querySelector("ids-toolbar")}set selectable(t){super.selectable=t}get selectable(){return super.selectable}get dataKeys(){return super.dataKeys}set dataKeys(t){super.dataKeys=t}get data(){return super.data}set data(t){super.data=t,this.#s()}#s(){this.#h(),this.#b()}#e(){this.#t&&(this.#n(),this.updateDataFromDOM())}#d(){let e=this.selectedLi?.querySelector('div[part="list-item"]')?.querySelector("ids-text");e&&(e.innerHTML=this.#t?.value??"")}#n(){this.offEvent("keyup",this.#t),this.#t&&(this.#t?.parentNode?.classList.remove("is-editing"),this.#t.remove()),this.#t=null}#i(t=!1){if(this.selectedLi)if(this.triggerEvent("itemChange",this,{detail:this.getListItemData(this.selectedLi)}),this.#t)this.#t.focus();else{let e=new h,i=this.selectable==="single"?'div[part="list-item"]':".list-item-content",s=this.selectedLi.querySelector(i);s?.insertBefore(e,s.querySelector("ids-text")),s?.classList.add("is-editing"),this.#t=e,e.value=t?"New Value":s?.querySelector("ids-text")?.innerHTML,e.autoselect="true",e.noMargins="true",e.colorVariant="list-builder",e.focus(),this.onEvent("keyup",e,()=>this.#d())}}get selectedLi(){return this.shadowRoot?.querySelector("ids-swappable-item[selected]")}get allSelectedLi(){return this.shadowRoot?.querySelectorAll("ids-swappable-item[selected]")}#r(){let t=this.allSelectedLi||[],e=[];for(let i of t)e.push(i.getAttribute("index")),this.triggerEvent("itemDelete",this,{detail:this.getListItemData(i)}),i.remove(),this.#t&&(this.#t=null);this.resetIndices(),this.updateDataFromDOM();for(let i of e){let s=this.shadowRoot?.querySelector(`ids-swappable-item[index="${i}"]`);s&&this.toggleSelectedLi(s)}}swap(t,e){e.parentNode?.insertBefore(t,e)}add(){if(this.selectable&&this.selectable!=="single"){let l=[...this.allSelectedLi||[]];l.length>1&&(l.shift(),l.forEach(r=>this.toggleSelectedAttribute(r,!1)))}this.#e();let t;if(this.data.length){let l=!this.selectedLi,r=l?this.shadowRoot?.querySelector("ids-swappable-item"):this.selectedLi;r||(r=new u),t=r.cloneNode(!0);let a=l?r:r.nextSibling;r.parentNode&&(r.parentNode.insertBefore(t,a),r.removeAttribute("selected"))}else{let l={};this.dataKeys.forEach(r=>{l[r]="New Value"}),this.shadowRoot?.querySelector(".ids-list-builder")?.remove(),this.data=[l],this.redraw?.(),t=this.shadowRoot?.querySelector("ids-swappable-item")}t?.setAttribute("selected","");let e=t?.querySelector('div[part="list-item"]'),i=e?.querySelector("ids-text");i&&(i.innerHTML="New Value"),e?.getAttribute("selected")&&e.removeAttribute("selected"),this.resetIndices();let s=!0;this.#i(s),this.focusLi(t),this.#l(t),this.#o(t),this.triggerEvent("itemAdd",this,{detail:this.getListItemData(t)})}delete(){this.#r()}edit(){this.#i()}moveUp(){if(this.selectedLi){this.#e();let t=!1,e=[...this.allSelectedLi||[]],i=this.selectedLi?.previousElementSibling;e.length>1?i?(t=!0,i.before(...e)):e.some((l,r)=>String(r+1)!==l.getAttribute("aria-posinset"))&&(t=!0,this.parentEl?.prepend(...e)):i&&(t=!0,this.swap(this.selectedLi,i)),t&&(this.resetIndices(),this.updateDataFromDOM(),this.triggerEvent("itemMoveUp",this,{detail:{dataSet:this.data}}))}}moveDown(){if(this.selectedLi){this.#e();let t=!1,e=[...this.allSelectedLi||[]],i=e.length,s=this.selectedLi?.nextElementSibling;if(i>1)if(s=e[i-1]?.nextElementSibling,s)t=!0,s.after(...e);else{let l=Number.parseInt(e[0].getAttribute("aria-setsize"),10);e.some((a,m)=>String(l-(i-1)+m)!==a.getAttribute("aria-posinset"))&&(t=!0,this.parentEl?.append(...e))}else s&&(t=!0,this.swap(s,this.selectedLi));t&&(this.resetIndices(),this.updateDataFromDOM(),this.triggerEvent("itemMoveDown",this,{detail:{dataSet:this.data}}))}}#c(t){let e=this.actions;switch(t){case e.ADD:this.add();break;case e.DELETE:this.delete();break;case e.EDIT:this.edit();break;case e.MOVE_DOWN:this.moveDown();break;case e.MOVE_UP:this.moveUp();break;default:break}}#h(){this.onEvent("selected.list-builder-toolbar",this.toolbar,t=>{t.stopImmediatePropagation();let e=t.detail?.elem?.getAttribute("list-builder-action");this.#c(e)}),this.offEvent("afterdragend.listbuilder",this.container),this.onEvent("afterdragend.listbuilder",this.container,t=>{t.detail?.elem?.querySelector(".is-editing")&&this.#t?.focus()}),this.getAllSwappableItems()?.forEach(t=>{this.#l(t)})}#u(){this.selectedLi&&(this.#t?this.#e():this.#i(),this.focusLi(this.selectedLi))}#b(){this.getAllSwappableItems()?.forEach(t=>{this.#o(t)})}#l(t){t.offEvent("click"),this.offEvent("click",t),this.onEvent("click",t,()=>{this.focusLi(t),t.offEvent("click"),this.getAllSelectedLiIndex().includes(+this.getFocusedLiIndex())?this.#t||this.toggleSelectedLi(t):(this.#e(),this.toggleSelectedLi(t))})}#o(t){t.unlisten("Enter"),t.unlisten("ArrowUp"),t.unlisten("ArrowDown"),this.offEvent("keydown",t),this.onEvent("keydown",t,e=>{switch(e.key){case"Enter":e.preventDefault(),this.getAllSelectedLiIndex().includes(+this.getFocusedLiIndex())||this.toggleSelectedLi(t),this.#u();break;case" ":this.#t||(e.preventDefault(),this.toggleSelectedLi(t));break;case"Tab":this.#e();break;case"ArrowUp":this.focusLi(this.getFocusedLi().previousElementSibling),this.#e();break;case"ArrowDown":this.focusLi(this.getFocusedLi().nextElementSibling),this.#e();break;case"Delete":this.#r();break;default:break}})}getFocusedLi(){return this.container?.querySelector(`ids-swappable-item[role="listitem"][index="${this.getFocusedLiIndex()}"]`)??this.container?.querySelector('ids-swappable-item[role="listitem"][tabindex="0"]')}resetIndices(){let t=this.container?.querySelectorAll("ids-swappable-item");t?.forEach((e,i)=>{e.setAttribute("index",i.toString()),e.setAttribute("id",`id_item_${i+1}`),e.setAttribute("aria-posinset",`${i+1}`),e.setAttribute("aria-setsize",t.length.toString())})}set virtualScroll(t){}get virtualScroll(){return!1}};o=d([n("ids-list-builder"),c(p)],o);export{o as a};
