import{b as p,c}from"./ids-chunk-CN5QGFLE.js";import{a as l,b as r}from"./ids-chunk-KWUI36H2.js";function m(e=!1){let t=e?"header-contextmenu":"contextmenu",n=e?this.headerMenuId:this.menuId,i=e?this.headerMenuData:this.menuData,o=()=>this.shadowRoot?.querySelector(`slot[name="${t}"]`),s=o()?.assignedElements()[0];return!s&&n&&(s=this.closest("ids-container")?.querySelector(`#${n}`)),!s&&i&&(this.insertAdjacentHTML("beforeend",`<ids-popup-menu slot="${t}" trigger-type="custom"></ids-popup-menu>`),s=o()?.assignedElements()[0],s&&(s.data=i)),s}function h(e){e?.popup?.setAttribute("align","top, left"),e?.setAttribute("data-contextmenu-element","")}function g(e){let{menu:t,target:n,callbackArgs:i}=this.contextmenuInfo,o=!1;if(t&&n&&i){let s={...i,menuEl:t},a=i.type==="header";if(this.isDynamicContextmenu=!0,!this.triggerVetoableEvent("beforemenushow",s))return this.isDynamicContextmenu=!1,o;this.isDynamicContextmenu||(t.data=a?this.headerMenuData:this.menuData,t.popup?.setAttribute("align","top, left")),this.isDynamicContextmenu=!1,t.popup?.setPosition?.(e.clientX,e.clientY,!1,!0),t.show(),o=!0;let u=t.popup?.offsetHeight??0,d=this.wrapper?.offsetHeight??0;d>0&&u>d&&(t.popup?.setAttribute("max-height",`${d}px`),t.popup?.place()),t.focusTarget.focus(),this.triggerEvent("menushow",this,{bubbles:!0,detail:{elem:this,data:s}})}return o}function x(e,t,n){let i=l(e);t?.visible&&t?.hide(),n?.visible&&n?.hide(),this.contextmenuInfo={};let o={},s=r(i,'[role="columnheader"]'),a=r(i,'[role="gridcell"]');if(a&&t){let u=c.apply(this,[i,a]);o={menu:t,target:a,callbackArgs:u}}else if(s&&n){let u=p.apply(this,[i,s]);o={menu:n,target:s,callbackArgs:u}}this.contextmenuInfo={...o},g.apply(this,[e])&&e.preventDefault()}function f(e,t){if(t){let n={data:{...this.contextmenuInfo.callbackArgs,menuSelectedEvent:e,menuSelectedValue:e?.detail?.value,menuEl:t},elem:this};this.triggerEvent("menuselected",this,{bubbles:!0,detail:n})}}function D(){this.contextmenuInfo={};let e=m.apply(this),t=m.apply(this,[!0]);(e||t)&&(h(e),h(t),this.offEvent("contextmenu.datagrid",this.container),this.onEvent("contextmenu.datagrid",this.container,n=>{x.apply(this,[n,e,t])}),e&&(this.offEvent("selected.datagrid-contextmenu-item",e),this.onEvent("selected.datagrid-contextmenu-item",e,n=>{f.apply(this,[n,e])})),t&&(this.offEvent("selected.datagrid-contextmenu-item",t),this.onEvent("selected.datagrid-contextmenu-item",t,n=>{f.apply(this,[n,t])})))}export{m as a,D as b};
