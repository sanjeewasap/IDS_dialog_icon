import { ChangeDetectionStrategy, Component, HostBinding, Input, Output, EventEmitter } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoHierarchyLeafTemplateComponent {
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHierarchyLeafTemplateComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoHierarchyLeafTemplateComponent, selector: "soho-hierarchy-leaf-template", ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHierarchyLeafTemplateComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'soho-hierarchy-leaf-template',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }] });
export class SohoHierarchyComponent {
    set dataset(dataset) {
        this.options.dataset = dataset;
    }
    get dataset() {
        return this.options.dataset;
    }
    set legend(legend) {
        this.options.legend = legend;
    }
    get legend() {
        return this.options.legend;
    }
    set legendKey(key) {
        this.options.legendKey = key;
    }
    get legendKey() {
        return this.options.legendKey;
    }
    set templateId(id) {
        this.options.templateId = id;
    }
    get leafTemplateId() {
        return this.options.templateId;
    }
    set layout(layout) {
        this.options.layout = layout;
    }
    get layout() {
        return this.options.layout;
    }
    constructor(elementRef, ngZone) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        /** An internal options object that gets updated by using the component's Inputs(). */
        this.options = {};
        this.hostClass = 'hierarchy';
        /**
         * Leaf is selected
         *
         */
        this.selected = new EventEmitter();
        /**
         * Leaf is double clicked.
         */
        this.doubleClick = new EventEmitter();
    }
    /**
     * Used to add new data lazily when a leaf is expanded
     *
     * @param id should match the leaf id in the DOM
     */
    add(id, dataset, newData) {
        this.ngZone.runOutsideAngular(() => this.hierarchy?.add(id, dataset, newData));
    }
    /**
     *  Reload hierarchy with a new dataset
     */
    reloadDataSet(dataSet) {
        this.options.dataset = dataSet;
        this.ngZone.runOutsideAngular(() => this.hierarchy?.reload(this.options));
    }
    /**
     * Update actions for action menu on a leaf
     */
    updateActions(eventInfo, updatedActions) {
        this.ngZone.runOutsideAngular(() => this.hierarchy?.updateActions(eventInfo, updatedActions));
    }
    /**
     * Manually select leaf by id
     */
    selectLeaf(leafId) {
        this.ngZone.runOutsideAngular(() => this.hierarchy?.selectLeaf(leafId));
    }
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.hierarchy) {
                this.hierarchy.destroy();
                this.hierarchy = null;
            }
        });
    }
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // Wrap the "unordered list" element in a jQuery selector.
            this.jQueryElement = jQuery(this.elementRef.nativeElement);
            // Initialise the Soho control.
            this.jQueryElement.hierarchy(this.options);
            this.jQueryElement
                .on('dblclick', ((_e, args) => this.ngZone.run(() => this.doubleClick.next(args))))
                .on('selected', ((_e, args) => this.ngZone.run(() => this.selected.next(args))));
            // Assign the hierarchy control
            this.hierarchy = this.jQueryElement.data('hierarchy');
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHierarchyComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoHierarchyComponent, selector: "figure[soho-hierarchy]", inputs: { dataset: "dataset", legend: "legend", legendKey: "legendKey", templateId: "templateId", layout: "layout" }, outputs: { selected: "selected", doubleClick: "doubleClick" }, host: { properties: { "attr.class": "this.hostClass" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHierarchyComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'figure[soho-hierarchy]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { hostClass: [{
                type: HostBinding,
                args: ['attr.class']
            }], dataset: [{
                type: Input
            }], legend: [{
                type: Input
            }], legendKey: [{
                type: Input
            }], templateId: [{
                type: Input
            }], layout: [{
                type: Input
            }], selected: [{
                type: Output
            }], doubleClick: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1oaWVyYXJjaHkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9oaWVyYXJjaHkvc29oby1oaWVyYXJjaHkuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDVSx1QkFBdUIsRUFBRSxTQUFTLEVBQWMsV0FBVyxFQUFFLEtBQUssRUFDdEUsTUFBTSxFQUFFLFlBQVksRUFDaEMsTUFBTSxlQUFlLENBQUM7O0FBT3ZCLE1BQU0sT0FBTyxrQ0FBa0M7OEdBQWxDLGtDQUFrQztrR0FBbEMsa0NBQWtDLG9FQUhuQywyQkFBMkI7OzJGQUcxQixrQ0FBa0M7a0JBTDlDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLDhCQUE4QjtvQkFDeEMsUUFBUSxFQUFFLDJCQUEyQjtvQkFDckMsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07aUJBQ2hEOztBQVFELE1BQU0sT0FBTyxzQkFBc0I7SUFVakMsSUFBYSxPQUFPLENBQUMsT0FBK0I7UUFDbEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxJQUFJLE9BQU87UUFDVCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO0lBQzlCLENBQUM7SUFFRCxJQUFhLE1BQU0sQ0FBQyxNQUE4QztRQUNoRSxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7SUFDL0IsQ0FBQztJQUVELElBQUksTUFBTTtRQUNSLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7SUFDN0IsQ0FBQztJQUVELElBQWEsU0FBUyxDQUFDLEdBQXVCO1FBQzVDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQztJQUMvQixDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FB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ICBBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBIb3N0QmluZGluZywgSW5wdXQsXG4gIE9uRGVzdHJveSwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE5nWm9uZVxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc29oby1oaWVyYXJjaHktbGVhZi10ZW1wbGF0ZScsXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9IaWVyYXJjaHlMZWFmVGVtcGxhdGVDb21wb25lbnQgeyB9XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2ZpZ3VyZVtzb2hvLWhpZXJhcmNoeV0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9IaWVyYXJjaHlDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQge1xuXG4gIHByaXZhdGUgaGllcmFyY2h5PzogU29ob0hpZXJhcmNoeVN0YXRpYyB8IG51bGw7XG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcblxuICAvKiogQW4gaW50ZXJuYWwgb3B0aW9ucyBvYmplY3QgdGhhdCBnZXRzIHVwZGF0ZWQgYnkgdXNpbmcgdGhlIGNvbXBvbmVudCdzIElucHV0cygpLiAqL1xuICBwcml2YXRlIG9wdGlvbnM6IFNvaG9IaWVyYXJjaHlPcHRpb25zID0ge307XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmNsYXNzJykgaG9zdENsYXNzID0gJ2hpZXJhcmNoeSc7XG5cbiAgQElucHV0KCkgc2V0IGRhdGFzZXQoZGF0YXNldDogQXJyYXk8YW55PiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5kYXRhc2V0ID0gZGF0YXNldDtcbiAgfVxuXG4gIGdldCBkYXRhc2V0KCk6IEFycmF5PGFueT4gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuZGF0YXNldDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBsZWdlbmQobGVnZW5kOiBBcnJheTxTb2hvSGllcmFyY2h5TGVnZW5kPiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5sZWdlbmQgPSBsZWdlbmQ7XG4gIH1cblxuICBnZXQgbGVnZW5kKCk6IEFycmF5PFNvaG9IaWVyYXJjaHlMZWdlbmQ+IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmxlZ2VuZDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBsZWdlbmRLZXkoa2V5OiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMubGVnZW5kS2V5ID0ga2V5O1xuICB9XG5cbiAgZ2V0IGxlZ2VuZEtleSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMubGVnZW5kS2V5O1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHRlbXBsYXRlSWQoaWQ6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy50ZW1wbGF0ZUlkID0gaWQ7XG4gIH1cblxuICBnZXQgbGVhZlRlbXBsYXRlSWQoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLnRlbXBsYXRlSWQ7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgbGF5b3V0KGxheW91dDogU29ob0hpZXJhcmNoeUxheW91dFR5cGUgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMubGF5b3V0ID0gbGF5b3V0O1xuICB9XG5cbiAgZ2V0IGxheW91dCgpOiBTb2hvSGllcmFyY2h5TGF5b3V0VHlwZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5sYXlvdXQ7XG4gIH1cbiAgLyoqXG4gICAqIExlYWYgaXMgc2VsZWN0ZWRcbiAgICpcbiAgICovXG4gIEBPdXRwdXQoKSBzZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob0hpZXJhcmNoeUV2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBMZWFmIGlzIGRvdWJsZSBjbGlja2VkLlxuICAgKi9cbiAgQE91dHB1dCgpIGRvdWJsZUNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvSGllcmFyY2h5RG91YmxlQ2xpY2tFdmVudD4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgbmdab25lOiBOZ1pvbmUpIHsgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGFkZCBuZXcgZGF0YSBsYXppbHkgd2hlbiBhIGxlYWYgaXMgZXhwYW5kZWRcbiAgICpcbiAgICogQHBhcmFtIGlkIHNob3VsZCBtYXRjaCB0aGUgbGVhZiBpZCBpbiB0aGUgRE9NXG4gICAqL1xuICBhZGQoaWQ6IHN0cmluZywgZGF0YXNldDogQXJyYXk8YW55PiwgbmV3RGF0YTogQXJyYXk8YW55Pikge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuaGllcmFyY2h5Py5hZGQoaWQsIGRhdGFzZXQsIG5ld0RhdGEpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiAgUmVsb2FkIGhpZXJhcmNoeSB3aXRoIGEgbmV3IGRhdGFzZXRcbiAgICovXG4gIHJlbG9hZERhdGFTZXQoZGF0YVNldDogQXJyYXk8YW55Pikge1xuICAgIHRoaXMub3B0aW9ucy5kYXRhc2V0ID0gZGF0YVNldDtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLmhpZXJhcmNoeT8ucmVsb2FkKHRoaXMub3B0aW9ucykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhY3Rpb25zIGZvciBhY3Rpb24gbWVudSBvbiBhIGxlYWZcbiAgICovXG4gIHVwZGF0ZUFjdGlvbnMoZXZlbnRJbmZvOiBTb2hvSGllcmFyY2h5RXZlbnQsIHVwZGF0ZWRBY3Rpb25zOiBBcnJheTxTb2hvSGllcmFyY2h5QWN0aW9uPikge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuaGllcmFyY2h5Py51cGRhdGVBY3Rpb25zKGV2ZW50SW5mbywgdXBkYXRlZEFjdGlvbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW51YWxseSBzZWxlY3QgbGVhZiBieSBpZFxuICAgKi9cbiAgc2VsZWN0TGVhZihsZWFmSWQ6IHN0cmluZykge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuaGllcmFyY2h5Py5zZWxlY3RMZWFmKGxlYWZJZCkpO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmhpZXJhcmNoeSkge1xuICAgICAgICB0aGlzLmhpZXJhcmNoeS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuaGllcmFyY2h5ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAvLyBXcmFwIHRoZSBcInVub3JkZXJlZCBsaXN0XCIgZWxlbWVudCBpbiBhIGpRdWVyeSBzZWxlY3Rvci5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIC8vIEluaXRpYWxpc2UgdGhlIFNvaG8gY29udHJvbC5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5oaWVyYXJjaHkodGhpcy5vcHRpb25zKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50XG4gICAgICAgIC5vbignZGJsY2xpY2snLCAoKF9lOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFyZ3M6IFNvaG9IaWVyYXJjaHlEb3VibGVDbGlja0V2ZW50KSA9PiB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5kb3VibGVDbGljay5uZXh0KGFyZ3MpKSkpXG4gICAgICAgIC5vbignc2VsZWN0ZWQnLCAoKF9lOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFyZ3M6IFNvaG9IaWVyYXJjaHlFdmVudCkgPT4gdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMuc2VsZWN0ZWQubmV4dChhcmdzKSkpKTtcblxuICAgICAgLy8gQXNzaWduIHRoZSBoaWVyYXJjaHkgY29udHJvbFxuICAgICAgdGhpcy5oaWVyYXJjaHkgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnaGllcmFyY2h5Jyk7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==