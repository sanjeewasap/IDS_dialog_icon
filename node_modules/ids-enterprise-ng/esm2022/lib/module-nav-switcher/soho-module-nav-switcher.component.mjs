// tslint:disable-next-line:no-unused-variable
import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
/**
 * Angular Wrapper for the Soho Module Nav Switcher element.
 * This Component attaches to an element annotated with the `soho-module-nav-switcher` attribute,
 */
export class SohoModuleNavSwitcherComponent {
    /** Constructor. */
    constructor(elementRef, ngZone) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        /** Stored settings */
        this._options = {
            displayMode: false,
            generate: false,
            icon: undefined,
            moduleButtonText: undefined,
            roleDropdownLabel: undefined,
            roles: []
        };
        /** Internal use flags */
        this._updateRequired = false;
        // -------------------------------------------
        // Outputs
        // -------------------------------------------
        this.rolechange = new EventEmitter();
        this.modulebuttonclick = new EventEmitter();
    }
    // -------------------------------------------
    // Inputs
    // -------------------------------------------
    set displayMode(val) {
        this._options.displayMode = val;
        this.updated({ displayMode: this._options.displayMode });
    }
    get displayMode() {
        return this.modulenavswitcher?.settings.displayMode || this._options.displayMode;
    }
    set generate(val) {
        this._options.generate = val;
        this.updated({ generate: this._options.generate });
    }
    get generate() {
        return this.modulenavswitcher?.settings.generate || this._options.generate;
    }
    set icon(val) {
        this._options.icon = val;
        this.updated({ icon: this._options.icon });
    }
    get icon() {
        return this.modulenavswitcher?.settings.icon || this._options.icon;
    }
    set moduleButtonText(val) {
        this._options.moduleButtonText = val;
        this.updated({ moduleButtonText: this._options.moduleButtonText });
    }
    get moduleButtonText() {
        return this.modulenavswitcher?.settings.moduleButtonText || this._options.moduleButtonText;
    }
    set roleDropdownLabel(val) {
        this._options.roleDropdownLabel = val;
        this.updated({ roleDropdownLabel: this._options.roleDropdownLabel });
    }
    get roleDropdownLabel() {
        return this.modulenavswitcher?.settings.roleDropdownLabel || this._options.roleDropdownLabel;
    }
    set roles(val) {
        this._options.roles = val;
        this.updated({ roles: this._options.roles });
    }
    get roles() {
        return this.modulenavswitcher?.settings.roles || this._options.roles;
    }
    // -------------------------------------------
    // Public API
    // -------------------------------------------
    accordionAPI() {
        return this.modulenavswitcher?.accordionAPI;
    }
    accordionEl() {
        return this.modulenavswitcher?.accordionEl;
    }
    moduleButtonAPI() {
        return this.modulenavswitcher?.moduleButtonAPI;
    }
    roleDropdownAPI() {
        return this.modulenavswitcher?.roleDropdownAPI;
    }
    init() {
        this.modulenavswitcher?.init();
    }
    toggleModuleButtonFocus(doFocus) {
        this.modulenavswitcher?.toggleModuleButtonFocus(doFocus);
    }
    /** Triggers a UI Resync. */
    updated(val) {
        if (val) {
            this._options = jQuery.extend({}, this._options, val);
            if (this.modulenavswitcher) {
                this.ngZone.runOutsideAngular(() => {
                    this.modulenavswitcher?.updated(this._options);
                });
            }
        }
    }
    teardown() {
        this.modulenavswitcher?.teardown();
    }
    /** Sets the roles array programmatically */
    setRoles(val) {
        this.roles = val;
    }
    /** Triggered by a Module Button click */
    onModuleButtonClick(event) {
        this.modulebuttonclick.emit(event);
    }
    /** Triggered by a Role Dropdown change */
    onRoleChange(event) {
        this.rolechange.emit(event);
    }
    // ------------------------------------------
    // Lifecycle Events
    // ------------------------------------------
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // Initialize/store instance
            this.jQueryElement = jQuery(this.elementRef.nativeElement);
            this.jQueryElement.modulenavswitcher(this._options);
            this.modulenavswitcher = this.jQueryElement.data('modulenavswitcher');
            // @todo - add event binding control so we don't bind if not required.
            this.jQueryElement
                .on('change', (event) => this.onRoleChange(event));
        });
    }
    ngAfterViewChecked() {
        if (this.modulenavswitcher && this._updateRequired) {
            this.ngZone.runOutsideAngular(() => this.modulenavswitcher?.updated(this._options));
            this._updateRequired = false;
        }
    }
    ngOnDestroy() {
        // call outside the angular zone so change detection
        // isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.modulenavswitcher) {
                this.modulenavswitcher.destroy();
                this.modulenavswitcher = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoModuleNavSwitcherComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoModuleNavSwitcherComponent, selector: "soho-module-nav-switcher, [soho-module-nav-switcher]", inputs: { displayMode: "displayMode", generate: "generate", icon: "icon", moduleButtonText: "moduleButtonText", roleDropdownLabel: "roleDropdownLabel", roles: "roles" }, outputs: { rolechange: "rolechange", modulebuttonclick: "modulebuttonclick" }, ngImport: i0, template: "<div class=\"module-nav-section module-btn\">\n  <button\n    id=\"module-nav-homepage-btn\"\n    class=\"btn-icon\"\n    (click)=\"onModuleButtonClick($event)\">\n    <span class=\"audible\">{{moduleButtonText}}</span>\n  </button>\n</div>\n<div class=\"module-nav-section role-dropdown\">\n  <label for=\"module-nav-role-switcher\" class=\"label audible\">{{roleDropdownLabel}}</label>\n  <select soho-dropdown\n    id=\"module-nav-role-switcher\"\n    name=\"module-nav-role-switcher\"\n    class=\"dropdown\"\n    data-automation-id=\"custom-automation-dropdown-id\"\n    (change)=\"onRoleChange($event)\">\n    <option *ngFor=\"let role of roles\" [value]=\"role.value\">{{role.label}}</option>\n  </select>\n</div>\n", styles: ["soho-module-nav-switcher{display:contents}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoModuleNavSwitcherComponent, decorators: [{
            type: Component,
            args: [{ selector: 'soho-module-nav-switcher, [soho-module-nav-switcher]', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div class=\"module-nav-section module-btn\">\n  <button\n    id=\"module-nav-homepage-btn\"\n    class=\"btn-icon\"\n    (click)=\"onModuleButtonClick($event)\">\n    <span class=\"audible\">{{moduleButtonText}}</span>\n  </button>\n</div>\n<div class=\"module-nav-section role-dropdown\">\n  <label for=\"module-nav-role-switcher\" class=\"label audible\">{{roleDropdownLabel}}</label>\n  <select soho-dropdown\n    id=\"module-nav-role-switcher\"\n    name=\"module-nav-role-switcher\"\n    class=\"dropdown\"\n    data-automation-id=\"custom-automation-dropdown-id\"\n    (change)=\"onRoleChange($event)\">\n    <option *ngFor=\"let role of roles\" [value]=\"role.value\">{{role.label}}</option>\n  </select>\n</div>\n", styles: ["soho-module-nav-switcher{display:contents}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { displayMode: [{
                type: Input
            }], generate: [{
                type: Input
            }], icon: [{
                type: Input
            }], moduleButtonText: [{
                type: Input
            }], roleDropdownLabel: [{
                type: Input
            }], roles: [{
                type: Input
            }], rolechange: [{
                type: Output
            }], modulebuttonclick: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1tb2R1bGUtbmF2LXN3aXRjaGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvbW9kdWxlLW5hdi1zd2l0Y2hlci9zb2hvLW1vZHVsZS1uYXYtc3dpdGNoZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9tb2R1bGUtbmF2LXN3aXRjaGVyL3NvaG8tbW9kdWxlLW5hdi1zd2l0Y2hlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw4Q0FBOEM7QUFDOUMsT0FBTyxFQUdMLHVCQUF1QixFQUN2QixTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFHTCxNQUFNLEVBQ1AsTUFBTSxlQUFlLENBQUM7OztBQUV2Qjs7O0dBR0c7QUFPSCxNQUFNLE9BQU8sOEJBQThCO0lBcUJ6QyxtQkFBbUI7SUFDbkIsWUFDVSxVQUFzQixFQUN0QixNQUFjO1FBRGQsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBaEJ4QixzQkFBc0I7UUFDZCxhQUFRLEdBQWlDO1lBQy9DLFdBQVcsRUFBRSxLQUFLO1lBQ2xCLFFBQVEsRUFBRSxLQUFLO1lBQ2YsSUFBSSxFQUFFLFNBQVM7WUFDZixnQkFBZ0IsRUFBRSxTQUFTO1lBQzNCLGlCQUFpQixFQUFFLFNBQVM7WUFDNUIsS0FBSyxFQUFFLEVBQUU7U0FDVixDQUFDO1FBRUYseUJBQXlCO1FBQ2pCLG9CQUFlLEdBQVksS0FBSyxDQUFDO1FBNER6Qyw4Q0FBOEM7UUFDOUMsVUFBVTtRQUNWLDhDQUE4QztRQUVwQyxlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFFdkQsc0JBQWlCLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7SUE1RHBFLENBQUM7SUFFTCw4Q0FB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Q2pDLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsQ0FBQztnQkFDekIsSUFBSSxDQUFDLGFBQWEsR0FBRyxTQUFTLENBQUM7YUFDaEM7WUFDRCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtnQkFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxDQUFDO2dCQUNqQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO2FBQy9CO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDOzhHQXZMVSw4QkFBOEI7a0dBQTlCLDhCQUE4QixxVkN4QjNDLG90QkFtQkE7OzJGREthLDhCQUE4QjtrQkFOMUMsU0FBUzsrQkFDRSxzREFBc0QsbUJBRy9DLHVCQUF1QixDQUFDLE1BQU07c0hBaUNsQyxXQUFXO3NCQUF2QixLQUFLO2dCQVFPLFFBQVE7c0JBQXBCLEtBQUs7Z0JBUU8sSUFBSTtzQkFBaEIsS0FBSztnQkFRTyxnQkFBZ0I7c0JBQTVCLEtBQUs7Z0JBUU8saUJBQWlCO3NCQUE3QixLQUFLO2dCQVFPLEtBQUs7c0JBQWpCLEtBQUs7Z0JBWUksVUFBVTtzQkFBbkIsTUFBTTtnQkFFRyxpQkFBaUI7c0JBQTFCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tdW51c2VkLXZhcmlhYmxlXG5pbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBBZnRlclZpZXdDaGVja2VkLFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG4vKipcbiAqIEFuZ3VsYXIgV3JhcHBlciBmb3IgdGhlIFNvaG8gTW9kdWxlIE5hdiBTd2l0Y2hlciBlbGVtZW50LlxuICogVGhpcyBDb21wb25lbnQgYXR0YWNoZXMgdG8gYW4gZWxlbWVudCBhbm5vdGF0ZWQgd2l0aCB0aGUgYHNvaG8tbW9kdWxlLW5hdi1zd2l0Y2hlcmAgYXR0cmlidXRlLFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzb2hvLW1vZHVsZS1uYXYtc3dpdGNoZXIsIFtzb2hvLW1vZHVsZS1uYXYtc3dpdGNoZXJdJyxcbiAgc3R5bGVVcmxzOiBbJy4vc29oby1tb2R1bGUtbmF2LXN3aXRjaGVyLmNvbXBvbmVudC5jc3MnXSxcbiAgdGVtcGxhdGVVcmw6ICdzb2hvLW1vZHVsZS1uYXYtc3dpdGNoZXIuY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvTW9kdWxlTmF2U3dpdGNoZXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3kge1xuXG4gIC8qKiBSZWZlcmVuY2UgdG8gdGhlIGpRdWVyeSBlbGVtZW50LiAqL1xuICBwcml2YXRlIGpRdWVyeUVsZW1lbnQ/OiBKUXVlcnk7XG5cbiAgLyoqIFJlZmVyZW5jZSB0byB0aGUgYW5ub3RhdGVkIFNvSG9YaSBjb250cm9sICovXG4gIHByaXZhdGUgbW9kdWxlbmF2c3dpdGNoZXI/OiBTb2hvTW9kdWxlTmF2U3dpdGNoZXJTdGF0aWMgfCBudWxsO1xuXG4gIC8qKiBTdG9yZWQgc2V0dGluZ3MgKi9cbiAgcHJpdmF0ZSBfb3B0aW9uczogU29ob01vZHVsZU5hdlN3aXRjaGVyT3B0aW9ucyA9IHtcbiAgICBkaXNwbGF5TW9kZTogZmFsc2UsXG4gICAgZ2VuZXJhdGU6IGZhbHNlLFxuICAgIGljb246IHVuZGVmaW5lZCxcbiAgICBtb2R1bGVCdXR0b25UZXh0OiB1bmRlZmluZWQsXG4gICAgcm9sZURyb3Bkb3duTGFiZWw6IHVuZGVmaW5lZCxcbiAgICByb2xlczogW11cbiAgfTtcblxuICAvKiogSW50ZXJuYWwgdXNlIGZsYWdzICovXG4gIHByaXZhdGUgX3VwZGF0ZVJlcXVpcmVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqIENvbnN0cnVjdG9yLiAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcbiAgKSB7IH1cblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIElucHV0c1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgQElucHV0KCkgc2V0IGRpc3BsYXlNb2RlKHZhbDogU29ob01vZHVsZU5hdkRpc3BsYXlNb2RlIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5kaXNwbGF5TW9kZSA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBkaXNwbGF5TW9kZTogdGhpcy5fb3B0aW9ucy5kaXNwbGF5TW9kZSB9KTtcbiAgfVxuICBwdWJsaWMgZ2V0IGRpc3BsYXlNb2RlKCk6IFNvaG9Nb2R1bGVOYXZEaXNwbGF5TW9kZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2c3dpdGNoZXI/LnNldHRpbmdzLmRpc3BsYXlNb2RlIHx8IHRoaXMuX29wdGlvbnMuZGlzcGxheU1vZGU7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZ2VuZXJhdGUodmFsOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5nZW5lcmF0ZSA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBnZW5lcmF0ZTogdGhpcy5fb3B0aW9ucy5nZW5lcmF0ZSB9KTtcbiAgfVxuICBwdWJsaWMgZ2V0IGdlbmVyYXRlKCk6IGJvb2xlYW4gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZW5hdnN3aXRjaGVyPy5zZXR0aW5ncy5nZW5lcmF0ZSB8fCB0aGlzLl9vcHRpb25zLmdlbmVyYXRlO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGljb24odmFsOiBTb2hvTW9kdWxlTmF2U3dpdGNoZXJJY29uU2V0dGluZykge1xuICAgIHRoaXMuX29wdGlvbnMuaWNvbiA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBpY29uOiB0aGlzLl9vcHRpb25zLmljb24gfSk7XG4gIH1cbiAgcHVibGljIGdldCBpY29uKCk6IFNvaG9Nb2R1bGVOYXZTd2l0Y2hlckljb25TZXR0aW5nIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8uc2V0dGluZ3MuaWNvbiB8fCB0aGlzLl9vcHRpb25zLmljb247XG4gIH1cblxuICBASW5wdXQoKSBzZXQgbW9kdWxlQnV0dG9uVGV4dCh2YWw6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX29wdGlvbnMubW9kdWxlQnV0dG9uVGV4dCA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBtb2R1bGVCdXR0b25UZXh0OiB0aGlzLl9vcHRpb25zLm1vZHVsZUJ1dHRvblRleHQgfSk7XG4gIH1cbiAgcHVibGljIGdldCBtb2R1bGVCdXR0b25UZXh0KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2c3dpdGNoZXI/LnNldHRpbmdzLm1vZHVsZUJ1dHRvblRleHQgfHwgdGhpcy5fb3B0aW9ucy5tb2R1bGVCdXR0b25UZXh0O1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHJvbGVEcm9wZG93bkxhYmVsKHZhbDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5yb2xlRHJvcGRvd25MYWJlbCA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyByb2xlRHJvcGRvd25MYWJlbDogdGhpcy5fb3B0aW9ucy5yb2xlRHJvcGRvd25MYWJlbCB9KTtcbiAgfVxuICBwdWJsaWMgZ2V0IHJvbGVEcm9wZG93bkxhYmVsKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2c3dpdGNoZXI/LnNldHRpbmdzLnJvbGVEcm9wZG93bkxhYmVsIHx8IHRoaXMuX29wdGlvbnMucm9sZURyb3Bkb3duTGFiZWw7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgcm9sZXModmFsOiBBcnJheTxTb2hvTW9kdWxlTmF2U3dpdGNoZXJSb2xlUmVjb3JkPiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX29wdGlvbnMucm9sZXMgPSB2YWw7XG4gICAgdGhpcy51cGRhdGVkKHsgcm9sZXM6IHRoaXMuX29wdGlvbnMucm9sZXMgfSk7XG4gIH1cbiAgcHVibGljIGdldCByb2xlcygpOiBBcnJheTxTb2hvTW9kdWxlTmF2U3dpdGNoZXJSb2xlUmVjb3JkPiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2c3dpdGNoZXI/LnNldHRpbmdzLnJvbGVzIHx8IHRoaXMuX29wdGlvbnMucm9sZXM7XG4gIH1cblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIE91dHB1dHNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIEBPdXRwdXQoKSByb2xlY2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxKUXVlcnkuVHJpZ2dlcmVkRXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIG1vZHVsZWJ1dHRvbmNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxKUXVlcnkuVHJpZ2dlcmVkRXZlbnQ+KCk7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBQdWJsaWMgQVBJXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBwdWJsaWMgYWNjb3JkaW9uQVBJKCk6IFNvaG9BY2NvcmRpb25TdGF0aWMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZW5hdnN3aXRjaGVyPy5hY2NvcmRpb25BUEk7XG4gIH1cblxuICBwdWJsaWMgYWNjb3JkaW9uRWwoKSB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2c3dpdGNoZXI/LmFjY29yZGlvbkVsO1xuICB9XG5cbiAgcHVibGljIG1vZHVsZUJ1dHRvbkFQSSgpIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8ubW9kdWxlQnV0dG9uQVBJO1xuICB9XG5cbiAgcHVibGljIHJvbGVEcm9wZG93bkFQSSgpIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8ucm9sZURyb3Bkb3duQVBJO1xuICB9XG5cbiAgcHVibGljIGluaXQoKSB7XG4gICAgdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8uaW5pdCgpO1xuICB9XG5cbiAgcHVibGljIHRvZ2dsZU1vZHVsZUJ1dHRvbkZvY3VzKGRvRm9jdXM/OiBib29sZWFuKSB7XG4gICAgdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8udG9nZ2xlTW9kdWxlQnV0dG9uRm9jdXMoZG9Gb2N1cyk7XG4gIH1cblxuICAvKiogVHJpZ2dlcnMgYSBVSSBSZXN5bmMuICovXG4gIHB1YmxpYyB1cGRhdGVkKHZhbD86IFNvaG9Nb2R1bGVOYXZTd2l0Y2hlck9wdGlvbnMpIHtcbiAgICBpZiAodmFsKSB7XG4gICAgICB0aGlzLl9vcHRpb25zID0galF1ZXJ5LmV4dGVuZCh7fSwgdGhpcy5fb3B0aW9ucywgdmFsKTtcbiAgICAgIGlmICh0aGlzLm1vZHVsZW5hdnN3aXRjaGVyKSB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICB0aGlzLm1vZHVsZW5hdnN3aXRjaGVyPy51cGRhdGVkKHRoaXMuX29wdGlvbnMpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwdWJsaWMgdGVhcmRvd24oKSB7XG4gICAgdGhpcy5tb2R1bGVuYXZzd2l0Y2hlcj8udGVhcmRvd24oKTtcbiAgfVxuXG4gIC8qKiBTZXRzIHRoZSByb2xlcyBhcnJheSBwcm9ncmFtbWF0aWNhbGx5ICovXG4gIHNldFJvbGVzKHZhbDogQXJyYXk8U29ob01vZHVsZU5hdlN3aXRjaGVyUm9sZVJlY29yZD4pIHtcbiAgICB0aGlzLnJvbGVzID0gdmFsO1xuICB9XG5cbiAgLyoqIFRyaWdnZXJlZCBieSBhIE1vZHVsZSBCdXR0b24gY2xpY2sgKi9cbiAgb25Nb2R1bGVCdXR0b25DbGljayhldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KSB7XG4gICAgdGhpcy5tb2R1bGVidXR0b25jbGljay5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIC8qKiBUcmlnZ2VyZWQgYnkgYSBSb2xlIERyb3Bkb3duIGNoYW5nZSAqL1xuICBvblJvbGVDaGFuZ2UoZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCkge1xuICAgIHRoaXMucm9sZWNoYW5nZS5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBMaWZlY3ljbGUgRXZlbnRzXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAvLyBJbml0aWFsaXplL3N0b3JlIGluc3RhbmNlXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSBqUXVlcnkodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm1vZHVsZW5hdnN3aXRjaGVyKHRoaXMuX29wdGlvbnMpO1xuICAgICAgdGhpcy5tb2R1bGVuYXZzd2l0Y2hlciA9IHRoaXMualF1ZXJ5RWxlbWVudC5kYXRhKCdtb2R1bGVuYXZzd2l0Y2hlcicpO1xuXG4gICAgICAvLyBAdG9kbyAtIGFkZCBldmVudCBiaW5kaW5nIGNvbnRyb2wgc28gd2UgZG9uJ3QgYmluZCBpZiBub3QgcmVxdWlyZWQuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnRcbiAgICAgICAgLm9uKCdjaGFuZ2UnLCAoZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCkgPT4gdGhpcy5vblJvbGVDaGFuZ2UoZXZlbnQpKVxuICAgIH0pO1xuICB9XG5cbiAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xuICAgIGlmICh0aGlzLm1vZHVsZW5hdnN3aXRjaGVyICYmIHRoaXMuX3VwZGF0ZVJlcXVpcmVkKSB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLm1vZHVsZW5hdnN3aXRjaGVyPy51cGRhdGVkKHRoaXMuX29wdGlvbnMpKTtcbiAgICAgIHRoaXMuX3VwZGF0ZVJlcXVpcmVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvblxuICAgIC8vIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1vZHVsZW5hdnN3aXRjaGVyKSB7XG4gICAgICAgIHRoaXMubW9kdWxlbmF2c3dpdGNoZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm1vZHVsZW5hdnN3aXRjaGVyID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiPGRpdiBjbGFzcz1cIm1vZHVsZS1uYXYtc2VjdGlvbiBtb2R1bGUtYnRuXCI+XG4gIDxidXR0b25cbiAgICBpZD1cIm1vZHVsZS1uYXYtaG9tZXBhZ2UtYnRuXCJcbiAgICBjbGFzcz1cImJ0bi1pY29uXCJcbiAgICAoY2xpY2spPVwib25Nb2R1bGVCdXR0b25DbGljaygkZXZlbnQpXCI+XG4gICAgPHNwYW4gY2xhc3M9XCJhdWRpYmxlXCI+e3ttb2R1bGVCdXR0b25UZXh0fX08L3NwYW4+XG4gIDwvYnV0dG9uPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwibW9kdWxlLW5hdi1zZWN0aW9uIHJvbGUtZHJvcGRvd25cIj5cbiAgPGxhYmVsIGZvcj1cIm1vZHVsZS1uYXYtcm9sZS1zd2l0Y2hlclwiIGNsYXNzPVwibGFiZWwgYXVkaWJsZVwiPnt7cm9sZURyb3Bkb3duTGFiZWx9fTwvbGFiZWw+XG4gIDxzZWxlY3Qgc29oby1kcm9wZG93blxuICAgIGlkPVwibW9kdWxlLW5hdi1yb2xlLXN3aXRjaGVyXCJcbiAgICBuYW1lPVwibW9kdWxlLW5hdi1yb2xlLXN3aXRjaGVyXCJcbiAgICBjbGFzcz1cImRyb3Bkb3duXCJcbiAgICBkYXRhLWF1dG9tYXRpb24taWQ9XCJjdXN0b20tYXV0b21hdGlvbi1kcm9wZG93bi1pZFwiXG4gICAgKGNoYW5nZSk9XCJvblJvbGVDaGFuZ2UoJGV2ZW50KVwiPlxuICAgIDxvcHRpb24gKm5nRm9yPVwibGV0IHJvbGUgb2Ygcm9sZXNcIiBbdmFsdWVdPVwicm9sZS52YWx1ZVwiPnt7cm9sZS5sYWJlbH19PC9vcHRpb24+XG4gIDwvc2VsZWN0PlxuPC9kaXY+XG4iXX0=