import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Output, } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoBlockGridComponent {
    get isBlockGrid() {
        return true;
    }
    /** Defines the data to use, must be specified for this component. */
    set dataset(dataset) {
        this.options.dataset = dataset;
        if (this.blockgrid) {
            this.blockgrid.settings.dataset = dataset;
            this.updated(this.blockgrid.settings);
        }
    }
    get dataset() {
        if (!this.blockgrid) {
            return this.options.dataset;
        }
        return this.blockgrid.settings.dataset;
    }
    /** Defines the selection type. */
    set selectable(selectable) {
        this.options.selectable = selectable;
        if (this.blockgrid) {
            this.blockgrid.settings.selectable = selectable;
            this.updated(this.blockgrid.settings);
        }
    }
    get selectable() {
        if (!this.blockgrid) {
            return this.options.selectable;
        }
        return this.blockgrid.settings.selectable;
    }
    /** Defines whether or not paging is active. */
    set paging(paging) {
        this.options.paging = paging;
        if (this.blockgrid) {
            this.blockgrid.settings.paging = paging;
            this.updated(this.blockgrid.settings);
        }
    }
    get paging() {
        if (!this.blockgrid) {
            return this.options.paging;
        }
        return this.blockgrid.settings.paging;
    }
    /** Defines the current page size */
    set pagesize(pagesize) {
        this.options.pagerSettings.pagesize = pagesize;
        if (this.blockgrid) {
            this.blockgrid.settings.pagerSettings.pagesize = pagesize;
            this.updated(this.blockgrid.settings);
        }
    }
    get pagesize() {
        if (!this.blockgrid) {
            return this.options.pagerSettings.pagesize;
        }
        return this.blockgrid.settings.pagerSettings.pagesize;
    }
    /** Defines the array of selectable page sizes */
    set pagesizes(pagesizes) {
        this.options.pagerSettings.pagesizes = pagesizes;
        if (this.blockgrid) {
            this.blockgrid.settings.pagerSettings.pagesizes = pagesizes;
            this.updated(this.blockgrid.settings);
        }
    }
    get pagesizes() {
        if (!this.blockgrid) {
            return this.options.pagerSettings.pagesizes;
        }
        return this.blockgrid.settings.pagerSettings.pagesizes;
    }
    /** Add extra attributes like id's to the component **/
    set attributes(attributes) {
        this.options.attributes = attributes;
        if (this.blockgrid) {
            this.blockgrid.settings.attributes = attributes;
            this.updated(this.blockgrid.settings);
        }
    }
    get attributes() {
        if (!this.blockgrid) {
            return this.options.attributes;
        }
        return this.blockgrid.settings.attributes;
    }
    constructor(element, ngZone) {
        this.element = element;
        this.ngZone = ngZone;
        /** Options. */
        this.options = {
            pagerSettings: {
                position: 'bottom'
            }
        };
        /* Events*/
        this.selected = new EventEmitter();
        this.deselected = new EventEmitter();
        this.activated = new EventEmitter();
        this.deactivated = new EventEmitter();
        this.page = new EventEmitter();
        this.pagesizechange = new EventEmitter();
    }
    /** Setup */
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            this.jQueryElement = jQuery(this.element.nativeElement);
            this.jQueryElement.blockgrid(this.options);
            this.blockgrid = this.jQueryElement.data('blockgrid');
            // Setup the events
            this.jQueryElement.on('selected', (...args) => this.onSelected(args));
            this.jQueryElement.on('deselected', (...args) => this.onDeselected(args));
            this.jQueryElement.on('activated', (...args) => this.onActivated(args));
            this.jQueryElement.on('deactivated', (...args) => this.onDeactivated(args));
            if (this.blockgrid?.pagerAPI) {
                this.jQueryElement.on('page', (...args) => this.onPage(args));
                this.jQueryElement.on('pagesizechange', (...args) => this.onPageSizeChange(args));
            }
        });
    }
    /** Tear Down */
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.blockgrid) {
                this.blockgrid.destroy();
                this.blockgrid = null;
            }
        });
    }
    /** Reinit blockgrid settings */
    updated(settings) {
        this.ngZone.runOutsideAngular(() => this.blockgrid?.updated(settings));
        return this;
    }
    activateBlock(idx) {
        this.ngZone.runOutsideAngular(() => {
            const blockChildren = this.element.nativeElement.querySelectorAll('.block');
            if (!blockChildren || idx <= -1 || idx >= blockChildren.length) {
                return; // safety check
            }
            this.blockgrid?.select($(blockChildren[idx]), false);
        });
    }
    deactivateBlock() {
        this.blockgrid?.select($(), false);
    }
    selectBlocks(idx) {
        this.ngZone.runOutsideAngular(() => {
            const blockChildren = this.element.nativeElement.querySelectorAll('.block');
            const blockChildrenArray = Array.from(blockChildren).filter((_blockChild, index) => idx.includes(index));
            this.blockgrid?.select($(blockChildrenArray), true);
        });
    }
    onSelected(args) {
        this.ngZone.run(() => this.selected.emit(args));
    }
    onDeselected(args) {
        this.ngZone.run(() => this.deselected.emit(args));
    }
    onActivated(args) {
        this.ngZone.run(() => this.activated.emit(args));
    }
    onDeactivated(args) {
        this.ngZone.run(() => this.deactivated.emit(args));
    }
    onPage(args) {
        this.ngZone.run(() => this.page.emit(args));
    }
    onPageSizeChange(args) {
        this.ngZone.run(() => this.pagesizechange.emit(args));
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoBlockGridComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoBlockGridComponent, selector: "[soho-blockgrid]", inputs: { dataset: "dataset", selectable: "selectable", paging: "paging", pagesize: "pagesize", pagesizes: "pagesizes", attributes: "attributes" }, outputs: { selected: "selected", deselected: "deselected", activated: "activated", deactivated: "deactivated", page: "page", pagesizechange: "pagesizechange" }, host: { properties: { "class.blockgrid": "this.isBlockGrid" } }, ngImport: i0, template: '<ng-content></ng-content>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoBlockGridComponent, decorators: [{
            type: Component,
            args: [{
                    selector: '[soho-blockgrid]',
                    template: '<ng-content></ng-content>',
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { isBlockGrid: [{
                type: HostBinding,
                args: ['class.blockgrid']
            }], dataset: [{
                type: Input
            }], selectable: [{
                type: Input
            }], paging: [{
                type: Input
            }], pagesize: [{
                type: Input
            }], pagesizes: [{
                type: Input
            }], attributes: [{
                type: Input
            }], selected: [{
                type: Output
            }], deselected: [{
                type: Output
            }], activated: [{
                type: Output
            }], deactivated: [{
                type: Output
            }], page: [{
                type: Output
            }], pagesizechange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1ibG9ja2dyaWQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9ibG9ja2dyaWQvc29oby1ibG9ja2dyaWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUVULFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUdMLE1BQU0sR0FDUCxNQUFNLGVBQWUsQ0FBQzs7QUFPdkIsTUFBTSxPQUFPLHNCQUFzQjtJQVdqQyxJQUFvQyxXQUFXO1FBQzdDLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELHFFQUFxRTtJQUNyRSxJQUNXLE9BQU8sQ0FBQyxPQUErQjtRQUNoRCxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFFL0IsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7WUFDMUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3ZDO0lBQ0gsQ0FBQztJQUNELElBQVcsT0FBTztRQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO1NBQzdCO1FBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7SUFDekMsQ0FBQztJQUVELGtDQUFrQztJQUNsQyxJQUNXLFVBQVUsQ0FBQyxVQUFtQztRQUN2RCxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDckMsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxTQUFT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RSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVPLGdCQUFnQixDQUFDLElBQVc7UUFDbEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN4RCxDQUFDOzhHQWxOVSxzQkFBc0I7a0dBQXRCLHNCQUFzQiw4YUFIdkIsMkJBQTJCOzsyRkFHMUIsc0JBQXNCO2tCQUxsQyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxrQkFBa0I7b0JBQzVCLFFBQVEsRUFBRSwyQkFBMkI7b0JBQ3JDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNO2lCQUNoRDtzSEFZcUMsV0FBVztzQkFBOUMsV0FBVzt1QkFBQyxpQkFBaUI7Z0JBTW5CLE9BQU87c0JBRGpCLEtBQUs7Z0JBa0JLLFVBQVU7c0JBRHBCLEtBQUs7Z0JBaUJLLE1BQU07c0JBRGhCLEtBQUs7Z0JBaUJLLFFBQVE7c0JBRGxCLEtBQUs7Z0JBaUJLLFNBQVM7c0JBRG5CLEtBQUs7Z0JBaUJLLFVBQVU7c0JBRHBCLEtBQUs7Z0JBZ0JJLFFBQVE7c0JBQWpCLE1BQU07Z0JBQ0csVUFBVTtzQkFBbkIsTUFBTTtnQkFDRyxTQUFTO3NCQUFsQixNQUFNO2dCQUNHLFdBQVc7c0JBQXBCLE1BQU07Z0JBQ0csSUFBSTtzQkFBYixNQUFNO2dCQUNHLGNBQWM7c0JBQXZCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCxcbiAgTmdab25lLFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ1tzb2hvLWJsb2NrZ3JpZF0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiAnPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PicsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9CbG9ja0dyaWRDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuXG4gIC8qKiBPcHRpb25zLiAqL1xuICBwcml2YXRlIG9wdGlvbnM6IFNvaG9CbG9ja0dyaWRPcHRpb25zID0ge1xuICAgIHBhZ2VyU2V0dGluZ3M6IHtcbiAgICAgIHBvc2l0aW9uOiAnYm90dG9tJ1xuICAgIH1cbiAgfTtcbiAgcHJpdmF0ZSBqUXVlcnlFbGVtZW50PzogSlF1ZXJ5O1xuICBwcml2YXRlIGJsb2NrZ3JpZD86IFNvaG9CbG9ja0dyaWQgfCBudWxsO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuYmxvY2tncmlkJykgZ2V0IGlzQmxvY2tHcmlkKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIERlZmluZXMgdGhlIGRhdGEgdG8gdXNlLCBtdXN0IGJlIHNwZWNpZmllZCBmb3IgdGhpcyBjb21wb25lbnQuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgZGF0YXNldChkYXRhc2V0OiBBcnJheTxhbnk+IHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5vcHRpb25zLmRhdGFzZXQgPSBkYXRhc2V0O1xuXG4gICAgaWYgKHRoaXMuYmxvY2tncmlkKSB7XG4gICAgICB0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncy5kYXRhc2V0ID0gZGF0YXNldDtcbiAgICAgIHRoaXMudXBkYXRlZCh0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncyk7XG4gICAgfVxuICB9XG4gIHB1YmxpYyBnZXQgZGF0YXNldCgpOiBBcnJheTxhbnk+IHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuYmxvY2tncmlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmRhdGFzZXQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncy5kYXRhc2V0O1xuICB9XG5cbiAgLyoqIERlZmluZXMgdGhlIHNlbGVjdGlvbiB0eXBlLiAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IHNlbGVjdGFibGUoc2VsZWN0YWJsZTogU29ob0Jsb2NrR3JpZFNlbGVjdGFibGUpIHtcbiAgICB0aGlzLm9wdGlvbnMuc2VsZWN0YWJsZSA9IHNlbGVjdGFibGU7XG4gICAgaWYgKHRoaXMuYmxvY2tncmlkKSB7XG4gICAgICB0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncy5zZWxlY3RhYmxlID0gc2VsZWN0YWJsZTtcbiAgICAgIHRoaXMudXBkYXRlZCh0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncyk7XG4gICAgfVxuICB9XG4gIHB1YmxpYyBnZXQgc2VsZWN0YWJsZSgpOiBTb2hvQmxvY2tHcmlkU2VsZWN0YWJsZSB7XG4gICAgaWYgKCF0aGlzLmJsb2NrZ3JpZCkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5zZWxlY3RhYmxlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5ibG9ja2dyaWQuc2V0dGluZ3Muc2VsZWN0YWJsZTtcbiAgfVxuXG4gIC8qKiBEZWZpbmVzIHdoZXRoZXIgb3Igbm90IHBhZ2luZyBpcyBhY3RpdmUuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgcGFnaW5nKHBhZ2luZzogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5wYWdpbmcgPSBwYWdpbmc7XG4gICAgaWYgKHRoaXMuYmxvY2tncmlkKSB7XG4gICAgICB0aGlzLmJsb2NrZ3JpZC5zZXR0aW5ncy5wYWdpbmcgPSBwYWdpbmc7XG4gICAgICB0aGlzLnVwZGF0ZWQodGhpcy5ibG9ja2dyaWQuc2V0dGluZ3MpO1xuICAgIH1cbiAgfVxuICBwdWJsaWMgZ2V0IHBhZ2luZygpOiBib29sZWFuIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuYmxvY2tncmlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnBhZ2luZztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLnBhZ2luZztcbiAgfVxuXG4gIC8qKiBEZWZpbmVzIHRoZSBjdXJyZW50IHBhZ2Ugc2l6ZSAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IHBhZ2VzaXplKHBhZ2VzaXplOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMucGFnZXJTZXR0aW5ncy5wYWdlc2l6ZSA9IHBhZ2VzaXplO1xuICAgIGlmICh0aGlzLmJsb2NrZ3JpZCkge1xuICAgICAgdGhpcy5ibG9ja2dyaWQuc2V0dGluZ3MucGFnZXJTZXR0aW5ncy5wYWdlc2l6ZSA9IHBhZ2VzaXplO1xuICAgICAgdGhpcy51cGRhdGVkKHRoaXMuYmxvY2tncmlkLnNldHRpbmdzKTtcbiAgICB9XG4gIH1cbiAgcHVibGljIGdldCBwYWdlc2l6ZSgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIGlmICghdGhpcy5ibG9ja2dyaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMucGFnZXJTZXR0aW5ncy5wYWdlc2l6ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLnBhZ2VyU2V0dGluZ3MucGFnZXNpemU7XG4gIH1cblxuICAvKiogRGVmaW5lcyB0aGUgYXJyYXkgb2Ygc2VsZWN0YWJsZSBwYWdlIHNpemVzICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgcGFnZXNpemVzKHBhZ2VzaXplczogQXJyYXk8bnVtYmVyPiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5wYWdlclNldHRpbmdzLnBhZ2VzaXplcyA9IHBhZ2VzaXplcztcbiAgICBpZiAodGhpcy5ibG9ja2dyaWQpIHtcbiAgICAgIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLnBhZ2VyU2V0dGluZ3MucGFnZXNpemVzID0gcGFnZXNpemVzO1xuICAgICAgdGhpcy51cGRhdGVkKHRoaXMuYmxvY2tncmlkLnNldHRpbmdzKTtcbiAgICB9XG4gIH1cbiAgcHVibGljIGdldCBwYWdlc2l6ZXMoKTogQXJyYXk8bnVtYmVyPiB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLmJsb2NrZ3JpZCkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5wYWdlclNldHRpbmdzLnBhZ2VzaXplcztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLnBhZ2VyU2V0dGluZ3MucGFnZXNpemVzO1xuICB9XG5cbiAgLyoqIEFkZCBleHRyYSBhdHRyaWJ1dGVzIGxpa2UgaWQncyB0byB0aGUgY29tcG9uZW50ICoqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IGF0dHJpYnV0ZXMoYXR0cmlidXRlczogQXJyYXk8T2JqZWN0PiB8IE9iamVjdCB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICBpZiAodGhpcy5ibG9ja2dyaWQpIHtcbiAgICAgIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgICAgdGhpcy51cGRhdGVkKHRoaXMuYmxvY2tncmlkLnNldHRpbmdzKTtcbiAgICB9XG4gIH1cbiAgcHVibGljIGdldCBhdHRyaWJ1dGVzKCk6IEFycmF5PE9iamVjdD4gfCBPYmplY3QgfCB1bmRlZmluZWQge1xuICAgIGlmICghdGhpcy5ibG9ja2dyaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYXR0cmlidXRlcztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYmxvY2tncmlkLnNldHRpbmdzLmF0dHJpYnV0ZXM7XG4gIH1cblxuICAvKiBFdmVudHMqL1xuICBAT3V0cHV0KCkgc2VsZWN0ZWQ6IEV2ZW50RW1pdHRlcjxPYmplY3RbXT4gPSBuZXcgRXZlbnRFbWl0dGVyPE9iamVjdFtdPigpO1xuICBAT3V0cHV0KCkgZGVzZWxlY3RlZDogRXZlbnRFbWl0dGVyPE9iamVjdFtdPiA9IG5ldyBFdmVudEVtaXR0ZXI8T2JqZWN0W10+KCk7XG4gIEBPdXRwdXQoKSBhY3RpdmF0ZWQ6IEV2ZW50RW1pdHRlcjxPYmplY3RbXT4gPSBuZXcgRXZlbnRFbWl0dGVyPE9iamVjdFtdPigpO1xuICBAT3V0cHV0KCkgZGVhY3RpdmF0ZWQ6IEV2ZW50RW1pdHRlcjxPYmplY3RbXT4gPSBuZXcgRXZlbnRFbWl0dGVyPE9iamVjdFtdPigpO1xuICBAT3V0cHV0KCkgcGFnZTogRXZlbnRFbWl0dGVyPE9iamVjdFtdPiA9IG5ldyBFdmVudEVtaXR0ZXI8T2JqZWN0W10+KCk7XG4gIEBPdXRwdXQoKSBwYWdlc2l6ZWNoYW5nZTogRXZlbnRFbWl0dGVyPE9iamVjdFtdPiA9IG5ldyBFdmVudEVtaXR0ZXI8T2JqZWN0W10+KCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmVcbiAgKSB7IH1cblxuICAvKiogU2V0dXAgKi9cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQuYmxvY2tncmlkKHRoaXMub3B0aW9ucyk7XG4gICAgICB0aGlzLmJsb2NrZ3JpZCA9IHRoaXMualF1ZXJ5RWxlbWVudC5kYXRhKCdibG9ja2dyaWQnKTtcblxuICAgICAgLy8gU2V0dXAgdGhlIGV2ZW50c1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdzZWxlY3RlZCcsICguLi5hcmdzKSA9PiB0aGlzLm9uU2VsZWN0ZWQoYXJncykpO1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdkZXNlbGVjdGVkJywgKC4uLmFyZ3MpID0+IHRoaXMub25EZXNlbGVjdGVkKGFyZ3MpKTtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignYWN0aXZhdGVkJywgKC4uLmFyZ3MpID0+IHRoaXMub25BY3RpdmF0ZWQoYXJncykpO1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdkZWFjdGl2YXRlZCcsICguLi5hcmdzKSA9PiB0aGlzLm9uRGVhY3RpdmF0ZWQoYXJncykpO1xuXG4gICAgICBpZiAodGhpcy5ibG9ja2dyaWQ/LnBhZ2VyQVBJKSB7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbigncGFnZScsICguLi5hcmdzKSA9PiB0aGlzLm9uUGFnZShhcmdzKSk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbigncGFnZXNpemVjaGFuZ2UnLCAoLi4uYXJncykgPT4gdGhpcy5vblBhZ2VTaXplQ2hhbmdlKGFyZ3MpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBUZWFyIERvd24gKi9cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmJsb2NrZ3JpZCkge1xuICAgICAgICB0aGlzLmJsb2NrZ3JpZC5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuYmxvY2tncmlkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBSZWluaXQgYmxvY2tncmlkIHNldHRpbmdzICovXG4gIHB1YmxpYyB1cGRhdGVkKHNldHRpbmdzOiBhbnkpOiBTb2hvQmxvY2tHcmlkQ29tcG9uZW50IHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLmJsb2NrZ3JpZD8udXBkYXRlZChzZXR0aW5ncykpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIGFjdGl2YXRlQmxvY2soaWR4OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBjb25zdCBibG9ja0NoaWxkcmVuOiBOb2RlTGlzdCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibG9jaycpO1xuICAgICAgaWYgKCFibG9ja0NoaWxkcmVuIHx8IGlkeCA8PSAtMSB8fCBpZHggPj0gYmxvY2tDaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuOyAvLyBzYWZldHkgY2hlY2tcbiAgICAgIH1cblxuICAgICAgdGhpcy5ibG9ja2dyaWQ/LnNlbGVjdCgkKGJsb2NrQ2hpbGRyZW5baWR4XSksIGZhbHNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBkZWFjdGl2YXRlQmxvY2soKTogdm9pZCB7XG4gICAgdGhpcy5ibG9ja2dyaWQ/LnNlbGVjdCgkKCksIGZhbHNlKTtcbiAgfVxuXG4gIHB1YmxpYyBzZWxlY3RCbG9ja3MoaWR4OiBudW1iZXJbXSkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGNvbnN0IGJsb2NrQ2hpbGRyZW46IE5vZGVMaXN0ID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJsb2NrJyk7XG4gICAgICBjb25zdCBibG9ja0NoaWxkcmVuQXJyYXkgPSBBcnJheS5mcm9tKGJsb2NrQ2hpbGRyZW4pLmZpbHRlcigoX2Jsb2NrQ2hpbGQsIGluZGV4KSA9PiBpZHguaW5jbHVkZXMoaW5kZXgpKTtcbiAgICAgIHRoaXMuYmxvY2tncmlkPy5zZWxlY3QoJChibG9ja0NoaWxkcmVuQXJyYXkpLCB0cnVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgb25TZWxlY3RlZChhcmdzOiBhbnlbXSkge1xuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLnNlbGVjdGVkLmVtaXQoYXJncykpO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkRlc2VsZWN0ZWQoYXJnczogYW55W10pIHtcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5kZXNlbGVjdGVkLmVtaXQoYXJncykpO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkFjdGl2YXRlZChhcmdzOiBhbnlbXSkge1xuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmFjdGl2YXRlZC5lbWl0KGFyZ3MpKTtcbiAgfVxuXG4gIHByaXZhdGUgb25EZWFjdGl2YXRlZChhcmdzOiBhbnlbXSkge1xuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmRlYWN0aXZhdGVkLmVtaXQoYXJncykpO1xuICB9XG5cbiAgcHJpdmF0ZSBvblBhZ2UoYXJnczogYW55W10pIHtcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5wYWdlLmVtaXQoYXJncykpO1xuICB9XG5cbiAgcHJpdmF0ZSBvblBhZ2VTaXplQ2hhbmdlKGFyZ3M6IGFueVtdKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMucGFnZXNpemVjaGFuZ2UuZW1pdChhcmdzKSk7XG4gIH1cbn1cbiJdfQ==