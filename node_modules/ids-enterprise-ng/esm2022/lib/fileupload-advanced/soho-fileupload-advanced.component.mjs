import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output, HostBinding, } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoFileUploadAdvancedComponent {
    // -------------------------------------------
    // Component Input
    // -------------------------------------------
    /**
     * Set the disabled state of the control.
     */
    set disabled(value) {
        this.isDisabled = value;
        if (this.fileuploadadvanced) {
            if (value) {
                this.ngZone.runOutsideAngular(() => {
                    this.fileuploadadvanced?.disable();
                });
                this.isDisabled = true;
            }
            else {
                this.ngZone.runOutsideAngular(() => {
                    this.fileuploadadvanced?.enable();
                });
                this.isDisabled = false;
            }
        }
    }
    get disabled() {
        return this.isDisabled;
    }
    /**
     * On page(true) -or- on modal (false) , this is used for some visual style only.
     *
     * @param isStandalone true for onPage otherwise false.
     */
    set isStandalone(isStandaline) {
        this.options.isStandalone = isStandaline;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.isStandalone = isStandaline;
            this.markForRefresh();
        }
    }
    get isStandalone() {
        return this.options.isStandalone;
    }
    /**
     * Restrict file types(ie. 'jpg|png|gif') ['*' all types]
     *
     * @param allowedTypes - the allowed types.
     */
    set allowedTypes(allowedTypes) {
        this.options.allowedTypes = allowedTypes;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.allowedTypes = allowedTypes;
            this.markForRefresh();
        }
    }
    get allowedTypes() {
        return this.options.allowedTypes;
    }
    /**
     * Defines the send method used to upload the files.
     *
     * The send function takes the FormData containing the file, and a
     * status interface to provide fedback to the control whilst uploading.
     *
     * @param sendFn - the callback function responsible to uploading the file.
     */
    set send(sendFn) {
        this.options.send = sendFn;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.send = sendFn;
            this.markForRefresh();
        }
    }
    get send() {
        return this.options.send;
    }
    /**
     * Restricts the number of files that can be retrieved in total.
     *
     * @param maxFiles - max files cab be upload.
     */
    set maxFiles(maxFiles) {
        this.options.maxFiles = maxFiles;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.maxFiles = maxFiles;
            this.markForRefresh();
        }
    }
    get maxFiles() {
        return this.options.maxFiles;
    }
    /**
     * Restricts the number of files that can be retrieved while in process.
     *
     * @param maxFilesInProcess - the callback function responsible to uploading the file.
     */
    set maxFilesInProcess(maxFilesInProcess) {
        this.options.maxFilesInProcess = maxFilesInProcess;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.maxFilesInProcess = maxFilesInProcess;
            this.markForRefresh();
        }
    }
    get maxFilesInProcess() {
        return this.options.maxFilesInProcess;
    }
    /**
     * Max file size in bytes, -1 for unlimited.
     *
     * @param maxFileSize - Max file size in bytes, -1 for unlimited.
     */
    set maxFileSize(maxFileSize) {
        this.options.maxFileSize = maxFileSize;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.maxFileSize = maxFileSize;
            this.markForRefresh();
        }
    }
    get maxFileSize() {
        return this.options.maxFileSize;
    }
    /**
     * Variable name to read from server.
     *
     * @param fileName - Variable name to read from server..
     */
    set fileName(fileName) {
        this.options.fileName = fileName;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.fileName = fileName;
            this.markForRefresh();
        }
    }
    get fileName() {
        return this.options.fileName;
    }
    /**
     * Add way to browse files to upload
     *
     * @param showBrowseButton - if true, displays the browse button; otherwise do not.
     */
    set showBrowseButton(showBrowseButton) {
        this.options.showBrowseButton = showBrowseButton;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.showBrowseButton = showBrowseButton;
            this.markForRefresh();
        }
    }
    get showBrowseButton() {
        return this.options.showBrowseButton;
    }
    /**
     * Text to show in drop area.
     *
     * @param textDropArea - Text to show in drop area.
     */
    set textDropArea(textDropArea) {
        this.options.textDropArea = textDropArea;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.textDropArea = textDropArea;
            this.markForRefresh();
        }
    }
    get textDropArea() {
        return this.options.textDropArea;
    }
    /**
     * Text to show in drop area when browse option true.
     *
     * @param textDropAreaWithBrowse - Text to show in drop area when browse option true.
     */
    set textDropAreaWithBrowse(textDropAreaWithBrowse) {
        this.options.textDropAreaWithBrowse = textDropAreaWithBrowse;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.textDropAreaWithBrowse = textDropAreaWithBrowse;
            this.markForRefresh();
        }
    }
    get textDropAreaWithBrowse() {
        return this.options.textDropAreaWithBrowse;
    }
    /**
     * Hidden text for cancel button.
     *
     * @param textBtnCancel - Hidden text for cancel button.
     */
    set textBtnCancel(textBtnCancel) {
        this.options.textBtnCancel = textBtnCancel;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.textBtnCancel = textBtnCancel;
            this.markForRefresh();
        }
    }
    get textBtnCancel() {
        return this.options.textBtnCancel;
    }
    /**
     * Hidden text for error close button
     *
     * @param textBtnCloseError - Hidden text for error close button.
     */
    set textBtnCloseError(textBtnCloseError) {
        this.options.textBtnCloseError = textBtnCloseError;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.textBtnCloseError = textBtnCloseError;
            this.markForRefresh();
        }
    }
    get textBtnCloseError() {
        return this.options.textBtnCloseError;
    }
    /**
     * Hidden text for remove button.
     *
     * @param textBtnRemove - Hidden text for remove button.
     */
    set textBtnRemove(textBtnRemove) {
        this.options.textBtnRemove = textBtnRemove;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.textBtnRemove = textBtnRemove;
            this.markForRefresh();
        }
    }
    get textBtnRemove() {
        return this.options.textBtnRemove;
    }
    /**
     *
     */
    set errorMaxFiles(errorMaxFiles) {
        this.options.errorMaxFiles = errorMaxFiles;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.updated(this.fileuploadadvanced.settings);
            this.markForRefresh();
        }
    }
    get errorMaxFiles() {
        return this.options.errorMaxFiles;
    }
    /**
     *
     */
    set errorMaxFilesInProcess(errorMaxFilesInProcess) {
        this.options.errorMaxFilesInProcess = errorMaxFilesInProcess;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.updated(this.fileuploadadvanced.settings);
            this.markForRefresh();
        }
    }
    get errorMaxFilesInProcess() {
        return this.options.errorMaxFilesInProcess;
    }
    /**
     *
     */
    set errorMaxFileSize(errorMaxFilesSize) {
        this.options.errorMaxFileSize = errorMaxFilesSize;
        if (this.fileuploadadvanced) {
            this.fileuploadadvanced.settings.errorMaxFileSize = errorMaxFilesSize;
            this.markForRefresh();
        }
    }
    get errorMaxFileSize() {
        return this.options.errorMaxFileSize;
    }
    // -------------------------------------------
    // Public API
    // -------------------------------------------
    /**
     * Updates the control by merging the given settings into
     * the EP widget.
     *
     * @param settings the settings to merge.
     */
    updated(settings) {
        if (this.fileuploadadvanced) {
            this.ngZone.runOutsideAngular(() => {
                this.fileuploadadvanced?.updated(settings);
            });
            this.options = this.fileuploadadvanced.settings;
        }
        else {
            this.options = settings;
        }
    }
    /**
     * Destroys the control.
     */
    destroy() {
        if (this.fileuploadadvanced) {
            this.ngZone.runOutsideAngular(() => {
                this.fileuploadadvanced?.destroy();
            });
            this.fileuploadadvanced = null;
        }
    }
    /**
     * Constructor.
     */
    constructor(element, ref, ngZone) {
        this.element = element;
        this.ref = ref;
        this.ngZone = ngZone;
        /**
         * Add class to host element to ensure correct styling and detection by EP controls.
         */
        this.isFileUploadAdvanced = true;
        // -------------------------------------------
        // Component Output
        // -------------------------------------------
        /**
         * Called when the fileupload value changes
         */
        this.filesdragenter = new EventEmitter();
        this.filesdropped = new EventEmitter();
        this.beforecreatestatus = new EventEmitter();
        this.aftercreatestatus = new EventEmitter();
        this.fileprogress = new EventEmitter();
        this.fileaborted = new EventEmitter();
        this.filecompleteduploading = new EventEmitter();
        this.fileremoved = new EventEmitter();
        // -------------------------------------------
        // Private Member Data
        // -------------------------------------------
        /** Set of options for this control. */
        this.options = {};
    }
    ngAfterViewInit() {
        this.jQueryElement = jQuery(this.element.nativeElement);
        this.jQueryElement.fileuploadadvanced(this.options);
        this.jQueryElement
            .on('filesdragenter', (e) => {
            this.ngZone.run(() => {
                this.filesdragenter.next(e);
            });
        })
            .on('filesdroped', (_args, files) => {
            this.ngZone.run(() => this.filesdropped.next(files));
        })
            .on('beforecreatestatus', (_args, files) => {
            this.ngZone.run(() => this.beforecreatestatus.next(files));
        })
            .on('aftercreatestatus', (_args, files) => {
            this.ngZone.run(() => this.aftercreatestatus.next(files));
        })
            .on('fileprogress', (_args, files) => {
            this.ngZone.run(() => this.fileprogress.next(files));
        })
            .on('fileaborted', (_args, files) => {
            this.ngZone.run(() => this.fileaborted.next(files));
        })
            .on('filecompleteuploading', (_args, files) => {
            this.ngZone.run(() => {
                this.filecompleteduploading.next(files);
            });
        })
            .on('fileremoved', (_args, files) => {
            this.ngZone.run(() => {
                this.fileremoved.next(files);
            });
        });
        this.fileuploadadvanced = this.jQueryElement.data('fileuploadadvanced');
    }
    ngAfterViewChecked() {
        if (this.runUpdatedOnCheck) {
            this.ngZone.runOutsideAngular(() => {
                this.updated(this.options);
                this.runUpdatedOnCheck = false;
            });
        }
    }
    ngOnDestroy() {
        if (this.fileuploadadvanced) {
            this.ngZone.runOutsideAngular(() => {
                this.fileuploadadvanced?.destroy();
            });
            this.fileuploadadvanced = null;
        }
    }
    /**
     * Marks the components as requiring a rebuild after the next update.
     */
    markForRefresh() {
        // Run updated on the next updated check.
        this.runUpdatedOnCheck = true;
        // ... make sure the change detector kicks in, otherwise if the inputs
        // were change programmatically the component may not be eligible for
        // updating.
        this.ref.markForCheck();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoFileUploadAdvancedComponent, deps: [{ token: i0.ElementRef }, { token: i0.ChangeDetectorRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoFileUploadAdvancedComponent, selector: "soho-fileupload-advanced,div[soho-fileupload-advanced]", inputs: { disabled: "disabled", isStandalone: "isStandalone", allowedTypes: "allowedTypes", send: "send", maxFiles: "maxFiles", maxFilesInProcess: "maxFilesInProcess", maxFileSize: "maxFileSize", fileName: "fileName", showBrowseButton: "showBrowseButton", textDropArea: "textDropArea", textDropAreaWithBrowse: "textDropAreaWithBrowse", textBtnCancel: "textBtnCancel", textBtnCloseError: "textBtnCloseError", textBtnRemove: "textBtnRemove", errorMaxFiles: "errorMaxFiles", errorMaxFilesInProcess: "errorMaxFilesInProcess", errorMaxFileSize: "errorMaxFileSize" }, outputs: { filesdragenter: "filesdragenter", filesdropped: "filesdropped", beforecreatestatus: "beforecreatestatus", aftercreatestatus: "aftercreatestatus", fileprogress: "fileprogress", fileaborted: "fileaborted", filecompleteduploading: "filecompleteduploading", fileremoved: "fileremoved" }, host: { properties: { "class.fileupload-advanced": "this.isFileUploadAdvanced" } }, ngImport: i0, template: "<ng-content></ng-content>\n", changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoFileUploadAdvancedComponent, decorators: [{
            type: Component,
            args: [{ selector: 'soho-fileupload-advanced,div[soho-fileupload-advanced]', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-content></ng-content>\n" }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: i0.NgZone }]; }, propDecorators: { isFileUploadAdvanced: [{
                type: HostBinding,
                args: ['class.fileupload-advanced']
            }], disabled: [{
                type: Input
            }], isStandalone: [{
                type: Input
            }], allowedTypes: [{
                type: Input
            }], send: [{
                type: Input
            }], maxFiles: [{
                type: Input
            }], maxFilesInProcess: [{
                type: Input
            }], maxFileSize: [{
                type: Input
            }], fileName: [{
                type: Input
            }], showBrowseButton: [{
                type: Input
            }], textDropArea: [{
                type: Input
            }], textDropAreaWithBrowse: [{
                type: Input
            }], textBtnCancel: [{
                type: Input
            }], textBtnCloseError: [{
                type: Input
            }], textBtnRemove: [{
                type: Input
            }], errorMaxFiles: [{
                type: Input
            }], errorMaxFilesInProcess: [{
                type: Input
            }], errorMaxFileSize: [{
                type: Input
            }], filesdragenter: [{
                type: Output
            }], filesdropped: [{
                type: Output
            }], beforecreatestatus: [{
                type: Output
            }], aftercreatestatus: [{
                type: Output
            }], fileprogress: [{
                type: Output
            }], fileaborted: [{
                type: Output
            }], filecompleteduploading: [{
                type: Output
            }], fileremoved: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1maWxldXBsb2FkLWFkdmFuY2VkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvZmlsZXVwbG9hZC1hZHZhbmNlZC9zb2hvLWZpbGV1cGxvYWQtYWR2YW5jZWQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9maWxldXBsb2FkLWFkdmFuY2VkL3NvaG8tZmlsZXVwbG9hZC1hZHZhbmNlZC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxZQUFZLEVBQ1osS0FBSyxFQUNMLE1BQU0sRUFFTixXQUFXLEdBQ1osTUFBTSxlQUFlLENBQUM7O0FBUXZCLE1BQU0sT0FBTywrQkFBK0I7SUFrQjFDLDhDQUE4QztJQUM5QyxrQkFBa0I7SUFDbEIsOENBQThDO0lBRTlDOztPQUVHO0lBQ0gsSUFBYSxRQUFRLENBQUMsS0FBMEI7UUFDOUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDeEIsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxLQUFLLEVBQUU7Z0JBQ1QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7b0JBQ2pDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxPQUFPLEVBQUUsQ0FBQztnQkFDckMsQ0FBQyxDQUFDLENBQUM7Z0JBQ0gsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7YUFDeEI7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7b0JBQ2pDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxNQUFNLEVBQUUsQ0FBQztnQkFDcEMsQ0FBQyxDQUFDLENBQUM7Z0JBQ0gsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7YUFDekI7U0FDRjtJQUNILENBQUM7SUFFRCxJQUFJLFFBQVE7UUFDVixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxJQUFhLFlBQVksQ0FBQyxZQUFpQztRQUN6RCxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDekMsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1lBQzdELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRCxJQUFJLFlBQVk7UUFDZCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDO0lBQ25DLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxZQUFZLENBQUMsWUFBZ0M7UUFDeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1FBQ3pDLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztZQUM3RCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQztJQUNuQyxDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNILElBQWEsSUFBSSxDQUFDLE1BQWdEO1FBQ2hFLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQztRQUMzQixJQUFJLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUM7WUFDL0MsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3ZCO0lBQ0gsQ0FBQztJQUVELElBQUksSUFBSTtRQUNOLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxJQUFhLFFBQVEsQ0FBQyxRQUE0QjtRQUNoRCxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDakMsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1lBQ3JELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRCxJQUFJLFFBQVE7UUFDVixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDO0lBQy9CLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxpQkFBaUIsQ0FBQyxpQkFBcUM7UUFDbEUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQztRQUNuRCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDO1lBQ3ZFLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRCxJQUFJLGlCQUFpQjtRQUNuQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUM7SUFDeEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxJQUFhLFdBQVcsQ0FBQyxXQUErQjtRQUN0RCxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDdkMsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1lBQzNELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRCxJQUFJLFdBQVc7UUFDYixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO0lBQ2xDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxRQUFRLENBQUMsUUFBNEI7UUFDaEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ2pDLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztZQUNyRCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxRQUFRO1FBQ1YsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztJQUMvQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILElBQWEsZ0JBQWdCLENBQUMsZ0JBQXFDO1FBQ2pFLElBQUksQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7UUFDakQsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQztZQUNyRSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxnQkFBZ0I7UUFDbEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0lBQ3ZDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxZQUFZLENBQUMsWUFBZ0M7UUFDeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1FBQ3pDLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztZQUM3RCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQztJQUNuQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILElBQWEsc0JBQXNCLENBQUMsc0JBQTBDO1FBQzVFLElBQUksQ0FBQyxPQUFPLENBQUMsc0JBQXNCLEdBQUcsc0JBQXNCLENBQUM7UUFDN0QsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsR0FBRyxzQkFBc0IsQ0FBQztZQUNqRixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxzQkFBc0I7UUFDeEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0lBQzdDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxhQUFhLENBQUMsYUFBaUM7UUFDMUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1FBQzNDLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsYUFBYSxHQUFHLGFBQWEsQ0FBQztZQUMvRCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxhQUFhO1FBQ2YsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQztJQUNwQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILElBQWEsaUJBQWlCLENBQUMsaUJBQXFDO1FBQ2xFLElBQUksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLEdBQUcsaUJBQWlCLENBQUM7UUFDbkQsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsR0FBRyxpQkFBaUIsQ0FBQztZQUN2RSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxpQkFBaUI7UUFDbkIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDO0lBQ3hDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsSUFBYSxhQUFhLENBQUMsYUFBaUM7UUFDMUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1FBQzNDLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsYUFBYSxHQUFHLGFBQWEsQ0FBQztZQUMvRCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxhQUFhO1FBQ2YsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQztJQUNwQyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxJQUFhLGFBQWEsQ0FBQyxhQUFpQztRQUMxRCxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7UUFDM0MsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEUsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3ZCO0lBQ0gsQ0FBQztJQUVELElBQUksYUFBYTtRQUNmLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7SUFDcEMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsSUFBYSxzQkFBc0IsQ0FBQyxzQkFBMEM7UUFDNUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxzQkFBc0IsR0FBRyxzQkFBc0IsQ0FBQztRQUM3RCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNsRSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxzQkFBc0I7UUFDeEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0lBQzdDLENBQUM7SUFFRDs7T0FFRztJQUNILElBQWEsZ0JBQWdCLENBQUMsaUJBQXFDO1FBQ2pFLElBQUksQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLEdBQUcsaUJBQWlCLENBQUM7UUFDbEQsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsR0FBRyxpQkFBaUIsQ0FBQztZQUN0RSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7U0FDdkI7SUFDSCxDQUFDO0lBRUQsSUFBSSxnQkFBZ0I7UUFDbEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0lBQ3ZDLENBQUM7SUE4QkQsOENBQThDO0lBQzlDLGFBQWE7SUFDYiw4Q0FBOEM7SUFFOUM7Ozs7O09BS0c7SUFDSCxPQUFPLENBQUMsUUFBdUM7UUFDN0MsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7Z0JBQ2pDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUM7U0FDakQ7YUFBTTtZQUNMLElBQUksQ0FBQyxPQUFPLEdBQUcsUUFBUSxDQUFDO1NBQ3pCO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsT0FBTztRQUNMLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFO2dCQUNqQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFDckMsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO1NBQ2hDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFBb0IsT0FBbUIsRUFDN0IsR0FBc0IsRUFDdEIsTUFBYztRQUZKLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFDN0IsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFDdEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQTVYeEI7O1dBRUc7UUFDdUMseUJBQW9CLEdBQUcsSUFBSSxDQUFDO1FBdVR0RSw4Q0FBOEM7UUFDOUMsbUJBQW1CO1FBQ25CLDhDQUE4QztRQUM5Qzs7V0FFRztRQUNPLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFDM0QsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBQzFDLHVCQUFrQixHQUFHLElBQUksWUFBWSxFQUFVLENBQUM7UUFDaEQsc0JBQWlCLEdBQUcsSUFBSSxZQUFZLEVBQVUsQ0FBQztRQUMvQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFVLENBQUM7UUFDMUMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBQ3pDLDJCQUFzQixHQUFHLElBQUksWUFBWSxFQUFVLENBQUM7UUFDcEQsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBRW5ELDhDQUE4QztRQUM5QyxzQkFBc0I7UUFDdEIsOENBQThDO1FBRTlDLHVDQUF1QztRQUMvQixZQUFPLEdBQWtDLEVBQUUsQ0FBQztJQStDcEQsQ0FBQztJQUVELGVBQWU7UUFDYixJQUFJLENBQUMsYUFBYSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBRXhELElBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXBELElBQUksQ0FBQyxhQUFhO2FBQ2YsRUFBRSxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBd0IsRUFBRSxFQUFFO1lBQ2pELElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUIsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUM7YUFDRCxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsS0FBNEIsRUFBRSxLQUFhLEVBQUUsRUFBRTtZQUNqRSxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3ZELENBQUMsQ0FBQzthQUNELEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLEtBQTRCLEVBQUUsS0FBYSxFQUFFLEVBQUU7WUFDeEUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzdELENBQUMsQ0FBQzthQUNELEVBQUUsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLEtBQTRCLEVBQUUsS0FBYSxFQUFFLEVBQUU7WUFDdkUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQzthQUNELEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxLQUE0QixFQUFFLEtBQWEsRUFBRSxFQUFFO1lBQ2xFLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDO2FBQ0QsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDLEtBQTRCLEVBQUUsS0FBYSxFQUFFLEVBQUU7WUFDakUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUN0RCxDQUFDLENBQUM7YUFDRCxFQUFFLENBQUMsdUJBQXVCLEVBQUUsQ0FBQyxLQUE0QixFQUFFLEtBQWEsRUFBRSxFQUFFO1lBQzNFLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMxQyxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQzthQUNELEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxLQUE0QixFQUFFLEtBQWEsRUFBRSxFQUFFO1lBQ2pFLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVMLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQzFFLENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7Z0JBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUMzQixJQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO1lBQ2pDLENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQsV0FBVztRQUNULElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFO2dCQUNqQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFDckMsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO1NBQ2hDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsY0FBYztRQUNaLHlDQUF5QztRQUN6QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO1FBRTlCLHNFQUFzRTtRQUN0RSxxRUFBcUU7UUFDckUsWUFBWTtRQUNaLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDMUIsQ0FBQzs4R0FyY1UsK0JBQStCO2tHQUEvQiwrQkFBK0IsMmdDQ2xCNUMsNkJBQ0E7OzJGRGlCYSwrQkFBK0I7a0JBTjNDLFNBQVM7K0JBQ0Usd0RBQXdELG1CQUVqRCx1QkFBdUIsQ0FBQyxNQUFNO3NKQU9MLG9CQUFvQjtzQkFBN0QsV0FBVzt1QkFBQywyQkFBMkI7Z0JBcUIzQixRQUFRO3NCQUFwQixLQUFLO2dCQTBCTyxZQUFZO3NCQUF4QixLQUFLO2dCQWlCTyxZQUFZO3NCQUF4QixLQUFLO2dCQW9CTyxJQUFJO3NCQUFoQixLQUFLO2dCQWlCTyxRQUFRO3NCQUFwQixLQUFLO2dCQWlCTyxpQkFBaUI7c0JBQTdCLEtBQUs7Z0JBaUJPLFdBQVc7c0JBQXZCLEtBQUs7Z0JBaUJPLFFBQVE7c0JBQXBCLEtBQUs7Z0JBaUJPLGdCQUFnQjtzQkFBNUIsS0FBSztnQkFpQk8sWUFBWTtzQkFBeEIsS0FBSztnQkFpQk8sc0JBQXNCO3NCQUFsQyxLQUFLO2dCQWlCTyxhQUFhO3NCQUF6QixLQUFLO2dCQWlCTyxpQkFBaUI7c0JBQTdCLEtBQUs7Z0JBaUJPLGFBQWE7c0JBQXpCLEtBQUs7Z0JBZU8sYUFBYTtzQkFBekIsS0FBSztnQkFlTyxzQkFBc0I7c0JBQWxDLEtBQUs7Z0JBZU8sZ0JBQWdCO3NCQUE1QixLQUFLO2dCQWtCSSxjQUFjO3NCQUF2QixNQUFNO2dCQUNHLFlBQVk7c0JBQXJCLE1BQU07Z0JBQ0csa0JBQWtCO3NCQUEzQixNQUFNO2dCQUNHLGlCQUFpQjtzQkFBMUIsTUFBTTtnQkFDRyxZQUFZO3NCQUFyQixNQUFNO2dCQUNHLFdBQVc7c0JBQXBCLE1BQU07Z0JBQ0csc0JBQXNCO3NCQUEvQixNQUFNO2dCQUNHLFdBQVc7c0JBQXBCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIE9uRGVzdHJveSxcbiAgSG9zdEJpbmRpbmcsIEFmdGVyVmlld0NoZWNrZWQsIE5nWm9uZSwgQ2hhbmdlRGV0ZWN0b3JSZWYsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzb2hvLWZpbGV1cGxvYWQtYWR2YW5jZWQsZGl2W3NvaG8tZmlsZXVwbG9hZC1hZHZhbmNlZF0nLFxuICB0ZW1wbGF0ZVVybDogJ3NvaG8tZmlsZXVwbG9hZC1hZHZhbmNlZC5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcblxuZXhwb3J0IGNsYXNzIFNvaG9GaWxlVXBsb2FkQWR2YW5jZWRDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3kge1xuICAvKipcbiAgICogQWRkIGNsYXNzIHRvIGhvc3QgZWxlbWVudCB0byBlbnN1cmUgY29ycmVjdCBzdHlsaW5nIGFuZCBkZXRlY3Rpb24gYnkgRVAgY29udHJvbHMuXG4gICAqL1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZpbGV1cGxvYWQtYWR2YW5jZWQnKSBpc0ZpbGVVcGxvYWRBZHZhbmNlZCA9IHRydWU7XG5cbiAgLyoqXG4gICAqIExvY2FsIHZhcmlhYmxlc1xuICAgKi9cblxuICAvKipcbiAgICogRmxhZyB0byBmb3JjZSBhbiB1cGRhdGUgb2YgdGhlIGNvbnRyb2wgYWZ0ZXIgdGhlIHZpZXcgaXMgY3JlYXRlZC5cbiAgICovXG4gIHByaXZhdGUgcnVuVXBkYXRlZE9uQ2hlY2s/OiBib29sZWFuO1xuXG4gIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZW5hYmxlZCAvIGRpc2FibGVkIHN0YXRlLiAqL1xuICBwdWJsaWMgaXNEaXNhYmxlZD86IGJvb2xlYW47XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBDb21wb25lbnQgSW5wdXRcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBjb250cm9sLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5pc0Rpc2FibGVkID0gdmFsdWU7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkPy5kaXNhYmxlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmlzRGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkPy5lbmFibGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5pc0Rpc2FibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIE9uIHBhZ2UodHJ1ZSkgLW9yLSBvbiBtb2RhbCAoZmFsc2UpICwgdGhpcyBpcyB1c2VkIGZvciBzb21lIHZpc3VhbCBzdHlsZSBvbmx5LlxuICAgKlxuICAgKiBAcGFyYW0gaXNTdGFuZGFsb25lIHRydWUgZm9yIG9uUGFnZSBvdGhlcndpc2UgZmFsc2UuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgaXNTdGFuZGFsb25lKGlzU3RhbmRhbGluZTogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5pc1N0YW5kYWxvbmUgPSBpc1N0YW5kYWxpbmU7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy5pc1N0YW5kYWxvbmUgPSBpc1N0YW5kYWxpbmU7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGlzU3RhbmRhbG9uZSgpOiBib29sZWFuIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmlzU3RhbmRhbG9uZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0cmljdCBmaWxlIHR5cGVzKGllLiAnanBnfHBuZ3xnaWYnKSBbJyonIGFsbCB0eXBlc11cbiAgICpcbiAgICogQHBhcmFtIGFsbG93ZWRUeXBlcyAtIHRoZSBhbGxvd2VkIHR5cGVzLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGFsbG93ZWRUeXBlcyhhbGxvd2VkVHlwZXM6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5hbGxvd2VkVHlwZXMgPSBhbGxvd2VkVHlwZXM7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy5hbGxvd2VkVHlwZXMgPSBhbGxvd2VkVHlwZXM7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGFsbG93ZWRUeXBlcygpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYWxsb3dlZFR5cGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIERlZmluZXMgdGhlIHNlbmQgbWV0aG9kIHVzZWQgdG8gdXBsb2FkIHRoZSBmaWxlcy5cbiAgICpcbiAgICogVGhlIHNlbmQgZnVuY3Rpb24gdGFrZXMgdGhlIEZvcm1EYXRhIGNvbnRhaW5pbmcgdGhlIGZpbGUsIGFuZCBhXG4gICAqIHN0YXR1cyBpbnRlcmZhY2UgdG8gcHJvdmlkZSBmZWRiYWNrIHRvIHRoZSBjb250cm9sIHdoaWxzdCB1cGxvYWRpbmcuXG4gICAqXG4gICAqIEBwYXJhbSBzZW5kRm4gLSB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gcmVzcG9uc2libGUgdG8gdXBsb2FkaW5nIHRoZSBmaWxlLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IHNlbmQoc2VuZEZuOiBTb2hvRmlsZVVwbG9hZEFkdmFuY2VkU2VuZEZ1bmN0aW9uIHwgYW55KSB7XG4gICAgdGhpcy5vcHRpb25zLnNlbmQgPSBzZW5kRm47XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy5zZW5kID0gc2VuZEZuO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzZW5kKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5zZW5kO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc3RyaWN0cyB0aGUgbnVtYmVyIG9mIGZpbGVzIHRoYXQgY2FuIGJlIHJldHJpZXZlZCBpbiB0b3RhbC5cbiAgICpcbiAgICogQHBhcmFtIG1heEZpbGVzIC0gbWF4IGZpbGVzIGNhYiBiZSB1cGxvYWQuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgbWF4RmlsZXMobWF4RmlsZXM6IG51bWJlciB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5tYXhGaWxlcyA9IG1heEZpbGVzO1xuICAgIGlmICh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCkge1xuICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQuc2V0dGluZ3MubWF4RmlsZXMgPSBtYXhGaWxlcztcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBnZXQgbWF4RmlsZXMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLm1heEZpbGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc3RyaWN0cyB0aGUgbnVtYmVyIG9mIGZpbGVzIHRoYXQgY2FuIGJlIHJldHJpZXZlZCB3aGlsZSBpbiBwcm9jZXNzLlxuICAgKlxuICAgKiBAcGFyYW0gbWF4RmlsZXNJblByb2Nlc3MgLSB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gcmVzcG9uc2libGUgdG8gdXBsb2FkaW5nIHRoZSBmaWxlLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IG1heEZpbGVzSW5Qcm9jZXNzKG1heEZpbGVzSW5Qcm9jZXNzOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMubWF4RmlsZXNJblByb2Nlc3MgPSBtYXhGaWxlc0luUHJvY2VzcztcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnNldHRpbmdzLm1heEZpbGVzSW5Qcm9jZXNzID0gbWF4RmlsZXNJblByb2Nlc3M7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG1heEZpbGVzSW5Qcm9jZXNzKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5tYXhGaWxlc0luUHJvY2VzcztcbiAgfVxuXG4gIC8qKlxuICAgKiBNYXggZmlsZSBzaXplIGluIGJ5dGVzLCAtMSBmb3IgdW5saW1pdGVkLlxuICAgKlxuICAgKiBAcGFyYW0gbWF4RmlsZVNpemUgLSBNYXggZmlsZSBzaXplIGluIGJ5dGVzLCAtMSBmb3IgdW5saW1pdGVkLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IG1heEZpbGVTaXplKG1heEZpbGVTaXplOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMubWF4RmlsZVNpemUgPSBtYXhGaWxlU2l6ZTtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnNldHRpbmdzLm1heEZpbGVTaXplID0gbWF4RmlsZVNpemU7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG1heEZpbGVTaXplKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5tYXhGaWxlU2l6ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYXJpYWJsZSBuYW1lIHRvIHJlYWQgZnJvbSBzZXJ2ZXIuXG4gICAqXG4gICAqIEBwYXJhbSBmaWxlTmFtZSAtIFZhcmlhYmxlIG5hbWUgdG8gcmVhZCBmcm9tIHNlcnZlci4uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgZmlsZU5hbWUoZmlsZU5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5maWxlTmFtZSA9IGZpbGVOYW1lO1xuICAgIGlmICh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCkge1xuICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQuc2V0dGluZ3MuZmlsZU5hbWUgPSBmaWxlTmFtZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBnZXQgZmlsZU5hbWUoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmZpbGVOYW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCB3YXkgdG8gYnJvd3NlIGZpbGVzIHRvIHVwbG9hZFxuICAgKlxuICAgKiBAcGFyYW0gc2hvd0Jyb3dzZUJ1dHRvbiAtIGlmIHRydWUsIGRpc3BsYXlzIHRoZSBicm93c2UgYnV0dG9uOyBvdGhlcndpc2UgZG8gbm90LlxuICAgKi9cbiAgQElucHV0KCkgc2V0IHNob3dCcm93c2VCdXR0b24oc2hvd0Jyb3dzZUJ1dHRvbjogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5zaG93QnJvd3NlQnV0dG9uID0gc2hvd0Jyb3dzZUJ1dHRvbjtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnNldHRpbmdzLnNob3dCcm93c2VCdXR0b24gPSBzaG93QnJvd3NlQnV0dG9uO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzaG93QnJvd3NlQnV0dG9uKCk6IGJvb2xlYW4gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuc2hvd0Jyb3dzZUJ1dHRvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUZXh0IHRvIHNob3cgaW4gZHJvcCBhcmVhLlxuICAgKlxuICAgKiBAcGFyYW0gdGV4dERyb3BBcmVhIC0gVGV4dCB0byBzaG93IGluIGRyb3AgYXJlYS5cbiAgICovXG4gIEBJbnB1dCgpIHNldCB0ZXh0RHJvcEFyZWEodGV4dERyb3BBcmVhOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMudGV4dERyb3BBcmVhID0gdGV4dERyb3BBcmVhO1xuICAgIGlmICh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCkge1xuICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQuc2V0dGluZ3MudGV4dERyb3BBcmVhID0gdGV4dERyb3BBcmVhO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCB0ZXh0RHJvcEFyZWEoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLnRleHREcm9wQXJlYTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUZXh0IHRvIHNob3cgaW4gZHJvcCBhcmVhIHdoZW4gYnJvd3NlIG9wdGlvbiB0cnVlLlxuICAgKlxuICAgKiBAcGFyYW0gdGV4dERyb3BBcmVhV2l0aEJyb3dzZSAtIFRleHQgdG8gc2hvdyBpbiBkcm9wIGFyZWEgd2hlbiBicm93c2Ugb3B0aW9uIHRydWUuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgdGV4dERyb3BBcmVhV2l0aEJyb3dzZSh0ZXh0RHJvcEFyZWFXaXRoQnJvd3NlOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMudGV4dERyb3BBcmVhV2l0aEJyb3dzZSA9IHRleHREcm9wQXJlYVdpdGhCcm93c2U7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy50ZXh0RHJvcEFyZWFXaXRoQnJvd3NlID0gdGV4dERyb3BBcmVhV2l0aEJyb3dzZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBnZXQgdGV4dERyb3BBcmVhV2l0aEJyb3dzZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMudGV4dERyb3BBcmVhV2l0aEJyb3dzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRkZW4gdGV4dCBmb3IgY2FuY2VsIGJ1dHRvbi5cbiAgICpcbiAgICogQHBhcmFtIHRleHRCdG5DYW5jZWwgLSBIaWRkZW4gdGV4dCBmb3IgY2FuY2VsIGJ1dHRvbi5cbiAgICovXG4gIEBJbnB1dCgpIHNldCB0ZXh0QnRuQ2FuY2VsKHRleHRCdG5DYW5jZWw6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy50ZXh0QnRuQ2FuY2VsID0gdGV4dEJ0bkNhbmNlbDtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnNldHRpbmdzLnRleHRCdG5DYW5jZWwgPSB0ZXh0QnRuQ2FuY2VsO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCB0ZXh0QnRuQ2FuY2VsKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy50ZXh0QnRuQ2FuY2VsO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZGRlbiB0ZXh0IGZvciBlcnJvciBjbG9zZSBidXR0b25cbiAgICpcbiAgICogQHBhcmFtIHRleHRCdG5DbG9zZUVycm9yIC0gSGlkZGVuIHRleHQgZm9yIGVycm9yIGNsb3NlIGJ1dHRvbi5cbiAgICovXG4gIEBJbnB1dCgpIHNldCB0ZXh0QnRuQ2xvc2VFcnJvcih0ZXh0QnRuQ2xvc2VFcnJvcjogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5vcHRpb25zLnRleHRCdG5DbG9zZUVycm9yID0gdGV4dEJ0bkNsb3NlRXJyb3I7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy50ZXh0QnRuQ2xvc2VFcnJvciA9IHRleHRCdG5DbG9zZUVycm9yO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCB0ZXh0QnRuQ2xvc2VFcnJvcigpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMudGV4dEJ0bkNsb3NlRXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogSGlkZGVuIHRleHQgZm9yIHJlbW92ZSBidXR0b24uXG4gICAqXG4gICAqIEBwYXJhbSB0ZXh0QnRuUmVtb3ZlIC0gSGlkZGVuIHRleHQgZm9yIHJlbW92ZSBidXR0b24uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgdGV4dEJ0blJlbW92ZSh0ZXh0QnRuUmVtb3ZlOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLm9wdGlvbnMudGV4dEJ0blJlbW92ZSA9IHRleHRCdG5SZW1vdmU7XG4gICAgaWYgKHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkKSB7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncy50ZXh0QnRuUmVtb3ZlID0gdGV4dEJ0blJlbW92ZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBnZXQgdGV4dEJ0blJlbW92ZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMudGV4dEJ0blJlbW92ZTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGVycm9yTWF4RmlsZXMoZXJyb3JNYXhGaWxlczogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5vcHRpb25zLmVycm9yTWF4RmlsZXMgPSBlcnJvck1heEZpbGVzO1xuICAgIGlmICh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCkge1xuICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQudXBkYXRlZCh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncyk7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVycm9yTWF4RmlsZXMoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmVycm9yTWF4RmlsZXM7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICovXG4gIEBJbnB1dCgpIHNldCBlcnJvck1heEZpbGVzSW5Qcm9jZXNzKGVycm9yTWF4RmlsZXNJblByb2Nlc3M6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMub3B0aW9ucy5lcnJvck1heEZpbGVzSW5Qcm9jZXNzID0gZXJyb3JNYXhGaWxlc0luUHJvY2VzcztcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnVwZGF0ZWQodGhpcy5maWxldXBsb2FkYWR2YW5jZWQuc2V0dGluZ3MpO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBlcnJvck1heEZpbGVzSW5Qcm9jZXNzKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5lcnJvck1heEZpbGVzSW5Qcm9jZXNzO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqL1xuICBASW5wdXQoKSBzZXQgZXJyb3JNYXhGaWxlU2l6ZShlcnJvck1heEZpbGVzU2l6ZTogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5vcHRpb25zLmVycm9yTWF4RmlsZVNpemUgPSBlcnJvck1heEZpbGVzU2l6ZTtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMuZmlsZXVwbG9hZGFkdmFuY2VkLnNldHRpbmdzLmVycm9yTWF4RmlsZVNpemUgPSBlcnJvck1heEZpbGVzU2l6ZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICBnZXQgZXJyb3JNYXhGaWxlU2l6ZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuZXJyb3JNYXhGaWxlU2l6ZTtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gQ29tcG9uZW50IE91dHB1dFxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgZmlsZXVwbG9hZCB2YWx1ZSBjaGFuZ2VzXG4gICAqL1xuICBAT3V0cHV0KCkgZmlsZXNkcmFnZW50ZXIgPSBuZXcgRXZlbnRFbWl0dGVyPEpRdWVyeS5UcmlnZ2VyZWRFdmVudD4oKTtcbiAgQE91dHB1dCgpIGZpbGVzZHJvcHBlZCA9IG5ldyBFdmVudEVtaXR0ZXI8RmlsZVtdPigpO1xuICBAT3V0cHV0KCkgYmVmb3JlY3JlYXRlc3RhdHVzID0gbmV3IEV2ZW50RW1pdHRlcjxGaWxlW10+KCk7XG4gIEBPdXRwdXQoKSBhZnRlcmNyZWF0ZXN0YXR1cyA9IG5ldyBFdmVudEVtaXR0ZXI8RmlsZVtdPigpO1xuICBAT3V0cHV0KCkgZmlsZXByb2dyZXNzID0gbmV3IEV2ZW50RW1pdHRlcjxGaWxlW10+KCk7XG4gIEBPdXRwdXQoKSBmaWxlYWJvcnRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8RmlsZVtdPigpO1xuICBAT3V0cHV0KCkgZmlsZWNvbXBsZXRlZHVwbG9hZGluZyA9IG5ldyBFdmVudEVtaXR0ZXI8RmlsZVtdPigpO1xuICBAT3V0cHV0KCkgZmlsZXJlbW92ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEZpbGVbXT4oKTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIFByaXZhdGUgTWVtYmVyIERhdGFcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8qKiBTZXQgb2Ygb3B0aW9ucyBmb3IgdGhpcyBjb250cm9sLiAqL1xuICBwcml2YXRlIG9wdGlvbnM6IFNvaG9GaWxlVXBsb2FkQWR2YW5jZWRPcHRpb25zID0ge307XG5cbiAgLy8gUmVmZXJlbmNlIHRvIHRoZSBqUXVlcnkgY29udHJvbC5cbiAgcHJpdmF0ZSBqUXVlcnlFbGVtZW50PzogSlF1ZXJ5O1xuXG4gIC8vIFJlZmVyZW5jZSB0byB0aGUgU29Ib1hpIGNvbnRyb2wgYXBpLlxuICBwcml2YXRlIGZpbGV1cGxvYWRhZHZhbmNlZD86IFNvaG9GaWxlVXBsb2FkQWR2YW5jZWRTdGF0aWMgfCBudWxsO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gUHVibGljIEFQSVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRyb2wgYnkgbWVyZ2luZyB0aGUgZ2l2ZW4gc2V0dGluZ3MgaW50b1xuICAgKiB0aGUgRVAgd2lkZ2V0LlxuICAgKlxuICAgKiBAcGFyYW0gc2V0dGluZ3MgdGhlIHNldHRpbmdzIHRvIG1lcmdlLlxuICAgKi9cbiAgdXBkYXRlZChzZXR0aW5nczogU29ob0ZpbGVVcGxvYWRBZHZhbmNlZE9wdGlvbnMpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQ/LnVwZGF0ZWQoc2V0dGluZ3MpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZC5zZXR0aW5ncztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcHRpb25zID0gc2V0dGluZ3M7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3lzIHRoZSBjb250cm9sLlxuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBpZiAodGhpcy5maWxldXBsb2FkYWR2YW5jZWQpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQ/LmRlc3Ryb3koKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb25zdHJ1Y3Rvci5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIHJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSkge1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cbiAgICB0aGlzLmpRdWVyeUVsZW1lbnQuZmlsZXVwbG9hZGFkdmFuY2VkKHRoaXMub3B0aW9ucyk7XG5cbiAgICB0aGlzLmpRdWVyeUVsZW1lbnRcbiAgICAgIC5vbignZmlsZXNkcmFnZW50ZXInLCAoZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5maWxlc2RyYWdlbnRlci5uZXh0KGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAub24oJ2ZpbGVzZHJvcGVkJywgKF9hcmdzOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGZpbGVzOiBGaWxlW10pID0+IHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMuZmlsZXNkcm9wcGVkLm5leHQoZmlsZXMpKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2JlZm9yZWNyZWF0ZXN0YXR1cycsIChfYXJnczogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmJlZm9yZWNyZWF0ZXN0YXR1cy5uZXh0KGZpbGVzKSk7XG4gICAgICB9KVxuICAgICAgLm9uKCdhZnRlcmNyZWF0ZXN0YXR1cycsIChfYXJnczogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmFmdGVyY3JlYXRlc3RhdHVzLm5leHQoZmlsZXMpKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2ZpbGVwcm9ncmVzcycsIChfYXJnczogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmZpbGVwcm9ncmVzcy5uZXh0KGZpbGVzKSk7XG4gICAgICB9KVxuICAgICAgLm9uKCdmaWxlYWJvcnRlZCcsIChfYXJnczogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmZpbGVhYm9ydGVkLm5leHQoZmlsZXMpKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2ZpbGVjb21wbGV0ZXVwbG9hZGluZycsIChfYXJnczogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5maWxlY29tcGxldGVkdXBsb2FkaW5nLm5leHQoZmlsZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAub24oJ2ZpbGVyZW1vdmVkJywgKF9hcmdzOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGZpbGVzOiBGaWxlW10pID0+IHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmZpbGVyZW1vdmVkLm5leHQoZmlsZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5maWxldXBsb2FkYWR2YW5jZWQgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnZmlsZXVwbG9hZGFkdmFuY2VkJyk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XG4gICAgaWYgKHRoaXMucnVuVXBkYXRlZE9uQ2hlY2spIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVkKHRoaXMub3B0aW9ucyk7XG4gICAgICAgIHRoaXMucnVuVXBkYXRlZE9uQ2hlY2sgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCkge1xuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZD8uZGVzdHJveSgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmZpbGV1cGxvYWRhZHZhbmNlZCA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1hcmtzIHRoZSBjb21wb25lbnRzIGFzIHJlcXVpcmluZyBhIHJlYnVpbGQgYWZ0ZXIgdGhlIG5leHQgdXBkYXRlLlxuICAgKi9cbiAgbWFya0ZvclJlZnJlc2goKSB7XG4gICAgLy8gUnVuIHVwZGF0ZWQgb24gdGhlIG5leHQgdXBkYXRlZCBjaGVjay5cbiAgICB0aGlzLnJ1blVwZGF0ZWRPbkNoZWNrID0gdHJ1ZTtcblxuICAgIC8vIC4uLiBtYWtlIHN1cmUgdGhlIGNoYW5nZSBkZXRlY3RvciBraWNrcyBpbiwgb3RoZXJ3aXNlIGlmIHRoZSBpbnB1dHNcbiAgICAvLyB3ZXJlIGNoYW5nZSBwcm9ncmFtbWF0aWNhbGx5IHRoZSBjb21wb25lbnQgbWF5IG5vdCBiZSBlbGlnaWJsZSBmb3JcbiAgICAvLyB1cGRhdGluZy5cbiAgICB0aGlzLnJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgfVxufVxuIiwiPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuIl19