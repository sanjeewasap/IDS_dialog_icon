import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Optional, Output, ContentChild } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "./soho-swaplist.service";
import * as i3 from "../button/soho-button.component";
/**************************************************************
 * SWAP LIST CARD
 **************************************************************/
export class SohoSwapListCardComponent {
    get isSwapList() {
        return true;
    }
    set type(value) {
        this.cardtype = value;
    }
    set showSearchable(value) {
        this.showsearchable = value;
    }
    get showSearchable() {
        return this.showsearchable;
    }
    set searchTitle(value) {
        this.searchtitle = value;
    }
    get searchTitle() {
        return this.searchtitle;
    }
    /**
     * Return the class to use for the card.
     */
    get cardClass() {
        return `card${this.cardtype ? ` ${this.cardtype}` : ''}`;
    }
    /**
     * Return the card type to use for the card.
     */
    get cardType() {
        return this.cardtype || '';
    }
    /**
     * Title of the card, e.g. 'Available'.
     */
    set title(value) {
        this.cardtitle = value;
    }
    get title() {
        return this.cardtitle;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoSwapListCardComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoSwapListCardComponent, selector: "soho-swaplist-card", inputs: { type: "type", showSearchable: "showSearchable", searchTitle: "searchTitle", title: "title" }, host: { properties: { "class.swaplist": "this.isSwapList" } }, ngImport: i0, template: `
      <div [class]="cardClass">
        <div class="card-header">
          <h2 class="card-title">{{title}}</h2>
          <div class="buttons">
            <ng-content></ng-content>
          </div>
        </div>
        <div class="card-content">
          <div class="listview-search" *ngIf="showSearchable">
            <label class="audible" for="searchfield-{{cardType}}">{{searchTitle}}</label>
            <input class="searchfield" placeholder="{{searchTitle}}" name="searchfield-{{cardType}}"
             id="searchfield-{{cardType}}" data-init="false">
          </div>
          <div class="listview"></div>
        </div>
      </div>`, isInline: true, dependencies: [{ kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoSwapListCardComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'soho-swaplist-card',
                    template: `
      <div [class]="cardClass">
        <div class="card-header">
          <h2 class="card-title">{{title}}</h2>
          <div class="buttons">
            <ng-content></ng-content>
          </div>
        </div>
        <div class="card-content">
          <div class="listview-search" *ngIf="showSearchable">
            <label class="audible" for="searchfield-{{cardType}}">{{searchTitle}}</label>
            <input class="searchfield" placeholder="{{searchTitle}}" name="searchfield-{{cardType}}"
             id="searchfield-{{cardType}}" data-init="false">
          </div>
          <div class="listview"></div>
        </div>
      </div>`,
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], propDecorators: { isSwapList: [{
                type: HostBinding,
                args: ['class.swaplist']
            }], type: [{
                type: Input
            }], showSearchable: [{
                type: Input
            }], searchTitle: [{
                type: Input
            }], title: [{
                type: Input
            }] } });
/**************************************************************
 * SWAP LIST
 **************************************************************/
export class SohoSwapListComponent {
    /** Used to provide unnamed controls with a unique id. */
    static { this.counter = 0; }
    /**
     * Assign the id for the control
     * (maps to the name to use on a label's 'for' attribute)
     */
    get id() {
        return this.name;
    }
    /** Adds the 'swaplist' class required by the SoHoXi control. */
    get isSwapList() {
        return true;
    }
    /** Adds the 'one-third' class required when full access is set. */
    get isOneThird() {
        return this.showFullAccessCard;
    }
    /**
     * Set searchable option for SohoSwapList.
     *
     * @param value option.
     */
    set searchable(value) {
        this._options.searchable = value;
    }
    get searchable() {
        return this._options.searchable;
    }
    /** Add extra attributes like id's to the component **/
    set attributes(value) {
        this._options.attributes = value;
    }
    get attributes() {
        return this._options.attributes;
    }
    /**
     * Set available card items.
     * @param value item data.
     */
    set availableItems(value) {
        this._options.available = value;
        if (this.swaplist) {
            this.swaplist.settings.available = value;
            this.swaplist.updated();
        }
    }
    get availableItems() {
        return this.ConvertToModel(this.swaplist.getAvailable());
    }
    /** Disable dragging (all true by default) **/
    set draggable(value) {
        this._options.draggable = value;
        if (this.swaplist) {
            this.swaplist.settings.draggable = value;
            this.swaplist.updated();
        }
    }
    get draggable() {
        return this.draggable;
    }
    /** Keep items in the section when moving (all false by default) **/
    set keepInList(value) {
        this._options.keepInList = value;
        if (this.swaplist) {
            this.swaplist.settings.keepInList = value;
            this.swaplist.updated();
        }
    }
    get keepInList() {
        return this.keepInList;
    }
    /**
     * Set selected card items.
     *
     * @param value item data.
     */
    set selectedItems(value) {
        this._options.selected = value;
        if (this.swaplist) {
            this.swaplist.settings.selected = value;
            this.swaplist.updated();
        }
    }
    /**
     * Return the dataset currently selected card items.
     *
     * @return an array of SohoSwapListItem.
     */
    get selectedItems() {
        return this.ConvertToModel(this.swaplist.getSelected());
    }
    /**
     * Set additional card items.
     *
     * @param value item data.
     */
    set additionalItems(value) {
        this._options.additional = value;
        if (this.swaplist) {
            this.swaplist.settings.additional = value;
            this.swaplist.updated();
        }
    }
    /**
     * Return the dataset currently additional card items.
     *
     * @return an array of SohoSwapListItem.
     */
    get additionalItems() {
        return this.ConvertToModel(this.swaplist.getAdditional());
    }
    /**
     * Set flag to display third card full access card or not.
     *
     * @param value the value to show full access card.
     */
    set showFullAccessCard(value) {
        this._showFullAccessCard = value === null || value === 'true';
    }
    /**
     * Return the value whether full access card displayed.
     *
     * @return boolean value.
     */
    get showFullAccessCard() {
        return this._showFullAccessCard;
    }
    // ------------------------------------------------------------------------
    // Constructor
    // ------------------------------------------------------------------------
    constructor(element, ngZone, swaplistService) {
        this.element = element;
        this.ngZone = ngZone;
        this.swaplistService = swaplistService;
        /** Block of options, use the accessors to modify. */
        this._options = {};
        /** Flag controlling the display of the full access (additional) items. */
        this._showFullAccessCard = false;
        /** The component used to represent the available items. */
        this._availableCard = undefined;
        /** The component used to represent the selected items. */
        this._selectedCard = undefined;
        /** The component used to represent the full access (additional) items. */
        this._additionalCard = undefined;
        // ------------------------------------------------------------------------
        // @Inputs
        // ------------------------------------------------------------------------
        /** Name for the swaplist control. Necessary for ngModel to function. */
        this.name = `soho-swaplist-${SohoSwapListComponent.counter++}`;
        /** Default title for available items card. */
        this.availableCardTitle = Soho.Locale.translate('Available');
        /** Default title for selected items card. */
        this.selectedCardTitle = Soho.Locale.translate('Selected');
        /** Default title for additional items card. */
        this.fullAccessCardTitle = Soho.Locale.translate('AdditionalItems');
        /** Default search title for available items card. */
        this.availableCardSearchTitle = Soho.Locale.translate('SearchAvailable');
        /** Default search title for selected items card. */
        this.selectedCardSearchTitle = Soho.Locale.translate('SearchSelected');
        /** Default search title for additional items card. */
        this.fullAccessCardSearchTitle = Soho.Locale.translate('SearchAdditionalItems');
        /** Default button text for select. */
        this.btnMoveToSelect = Soho.Locale.translate('Select');
        /** Default button text for move to left. */
        this.btnMoveToLeft = Soho.Locale.translate('MoveToLeft');
        /** Default button text for  move to right. */
        this.btnMoveToRight = Soho.Locale.translate('MoveToRight');
        /**
         * Called before swap item/s.
         */
        // eslint-disable-next-line @angular-eslint/no-output-rename
        this.beforeSwapEvent = new EventEmitter();
        /**
         * Called when the swap list updates in some way.
         */
        // eslint-disable-next-line @angular-eslint/no-output-rename
        this.updateEvent = new EventEmitter();
    }
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            this.jQueryElement = jQuery(this.element.nativeElement);
            this.jQueryElement.find('.searchfield').searchfield({ clearable: true });
            this.jQueryElement.swaplist(this._options);
            this.jQueryElement
                .on('beforeswap', (event, moved) => this.onBeforeSwap(event, moved))
                .on('swapupdate', (event, moved) => this.onSwapUpdate(event, moved));
            this.swaplist = this.jQueryElement.data('swaplist');
            if (this.swaplistService) {
                this.swaplistService.getData().subscribe((d) => {
                    this.updateDataset(d);
                });
            }
        });
    }
    /**
     * Destroys any resources created by the control.
     */
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.swaplist) {
                this.swaplist.destroy();
                this.swaplist = null;
                this.jQueryElement?.off();
            }
        });
    }
    /**
     * In case the list data is being bound asynchronously or modified on the fly,
     * you will need to trigger updated on so it updates the list(s).
     */
    updated() {
        if (this.swaplist) {
            this.ngZone.runOutsideAngular(() => this.swaplist?.updated());
        }
    }
    /**
     * Updates the dataset used by the swaplist, dynamically refesing the
     * control's view.
     *
     * @param dataset the dataset to assign.
     */
    updateDataset(dataset) {
        this._options.available = dataset.available;
        this._options.selected = dataset.selected;
        this._options.additional = dataset.additional;
        if (this.swaplist) {
            this.swaplist.updateDataset(this._options);
        }
    }
    /**
     * Converts the list of items into a list of swaplist items.
     *
     * @param items data to convert to item model.
     *
     * @todo remove any
     */
    ConvertToModel(items) {
        const results = [];
        for (const item of items) {
            results.push({ id: item.id, value: item.value, text: item.text });
        }
        return results;
    }
    onBeforeSwap(event, moved) {
        event.moved = moved;
        this.beforeSwapEvent.emit(event);
    }
    onSwapUpdate(event, moved) {
        event.moved = moved;
        this.updateEvent.emit(event);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoSwapListComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }, { token: i2.SohoSwapListService, optional: true }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoSwapListComponent, selector: "soho-swaplist", inputs: { name: "name", availableCardTitle: "availableCardTitle", selectedCardTitle: "selectedCardTitle", fullAccessCardTitle: "fullAccessCardTitle", availableCardSearchTitle: "availableCardSearchTitle", selectedCardSearchTitle: "selectedCardSearchTitle", fullAccessCardSearchTitle: "fullAccessCardSearchTitle", btnMoveToSelect: "btnMoveToSelect", btnMoveToLeft: "btnMoveToLeft", btnMoveToRight: "btnMoveToRight", searchable: "searchable", attributes: "attributes", availableItems: "availableItems", draggable: "draggable", keepInList: "keepInList", selectedItems: "selectedItems", additionalItems: "additionalItems", showFullAccessCard: "showFullAccessCard" }, outputs: { beforeSwapEvent: "beforeswap", updateEvent: "updated" }, host: { properties: { "id": "this.id", "class.swaplist": "this.isSwapList", "class.one-third": "this.isOneThird" } }, queries: [{ propertyName: "_availableCard", first: true, predicate: ["available"], descendants: true, static: true }, { propertyName: "_selectedCard", first: true, predicate: ["selected"], descendants: true, static: true }, { propertyName: "_additionalCard", first: true, predicate: ["additional"], descendants: true, static: true }], ngImport: i0, template: "<div>\n  <soho-swaplist-card type=\"available\" title=\"{{availableCardTitle}}\" searchTitle=\"{{availableCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n    <button soho-button=\"btn\" icon=\"right-arrow\" moveToSelected=\"true\" title=\"{{btnMoveToSelect}}\"></button>\n  </soho-swaplist-card>\n  <soho-swaplist-card type=\"selected\" title=\"{{selectedCardTitle}}\" searchTitle=\"{{selectedCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n    <button soho-button=\"btn\" icon=\"left-arrow\" moveToLeft=\"true\" title=\"{{btnMoveToLeft}}\"></button>\n    <button *ngIf=\"showFullAccessCard\" soho-button=\"btn\" icon=\"right-arrow\" moveToRight=\"true\" title=\"{{btnMoveToRight}}\">\n    </button>\n  </soho-swaplist-card>\n  <soho-swaplist-card *ngIf=\"showFullAccessCard\" type=\"full-access\" title=\"{{fullAccessCardTitle}}\" searchTitle=\"{{fullAccessCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n     <button soho-button=\"btn\" icon=\"left-arrow\" moveToSelected=\"true\" title=\"{{btnMoveToLeft}}\"></button>\n  </soho-swaplist-card>\n</div>\n", dependencies: [{ kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i3.SohoButtonComponent, selector: "button[soho-button]", inputs: ["soho-button", "buttonOptions", "toggleOnIcon", "toggleOffIcon", "replaceText", "hideMenuArrow", "hitbox", "notificationBadge", "notificationBadgeOptions", "extraIconClass", "isToggle", "isTogglePressed", "icon", "iconAlign", "isSubmit", "ripple", "state", "toggle", "expandableExpander", "moveToLeft", "moveToRight", "moveToSelected"] }, { kind: "component", type: SohoSwapListCardComponent, selector: "soho-swaplist-card", inputs: ["type", "showSearchable", "searchTitle", "title"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoSwapListComponent, decorators: [{
            type: Component,
            args: [{ selector: 'soho-swaplist', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div>\n  <soho-swaplist-card type=\"available\" title=\"{{availableCardTitle}}\" searchTitle=\"{{availableCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n    <button soho-button=\"btn\" icon=\"right-arrow\" moveToSelected=\"true\" title=\"{{btnMoveToSelect}}\"></button>\n  </soho-swaplist-card>\n  <soho-swaplist-card type=\"selected\" title=\"{{selectedCardTitle}}\" searchTitle=\"{{selectedCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n    <button soho-button=\"btn\" icon=\"left-arrow\" moveToLeft=\"true\" title=\"{{btnMoveToLeft}}\"></button>\n    <button *ngIf=\"showFullAccessCard\" soho-button=\"btn\" icon=\"right-arrow\" moveToRight=\"true\" title=\"{{btnMoveToRight}}\">\n    </button>\n  </soho-swaplist-card>\n  <soho-swaplist-card *ngIf=\"showFullAccessCard\" type=\"full-access\" title=\"{{fullAccessCardTitle}}\" searchTitle=\"{{fullAccessCardSearchTitle}}\" showSearchable=\"{{searchable}}\">\n     <button soho-button=\"btn\" icon=\"left-arrow\" moveToSelected=\"true\" title=\"{{btnMoveToLeft}}\"></button>\n  </soho-swaplist-card>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }, { type: i2.SohoSwapListService, decorators: [{
                    type: Optional
                }] }]; }, propDecorators: { id: [{
                type: HostBinding,
                args: ['id']
            }], isSwapList: [{
                type: HostBinding,
                args: ['class.swaplist']
            }], isOneThird: [{
                type: HostBinding,
                args: ['class.one-third']
            }], _availableCard: [{
                type: ContentChild,
                args: ['available', { static: true }]
            }], _selectedCard: [{
                type: ContentChild,
                args: ['selected', { static: true }]
            }], _additionalCard: [{
                type: ContentChild,
                args: ['additional', { static: true }]
            }], name: [{
                type: Input
            }], availableCardTitle: [{
                type: Input
            }], selectedCardTitle: [{
                type: Input
            }], fullAccessCardTitle: [{
                type: Input
            }], availableCardSearchTitle: [{
                type: Input
            }], selectedCardSearchTitle: [{
                type: Input
            }], fullAccessCardSearchTitle: [{
                type: Input
            }], btnMoveToSelect: [{
                type: Input
            }], btnMoveToLeft: [{
                type: Input
            }], btnMoveToRight: [{
                type: Input
            }], searchable: [{
                type: Input
            }], attributes: [{
                type: Input
            }], availableItems: [{
                type: Input
            }], draggable: [{
                type: Input
            }], keepInList: [{
                type: Input
            }], selectedItems: [{
                type: Input
            }], additionalItems: [{
                type: Input
            }], showFullAccessCard: [{
                type: Input
            }], beforeSwapEvent: [{
                type: Output,
                args: ['beforeswap']
            }], updateEvent: [{
                type: Output,
                args: ['updated']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1zd2FwbGlzdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZHMtZW50ZXJwcmlzZS1uZy9zcmMvbGliL3N3YXBsaXN0L3NvaG8tc3dhcGxpc3QuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9zd2FwbGlzdC9zb2hvLXN3YXBsaXN0Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLHVCQUF1QixFQUN2QixTQUFTLEVBRVQsWUFBWSxFQUNaLFdBQVcsRUFDWCxLQUFLLEVBR0wsUUFBUSxFQUNSLE1BQU0sRUFDTixZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7Ozs7O0FBTXZCOztnRUFFZ0U7QUFzQmhFLE1BQU0sT0FBTyx5QkFBeUI7SUFDcEMsSUFBbUMsVUFBVTtRQUMzQyxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFjRCxJQUNXLElBQUksQ0FBQyxLQUEyQjtRQUN6QyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztJQUN4QixDQUFDO0lBRUQsSUFDVyxjQUFjLENBQUMsS0FBMEI7UUFDbEQsSUFBSSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7SUFDOUIsQ0FBQztJQUNELElBQVcsY0FBYztRQUN2QixPQUFPLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDN0IsQ0FBQztJQUVELElBQ1csV0FBVyxDQUFDLEtBQXlCO1FBQzlDLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0lBQzNCLENBQUM7SUFFRCxJQUFXLFdBQVc7UUFDcEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzFCLENBQUM7SUFFRDs7T0FFRztJQUNILElBQVcsU0FBUztRQUNsQixPQUFPLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFF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QyxZQUFZO2dCQVFiLFdBQVc7c0JBRGpCLE1BQU07dUJBQUMsU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSG9zdEJpbmRpbmcsXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uRGVzdHJveSxcbiAgT3B0aW9uYWwsXG4gIE91dHB1dCxcbiAgQ29udGVudENoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBTb2hvU3dhcExpc3RTZXJ2aWNlIH0gZnJvbSAnLi9zb2hvLXN3YXBsaXN0LnNlcnZpY2UnO1xuXG5leHBvcnQgdHlwZSBTb2hvU3dhcExpc3RDYXJkVHlwZSA9ICdhdmFpbGFibGUnIHwgJ3NlbGVjdGVkJyB8ICdmdWxsLWFjY2Vzcyc7XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogU1dBUCBMSVNUIENBUkRcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3NvaG8tc3dhcGxpc3QtY2FyZCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgICA8ZGl2IFtjbGFzc109XCJjYXJkQ2xhc3NcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtaGVhZGVyXCI+XG4gICAgICAgICAgPGgyIGNsYXNzPVwiY2FyZC10aXRsZVwiPnt7dGl0bGV9fTwvaDI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImJ1dHRvbnNcIj5cbiAgICAgICAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLWNvbnRlbnRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlzdHZpZXctc2VhcmNoXCIgKm5nSWY9XCJzaG93U2VhcmNoYWJsZVwiPlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiYXVkaWJsZVwiIGZvcj1cInNlYXJjaGZpZWxkLXt7Y2FyZFR5cGV9fVwiPnt7c2VhcmNoVGl0bGV9fTwvbGFiZWw+XG4gICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJzZWFyY2hmaWVsZFwiIHBsYWNlaG9sZGVyPVwie3tzZWFyY2hUaXRsZX19XCIgbmFtZT1cInNlYXJjaGZpZWxkLXt7Y2FyZFR5cGV9fVwiXG4gICAgICAgICAgICAgaWQ9XCJzZWFyY2hmaWVsZC17e2NhcmRUeXBlfX1cIiBkYXRhLWluaXQ9XCJmYWxzZVwiPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0dmlld1wiPjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Td2FwTGlzdENhcmRDb21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnN3YXBsaXN0JykgZ2V0IGlzU3dhcExpc3QoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKiogVGhlIHR5cGUgb2YgY2FyZC4gKi9cbiAgcHJpdmF0ZSBjYXJkdHlwZT86IFNvaG9Td2FwTGlzdENhcmRUeXBlO1xuXG4gIC8qKiBUaGUgdGl0bGUgZm9yIHRoZSBjYXJkLiAqL1xuICBwcml2YXRlIGNhcmR0aXRsZT86IHN0cmluZztcblxuICAvKiogVGhlIHNob3cgc2VhcmNoYWJsZSBmb3IgdGhlIHNlYXJjaC1maWVsZC4gKi9cbiAgcHJpdmF0ZSBzaG93c2VhcmNoYWJsZT86IGJvb2xlYW47XG5cbiAgLyoqIFRoZSBzaG93IHNlYXJjaGFibGUgZm9yIHRoZSBzZWFyY2gtZmllbGQuICovXG4gIHByaXZhdGUgc2VhcmNodGl0bGU/OiBzdHJpbmc7XG5cbiAgQElucHV0KClcbiAgcHVibGljIHNldCB0eXBlKHZhbHVlOiBTb2hvU3dhcExpc3RDYXJkVHlwZSkge1xuICAgIHRoaXMuY2FyZHR5cGUgPSB2YWx1ZTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgc2hvd1NlYXJjaGFibGUodmFsdWU6IGJvb2xlYW4gfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLnNob3dzZWFyY2hhYmxlID0gdmFsdWU7XG4gIH1cbiAgcHVibGljIGdldCBzaG93U2VhcmNoYWJsZSgpOiBib29sZWFuIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zaG93c2VhcmNoYWJsZTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgc2VhcmNoVGl0bGUodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuc2VhcmNodGl0bGUgPSB2YWx1ZTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgc2VhcmNoVGl0bGUoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zZWFyY2h0aXRsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGNsYXNzIHRvIHVzZSBmb3IgdGhlIGNhcmQuXG4gICAqL1xuICBwdWJsaWMgZ2V0IGNhcmRDbGFzcygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgY2FyZCR7dGhpcy5jYXJkdHlwZSA/IGAgJHt0aGlzLmNhcmR0eXBlfWAgOiAnJ31gO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgY2FyZCB0eXBlIHRvIHVzZSBmb3IgdGhlIGNhcmQuXG4gICAqL1xuICBwdWJsaWMgZ2V0IGNhcmRUeXBlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY2FyZHR5cGUgfHwgJyc7XG4gIH1cblxuICAvKipcbiAgICogVGl0bGUgb2YgdGhlIGNhcmQsIGUuZy4gJ0F2YWlsYWJsZScuXG4gICAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IHRpdGxlKHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLmNhcmR0aXRsZSA9IHZhbHVlO1xuICB9XG5cbiAgcHVibGljIGdldCB0aXRsZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNhcmR0aXRsZTtcbiAgfVxufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqIFNXQVAgTElTVFxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc29oby1zd2FwbGlzdCcsXG4gIHRlbXBsYXRlVXJsOiAnc29oby1zd2FwbGlzdC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgU29ob1N3YXBMaXN0Q29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgLyoqIFVzZWQgdG8gcHJvdmlkZSB1bm5hbWVkIGNvbnRyb2xzIHdpdGggYSB1bmlxdWUgaWQuICovXG4gIHByaXZhdGUgc3RhdGljIGNvdW50ZXIgPSAwO1xuXG4gIC8qKiBTZWxlY3RvciBmb3Igb3JpZ2luYXRpbmcgZWxlbWVudC4gKi9cbiAgcHJpdmF0ZSBqUXVlcnlFbGVtZW50PzogSlF1ZXJ5O1xuXG4gIC8qKiBSZWZlcmVuY2UgdG8gdGhlIFNvSG9YaSBjb250cm9sIGFwaS4gKi9cbiAgcHJpdmF0ZSBzd2FwbGlzdD86IFNvaG9Td2FwTGlzdFN0YXRpYyB8IG51bGw7XG5cbiAgLyoqIEJsb2NrIG9mIG9wdGlvbnMsIHVzZSB0aGUgYWNjZXNzb3JzIHRvIG1vZGlmeS4gKi9cbiAgcHJpdmF0ZSBfb3B0aW9uczogU29ob1N3YXBMaXN0T3B0aW9ucyA9IHt9O1xuXG4gIC8qKiBGbGFnIGNvbnRyb2xsaW5nIHRoZSBkaXNwbGF5IG9mIHRoZSBmdWxsIGFjY2VzcyAoYWRkaXRpb25hbCkgaXRlbXMuICovXG4gIHByaXZhdGUgX3Nob3dGdWxsQWNjZXNzQ2FyZCA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBBc3NpZ24gdGhlIGlkIGZvciB0aGUgY29udHJvbFxuICAgKiAobWFwcyB0byB0aGUgbmFtZSB0byB1c2Ugb24gYSBsYWJlbCdzICdmb3InIGF0dHJpYnV0ZSlcbiAgICovXG4gIEBIb3N0QmluZGluZygnaWQnKSBnZXQgaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgfVxuXG4gIC8qKiBBZGRzIHRoZSAnc3dhcGxpc3QnIGNsYXNzIHJlcXVpcmVkIGJ5IHRoZSBTb0hvWGkgY29udHJvbC4gKi9cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5zd2FwbGlzdCcpIGdldCBpc1N3YXBMaXN0KCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEFkZHMgdGhlICdvbmUtdGhpcmQnIGNsYXNzIHJlcXVpcmVkIHdoZW4gZnVsbCBhY2Nlc3MgaXMgc2V0LiAqL1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLm9uZS10aGlyZCcpIGdldCBpc09uZVRoaXJkKCkge1xuICAgIHJldHVybiB0aGlzLnNob3dGdWxsQWNjZXNzQ2FyZDtcbiAgfVxuXG4gIC8qKiBUaGUgY29tcG9uZW50IHVzZWQgdG8gcmVwcmVzZW50IHRoZSBhdmFpbGFibGUgaXRlbXMuICovXG4gIEBDb250ZW50Q2hpbGQoJ2F2YWlsYWJsZScsIHsgc3RhdGljOiB0cnVlIH0pIF9hdmFpbGFibGVDYXJkPzogU29ob1N3YXBMaXN0Q2FyZENvbXBvbmVudCA9IHVuZGVmaW5lZDtcblxuICAvKiogVGhlIGNvbXBvbmVudCB1c2VkIHRvIHJlcHJlc2VudCB0aGUgc2VsZWN0ZWQgaXRlbXMuICovXG4gIEBDb250ZW50Q2hpbGQoJ3NlbGVjdGVkJywgeyBzdGF0aWM6IHRydWUgfSkgX3NlbGVjdGVkQ2FyZD86IFNvaG9Td2FwTGlzdENhcmRDb21wb25lbnQgPSB1bmRlZmluZWQ7XG5cbiAgLyoqIFRoZSBjb21wb25lbnQgdXNlZCB0byByZXByZXNlbnQgdGhlIGZ1bGwgYWNjZXNzIChhZGRpdGlvbmFsKSBpdGVtcy4gKi9cbiAgQENvbnRlbnRDaGlsZCgnYWRkaXRpb25hbCcsIHsgc3RhdGljOiB0cnVlIH0pIF9hZGRpdGlvbmFsQ2FyZD86IFNvaG9Td2FwTGlzdENhcmRDb21wb25lbnQgPSB1bmRlZmluZWQ7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEBJbnB1dHNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKiBOYW1lIGZvciB0aGUgc3dhcGxpc3QgY29udHJvbC4gTmVjZXNzYXJ5IGZvciBuZ01vZGVsIHRvIGZ1bmN0aW9uLiAqL1xuICBASW5wdXQoKSBuYW1lID0gYHNvaG8tc3dhcGxpc3QtJHtTb2hvU3dhcExpc3RDb21wb25lbnQuY291bnRlcisrfWA7XG5cbiAgLyoqIERlZmF1bHQgdGl0bGUgZm9yIGF2YWlsYWJsZSBpdGVtcyBjYXJkLiAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgYXZhaWxhYmxlQ2FyZFRpdGxlID0gU29oby5Mb2NhbGUudHJhbnNsYXRlKCdBdmFpbGFibGUnKTtcblxuICAvKiogRGVmYXVsdCB0aXRsZSBmb3Igc2VsZWN0ZWQgaXRlbXMgY2FyZC4gKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNlbGVjdGVkQ2FyZFRpdGxlID0gU29oby5Mb2NhbGUudHJhbnNsYXRlKCdTZWxlY3RlZCcpO1xuXG4gIC8qKiBEZWZhdWx0IHRpdGxlIGZvciBhZGRpdGlvbmFsIGl0ZW1zIGNhcmQuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBmdWxsQWNjZXNzQ2FyZFRpdGxlID0gU29oby5Mb2NhbGUudHJhbnNsYXRlKCdBZGRpdGlvbmFsSXRlbXMnKTtcblxuICAvKiogRGVmYXVsdCBzZWFyY2ggdGl0bGUgZm9yIGF2YWlsYWJsZSBpdGVtcyBjYXJkLiAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgYXZhaWxhYmxlQ2FyZFNlYXJjaFRpdGxlID0gU29oby5Mb2NhbGUudHJhbnNsYXRlKCdTZWFyY2hBdmFpbGFibGUnKTtcblxuICAvKiogRGVmYXVsdCBzZWFyY2ggdGl0bGUgZm9yIHNlbGVjdGVkIGl0ZW1zIGNhcmQuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZWxlY3RlZENhcmRTZWFyY2hUaXRsZSA9IFNvaG8uTG9jYWxlLnRyYW5zbGF0ZSgnU2VhcmNoU2VsZWN0ZWQnKTtcblxuICAvKiogRGVmYXVsdCBzZWFyY2ggdGl0bGUgZm9yIGFkZGl0aW9uYWwgaXRlbXMgY2FyZC4gKi9cbiAgQElucHV0KClcbiAgcHVibGljIGZ1bGxBY2Nlc3NDYXJkU2VhcmNoVGl0bGUgPSBTb2hvLkxvY2FsZS50cmFuc2xhdGUoJ1NlYXJjaEFkZGl0aW9uYWxJdGVtcycpO1xuXG4gIC8qKiBEZWZhdWx0IGJ1dHRvbiB0ZXh0IGZvciBzZWxlY3QuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBidG5Nb3ZlVG9TZWxlY3QgPSBTb2hvLkxvY2FsZS50cmFuc2xhdGUoJ1NlbGVjdCcpO1xuXG4gIC8qKiBEZWZhdWx0IGJ1dHRvbiB0ZXh0IGZvciBtb3ZlIHRvIGxlZnQuICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBidG5Nb3ZlVG9MZWZ0ID0gU29oby5Mb2NhbGUudHJhbnNsYXRlKCdNb3ZlVG9MZWZ0Jyk7XG5cbiAgLyoqIERlZmF1bHQgYnV0dG9uIHRleHQgZm9yICBtb3ZlIHRvIHJpZ2h0LiAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgYnRuTW92ZVRvUmlnaHQgPSBTb2hvLkxvY2FsZS50cmFuc2xhdGUoJ01vdmVUb1JpZ2h0Jyk7XG5cbiAgLyoqXG4gICAqIFNldCBzZWFyY2hhYmxlIG9wdGlvbiBmb3IgU29ob1N3YXBMaXN0LlxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgb3B0aW9uLlxuICAgKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNldCBzZWFyY2hhYmxlKHZhbHVlOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5zZWFyY2hhYmxlID0gdmFsdWU7XG4gIH1cblxuICBwdWJsaWMgZ2V0IHNlYXJjaGFibGUoKTogYm9vbGVhbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX29wdGlvbnMuc2VhcmNoYWJsZTtcbiAgfVxuXG4gIC8qKiBBZGQgZXh0cmEgYXR0cmlidXRlcyBsaWtlIGlkJ3MgdG8gdGhlIGNvbXBvbmVudCAqKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNldCBhdHRyaWJ1dGVzKHZhbHVlOiBBcnJheTxPYmplY3Q+IHwgT2JqZWN0IHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5hdHRyaWJ1dGVzID0gdmFsdWU7XG4gIH1cbiAgcHVibGljIGdldCBhdHRyaWJ1dGVzKCk6IEFycmF5PE9iamVjdD4gfCBPYmplY3QgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9vcHRpb25zLmF0dHJpYnV0ZXM7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGF2YWlsYWJsZSBjYXJkIGl0ZW1zLlxuICAgKiBAcGFyYW0gdmFsdWUgaXRlbSBkYXRhLlxuICAgKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNldCBhdmFpbGFibGVJdGVtcyh2YWx1ZTogU29ob1N3YXBMaXN0SXRlbVtdIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5hdmFpbGFibGUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5zd2FwbGlzdCkge1xuICAgICAgdGhpcy5zd2FwbGlzdC5zZXR0aW5ncy5hdmFpbGFibGUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc3dhcGxpc3QudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuICBwdWJsaWMgZ2V0IGF2YWlsYWJsZUl0ZW1zKCk6IFNvaG9Td2FwTGlzdEl0ZW1bXSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuQ29udmVydFRvTW9kZWwoKHRoaXMuc3dhcGxpc3QgYXMgYW55KS5nZXRBdmFpbGFibGUoKSk7XG4gIH1cblxuICAvKiogRGlzYWJsZSBkcmFnZ2luZyAoYWxsIHRydWUgYnkgZGVmYXVsdCkgKiovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgZHJhZ2dhYmxlKHZhbHVlOiBTb2hvU3dhcFNlY3Rpb25zIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5kcmFnZ2FibGUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5zd2FwbGlzdCkge1xuICAgICAgdGhpcy5zd2FwbGlzdC5zZXR0aW5ncy5kcmFnZ2FibGUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc3dhcGxpc3QudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXQgZHJhZ2dhYmxlKCk6IFNvaG9Td2FwU2VjdGlvbnMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmRyYWdnYWJsZTtcbiAgfVxuXG4gIC8qKiBLZWVwIGl0ZW1zIGluIHRoZSBzZWN0aW9uIHdoZW4gbW92aW5nIChhbGwgZmFsc2UgYnkgZGVmYXVsdCkgKiovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQga2VlcEluTGlzdCh2YWx1ZTogU29ob1N3YXBTZWN0aW9ucyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX29wdGlvbnMua2VlcEluTGlzdCA9IHZhbHVlO1xuICAgIGlmICh0aGlzLnN3YXBsaXN0KSB7XG4gICAgICB0aGlzLnN3YXBsaXN0LnNldHRpbmdzLmtlZXBJbkxpc3QgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc3dhcGxpc3QudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXQga2VlcEluTGlzdCgpOiBTb2hvU3dhcFNlY3Rpb25zIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5rZWVwSW5MaXN0O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBzZWxlY3RlZCBjYXJkIGl0ZW1zLlxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgaXRlbSBkYXRhLlxuICAgKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNldCBzZWxlY3RlZEl0ZW1zKHZhbHVlOiBTb2hvU3dhcExpc3RJdGVtW10pIHtcbiAgICB0aGlzLl9vcHRpb25zLnNlbGVjdGVkID0gdmFsdWU7XG4gICAgaWYgKHRoaXMuc3dhcGxpc3QpIHtcbiAgICAgIHRoaXMuc3dhcGxpc3Quc2V0dGluZ3Muc2VsZWN0ZWQgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc3dhcGxpc3QudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGRhdGFzZXQgY3VycmVudGx5IHNlbGVjdGVkIGNhcmQgaXRlbXMuXG4gICAqXG4gICAqIEByZXR1cm4gYW4gYXJyYXkgb2YgU29ob1N3YXBMaXN0SXRlbS5cbiAgICovXG4gIHB1YmxpYyBnZXQgc2VsZWN0ZWRJdGVtcygpOiBTb2hvU3dhcExpc3RJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLkNvbnZlcnRUb01vZGVsKCh0aGlzLnN3YXBsaXN0IGFzIGFueSkuZ2V0U2VsZWN0ZWQoKSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGFkZGl0aW9uYWwgY2FyZCBpdGVtcy5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIGl0ZW0gZGF0YS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgYWRkaXRpb25hbEl0ZW1zKHZhbHVlOiBTb2hvU3dhcExpc3RJdGVtW10pIHtcbiAgICB0aGlzLl9vcHRpb25zLmFkZGl0aW9uYWwgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5zd2FwbGlzdCkge1xuICAgICAgdGhpcy5zd2FwbGlzdC5zZXR0aW5ncy5hZGRpdGlvbmFsID0gdmFsdWU7XG4gICAgICB0aGlzLnN3YXBsaXN0LnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBkYXRhc2V0IGN1cnJlbnRseSBhZGRpdGlvbmFsIGNhcmQgaXRlbXMuXG4gICAqXG4gICAqIEByZXR1cm4gYW4gYXJyYXkgb2YgU29ob1N3YXBMaXN0SXRlbS5cbiAgICovXG4gIHB1YmxpYyBnZXQgYWRkaXRpb25hbEl0ZW1zKCk6IFNvaG9Td2FwTGlzdEl0ZW1bXSB7XG4gICAgcmV0dXJuIHRoaXMuQ29udmVydFRvTW9kZWwoKHRoaXMuc3dhcGxpc3QgYXMgYW55KS5nZXRBZGRpdGlvbmFsKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBmbGFnIHRvIGRpc3BsYXkgdGhpcmQgY2FyZCBmdWxsIGFjY2VzcyBjYXJkIG9yIG5vdC5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byBzaG93IGZ1bGwgYWNjZXNzIGNhcmQuXG4gICAqL1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IHNob3dGdWxsQWNjZXNzQ2FyZCh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3Nob3dGdWxsQWNjZXNzQ2FyZCA9IHZhbHVlID09PSBudWxsIHx8IHZhbHVlIGFzIGFueSA9PT0gJ3RydWUnO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdmFsdWUgd2hldGhlciBmdWxsIGFjY2VzcyBjYXJkIGRpc3BsYXllZC5cbiAgICpcbiAgICogQHJldHVybiBib29sZWFuIHZhbHVlLlxuICAgKi9cbiAgcHVibGljIGdldCBzaG93RnVsbEFjY2Vzc0NhcmQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Nob3dGdWxsQWNjZXNzQ2FyZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgYmVmb3JlIHN3YXAgaXRlbS9zLlxuICAgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9uby1vdXRwdXQtcmVuYW1lXG4gIEBPdXRwdXQoJ2JlZm9yZXN3YXAnKVxuICBwdWJsaWMgYmVmb3JlU3dhcEV2ZW50ID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvU3dhcExpc3RCZWZvcmVTd2FwRXZlbnQ+KCk7XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoZSBzd2FwIGxpc3QgdXBkYXRlcyBpbiBzb21lIHdheS5cbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8tb3V0cHV0LXJlbmFtZVxuICBAT3V0cHV0KCd1cGRhdGVkJylcbiAgcHVibGljIHVwZGF0ZUV2ZW50ID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvU3dhcExpc3RTd2FwVXBkYXRlRXZlbnQ+KCk7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIENvbnN0cnVjdG9yXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIHN3YXBsaXN0U2VydmljZTogU29ob1N3YXBMaXN0U2VydmljZSkge1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQuZmluZCgnLnNlYXJjaGZpZWxkJykuc2VhcmNoZmllbGQoeyBjbGVhcmFibGU6IHRydWUgfSk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQuc3dhcGxpc3QodGhpcy5fb3B0aW9ucyk7XG5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudFxuICAgICAgICAub24oJ2JlZm9yZXN3YXAnLCAoZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgbW92ZWQ6IFNvaG9Td2FwTGlzdE1vdmVkKSA9PiB0aGlzLm9uQmVmb3JlU3dhcChldmVudCwgbW92ZWQpKVxuICAgICAgICAub24oJ3N3YXB1cGRhdGUnLCAoZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgbW92ZWQ6IFNvaG9Td2FwTGlzdE1vdmVkKSA9PiB0aGlzLm9uU3dhcFVwZGF0ZShldmVudCwgbW92ZWQpKTtcblxuICAgICAgdGhpcy5zd2FwbGlzdCA9IHRoaXMualF1ZXJ5RWxlbWVudC5kYXRhKCdzd2FwbGlzdCcpO1xuXG4gICAgICBpZiAodGhpcy5zd2FwbGlzdFNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5zd2FwbGlzdFNlcnZpY2UuZ2V0RGF0YSgpLnN1YnNjcmliZSgoZDogU29ob1N3YXBMaXN0T3B0aW9ucykgPT4ge1xuICAgICAgICAgIHRoaXMudXBkYXRlRGF0YXNldChkKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveXMgYW55IHJlc291cmNlcyBjcmVhdGVkIGJ5IHRoZSBjb250cm9sLlxuICAgKi9cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuc3dhcGxpc3QpIHtcbiAgICAgICAgdGhpcy5zd2FwbGlzdC5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuc3dhcGxpc3QgPSBudWxsO1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQ/Lm9mZigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEluIGNhc2UgdGhlIGxpc3QgZGF0YSBpcyBiZWluZyBib3VuZCBhc3luY2hyb25vdXNseSBvciBtb2RpZmllZCBvbiB0aGUgZmx5LFxuICAgKiB5b3Ugd2lsbCBuZWVkIHRvIHRyaWdnZXIgdXBkYXRlZCBvbiBzbyBpdCB1cGRhdGVzIHRoZSBsaXN0KHMpLlxuICAgKi9cbiAgcHVibGljIHVwZGF0ZWQoKSB7XG4gICAgaWYgKHRoaXMuc3dhcGxpc3QpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuc3dhcGxpc3Q/LnVwZGF0ZWQoKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGRhdGFzZXQgdXNlZCBieSB0aGUgc3dhcGxpc3QsIGR5bmFtaWNhbGx5IHJlZmVzaW5nIHRoZVxuICAgKiBjb250cm9sJ3Mgdmlldy5cbiAgICpcbiAgICogQHBhcmFtIGRhdGFzZXQgdGhlIGRhdGFzZXQgdG8gYXNzaWduLlxuICAgKi9cbiAgcHVibGljIHVwZGF0ZURhdGFzZXQoZGF0YXNldDogU29ob1N3YXBMaXN0T3B0aW9ucykge1xuICAgIHRoaXMuX29wdGlvbnMuYXZhaWxhYmxlID0gZGF0YXNldC5hdmFpbGFibGU7XG4gICAgdGhpcy5fb3B0aW9ucy5zZWxlY3RlZCA9IGRhdGFzZXQuc2VsZWN0ZWQ7XG4gICAgdGhpcy5fb3B0aW9ucy5hZGRpdGlvbmFsID0gZGF0YXNldC5hZGRpdGlvbmFsO1xuICAgIGlmICh0aGlzLnN3YXBsaXN0KSB7XG4gICAgICB0aGlzLnN3YXBsaXN0LnVwZGF0ZURhdGFzZXQodGhpcy5fb3B0aW9ucyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIHRoZSBsaXN0IG9mIGl0ZW1zIGludG8gYSBsaXN0IG9mIHN3YXBsaXN0IGl0ZW1zLlxuICAgKlxuICAgKiBAcGFyYW0gaXRlbXMgZGF0YSB0byBjb252ZXJ0IHRvIGl0ZW0gbW9kZWwuXG4gICAqXG4gICAqIEB0b2RvIHJlbW92ZSBhbnlcbiAgICovXG4gIHByaXZhdGUgQ29udmVydFRvTW9kZWwoaXRlbXM6IGFueVtdKTogU29ob1N3YXBMaXN0SXRlbVtdIHtcbiAgICBjb25zdCByZXN1bHRzID0gW107XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICByZXN1bHRzLnB1c2goeyBpZDogaXRlbS5pZCwgdmFsdWU6IGl0ZW0udmFsdWUsIHRleHQ6IGl0ZW0udGV4dCB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIG9uQmVmb3JlU3dhcChldmVudDogU29ob1N3YXBMaXN0QmVmb3JlU3dhcEV2ZW50LCBtb3ZlZDogU29ob1N3YXBMaXN0TW92ZWQpIHtcbiAgICBldmVudC5tb3ZlZCA9IG1vdmVkO1xuICAgIHRoaXMuYmVmb3JlU3dhcEV2ZW50LmVtaXQoZXZlbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSBvblN3YXBVcGRhdGUoZXZlbnQ6IFNvaG9Td2FwTGlzdFN3YXBVcGRhdGVFdmVudCwgbW92ZWQ6IFNvaG9Td2FwTGlzdE1vdmVkKSB7XG4gICAgZXZlbnQubW92ZWQgPSBtb3ZlZDtcbiAgICB0aGlzLnVwZGF0ZUV2ZW50LmVtaXQoZXZlbnQpO1xuICB9XG59XG4iLCI8ZGl2PlxuICA8c29oby1zd2FwbGlzdC1jYXJkIHR5cGU9XCJhdmFpbGFibGVcIiB0aXRsZT1cInt7YXZhaWxhYmxlQ2FyZFRpdGxlfX1cIiBzZWFyY2hUaXRsZT1cInt7YXZhaWxhYmxlQ2FyZFNlYXJjaFRpdGxlfX1cIiBzaG93U2VhcmNoYWJsZT1cInt7c2VhcmNoYWJsZX19XCI+XG4gICAgPGJ1dHRvbiBzb2hvLWJ1dHRvbj1cImJ0blwiIGljb249XCJyaWdodC1hcnJvd1wiIG1vdmVUb1NlbGVjdGVkPVwidHJ1ZVwiIHRpdGxlPVwie3tidG5Nb3ZlVG9TZWxlY3R9fVwiPjwvYnV0dG9uPlxuICA8L3NvaG8tc3dhcGxpc3QtY2FyZD5cbiAgPHNvaG8tc3dhcGxpc3QtY2FyZCB0eXBlPVwic2VsZWN0ZWRcIiB0aXRsZT1cInt7c2VsZWN0ZWRDYXJkVGl0bGV9fVwiIHNlYXJjaFRpdGxlPVwie3tzZWxlY3RlZENhcmRTZWFyY2hUaXRsZX19XCIgc2hvd1NlYXJjaGFibGU9XCJ7e3NlYXJjaGFibGV9fVwiPlxuICAgIDxidXR0b24gc29oby1idXR0b249XCJidG5cIiBpY29uPVwibGVmdC1hcnJvd1wiIG1vdmVUb0xlZnQ9XCJ0cnVlXCIgdGl0bGU9XCJ7e2J0bk1vdmVUb0xlZnR9fVwiPjwvYnV0dG9uPlxuICAgIDxidXR0b24gKm5nSWY9XCJzaG93RnVsbEFjY2Vzc0NhcmRcIiBzb2hvLWJ1dHRvbj1cImJ0blwiIGljb249XCJyaWdodC1hcnJvd1wiIG1vdmVUb1JpZ2h0PVwidHJ1ZVwiIHRpdGxlPVwie3tidG5Nb3ZlVG9SaWdodH19XCI+XG4gICAgPC9idXR0b24+XG4gIDwvc29oby1zd2FwbGlzdC1jYXJkPlxuICA8c29oby1zd2FwbGlzdC1jYXJkICpuZ0lmPVwic2hvd0Z1bGxBY2Nlc3NDYXJkXCIgdHlwZT1cImZ1bGwtYWNjZXNzXCIgdGl0bGU9XCJ7e2Z1bGxBY2Nlc3NDYXJkVGl0bGV9fVwiIHNlYXJjaFRpdGxlPVwie3tmdWxsQWNjZXNzQ2FyZFNlYXJjaFRpdGxlfX1cIiBzaG93U2VhcmNoYWJsZT1cInt7c2VhcmNoYWJsZX19XCI+XG4gICAgIDxidXR0b24gc29oby1idXR0b249XCJidG5cIiBpY29uPVwibGVmdC1hcnJvd1wiIG1vdmVUb1NlbGVjdGVkPVwidHJ1ZVwiIHRpdGxlPVwie3tidG5Nb3ZlVG9MZWZ0fX1cIj48L2J1dHRvbj5cbiAgPC9zb2hvLXN3YXBsaXN0LWNhcmQ+XG48L2Rpdj5cbiJdfQ==