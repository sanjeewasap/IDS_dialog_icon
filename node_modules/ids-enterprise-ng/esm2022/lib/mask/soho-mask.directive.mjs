import { Directive, EventEmitter, Input, Output } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoMaskDirective {
    /** Sets all the options. */
    set options(value) {
        this._options = (typeof value === 'string') ? JSON.parse(value) : value;
        if (this.mask) {
            // After the mask has been created do not overwrite the mask.settings.
            // That will cause certain required defaults to go missing out of the mask.settings object.
            // Instead just call updated() with the new _options. The mask-input.js update() function
            // merges the new setting in w/o losing any important default.
            this.mask.updated(this._options);
        }
    }
    /** Definitions of pattern(s) as a regular expression. */
    set definitions(value) {
        this._options.definitions = value;
        if (this.mask) {
            this.mask.settings.definitions = value;
            this.mask.updated();
        }
    }
    /** When true, appends the leftover characters in the placeholder to the conformed value. */
    set guide(value) {
        this._options.guide = value;
        if (this.mask) {
            this.mask.settings.guide = value;
            this.mask.updated();
        }
    }
    /** When true, keeps groups of character intact. */
    set keepCharacterPositions(value) {
        this._options.keepCharacterPositions = value;
        if (this.mask) {
            this.mask.settings.keepCharacterPositions = value;
            this.mask.updated();
        }
    }
    /** Function that replaces the internal masking functionality. */
    set maskAPI(value) {
        this._options.maskAPI = value;
        if (this.mask) {
            this.mask.settings.maskAPI = value;
            this.mask.updated();
        }
    }
    /**
     *  The pattern to use for the mask.
     *
     * This uses the sohoPrefix otherwise the pattern interferes
     * with the pattern on form groups.
     */
    set sohoPattern(value) {
        this._options.pattern = value;
        if (this.mask) {
            this.mask.settings.pattern = value;
            this.mask.updated();
        }
    }
    /** Function that is executed after the masking process is complete. */
    set pipe(value) {
        this._options.pipe = value;
        if (this.mask) {
            this.mask.settings.pipe = value;
            this.mask.updated();
        }
    }
    /** The placeholder text for the mask. */
    set placeholder(value) {
        this._options.placeholderChar = value;
        if (this.mask) {
            this.mask.settings.placeholderChar = value;
            this.mask.updated();
        }
    }
    /** Indicates special formatting rules may apply to the mask. */
    set process(value) {
        this._options.process = value;
        if (this.mask) {
            this.mask.settings.process = value;
            this.mask.updated();
        }
    }
    /** When true, the onblur event executes mask processing. */
    set processOnBlur(value) {
        this._options.processOnBlur = value;
        if (this.mask) {
            this.mask.settings.processOnBlur = value;
            this.mask.updated();
        }
    }
    /** Indicates to initially mask the value of the input field. */
    set processOnInitialize(value) {
        this._options.processOnInitialize = value;
        if (this.mask) {
            this.mask.settings.processOnInitialize = value;
            this.mask.updated();
        }
    }
    /** The pattern options. */
    set patternOptions(value) {
        this._options.patternOptions = (typeof value === 'string') ? JSON.parse(value) : value;
        if (this.mask) {
            this.mask.settings.patternOptions = this._options.patternOptions;
            this.mask.updated();
        }
    }
    /** When true, the decimal separator symbol is allowed in a formatted number. */
    set allowDecimal(value) {
        this._options.patternOptions.allowDecimal = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowDecimal = value;
            this.mask.updated();
        }
    }
    /** When true, allows leading zeros in a formatted number. */
    set allowLeadingZeros(value) {
        this._options.patternOptions.allowLeadingZeros = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowLeadingZeros = value;
            this.mask.updated();
        }
    }
    /** When true, the negative symbol is allowed in a formatted number. */
    set allowNegative(value) {
        this._options.patternOptions.allowNegative = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowNegative = value;
            this.mask.updated();
        }
    }
    /** When true, adds the thousands separator symbol to the correct location in a formatted number. */
    set allowThousandsSeparator(value) {
        this._options.patternOptions.allowThousandsSeparator = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowThousandsSeparator = value;
            this.mask.updated();
        }
    }
    /** The maximum number of digits to the left of the decimal separator symbol in a formatted number. */
    set decimalLimit(value) {
        this._options.patternOptions.decimalLimit = value;
        if (this.mask) {
            this.mask.settings.patternOptions.decimalLimit = value;
            this.mask.updated();
        }
    }
    /** The maximum number of digits to the right of decimal separator symbol in a formatted number. */
    set integerLimit(value) {
        this._options.patternOptions.integerLimit = value;
        if (this.mask) {
            this.mask.settings.patternOptions.integerLimit = value;
            this.mask.updated();
        }
    }
    /** The character that precedes the masked value. */
    set prefix(value) {
        this._options.patternOptions.prefix = value;
        if (this.mask) {
            this.mask.settings.patternOptions.prefix = value;
            this.mask.updated();
        }
    }
    /** When true, the decimal separator symbol is required in a formatted number. */
    set requireDecimal(value) {
        this._options.patternOptions.requireDecimal = value;
        if (this.mask) {
            this.mask.settings.patternOptions.requireDecimal = value;
            this.mask.updated();
        }
    }
    /** The character that follows the masked value. */
    set suffix(value) {
        this._options.patternOptions.suffix = value;
        if (this.mask) {
            this.mask.settings.patternOptions.suffix = value;
            this.mask.updated();
        }
    }
    /** The symbols to use for the formatted number. */
    set symbols(value) {
        this._options.patternOptions.symbols = (typeof value === 'string') ? JSON.parse(value) : value;
        if (this.mask) {
            this.mask.settings.patternOptions.symbols = this._options.patternOptions.symbols;
            this.mask.updated();
        }
    }
    /** The locale to use for the formatted number. */
    set locale(value) {
        this._options.patternOptions.locale = value;
        if (this.mask) {
            this.mask.settings.patternOptions.locale = this._options.patternOptions.locale;
            this.mask.updated();
        }
    }
    /** The currency symbol to use for the formatted number. */
    set currencySymbol(value) {
        this._options.patternOptions.symbols.currency = value;
        if (this.mask) {
            this.mask.settings.patternOptions.symbols.currency = value;
            this.mask.updated();
        }
    }
    /** The decimal separator symbol to use for the formatted number. */
    set decimalSymbol(value) {
        this._options.patternOptions.symbols.decimal = value;
        if (this.mask) {
            this.mask.settings.patternOptions.symbols.decimal = value;
            this.mask.updated();
        }
    }
    /** The negative symbol to use for the formatted number. */
    set negativeSymbol(value) {
        this._options.patternOptions.symbols.negative = value;
        if (this.mask) {
            this.mask.settings.patternOptions.symbols.negative = value;
            this.mask.updated();
        }
    }
    /** The thousands separator symbol to use for the formatted number. */
    set thousandsSymbol(value) {
        this._options.patternOptions.symbols.thousands = value;
        if (this.mask) {
            this.mask.settings.patternOptions.symbols.thousands = value;
            this.mask.updated();
        }
    }
    // deprecated methods
    /**
     * Indicates if each section of the group pattern match must be full in order for
     * the literals in-between each section to be automatically added (meaning you can't
     * type a literal to end that group until all characters in that group are entered).
     *
     * @deprecated not supported
     */
    set groupComplete(_value) {
        console.warn('The groupComplete input is no longer supported, please remove your usage.');
    }
    /**
     * Indicates special formatting rules may apply to the mask.
     *
     * @deprecated use process instead
     */
    set mode(value) {
        console.warn('The mode input has been renamed, please use the process input instead.');
        this._options.process = value;
        if (this.mask) {
            this.mask.settings.process = value;
            this.mask.updated();
        }
    }
    /**
     * Indicates to complete the full mask or the mask will revert to empty.
     *
     * @deprecated not supported
     */
    set mustComplete(_value) {
        console.warn('The mustComplete input is no longer supported, please remove your usage.');
    }
    /**
     * Indicates you can enter the negative symbol in front of the number;
     * automatically set to true if a negative symbol is detected inside the mask.
     *
     * @deprecated use allowNegative instead
     */
    set negative(value) {
        console.warn('The negative input has been renamed, please use the allowNegative input instead.');
        this._options.patternOptions.allowNegative = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowNegative = value;
            this.mask.updated();
        }
    }
    /**
     * Option defined in control, but not referenced.
     *
     * @deprecated
     */
    set number(_value) {
        console.warn('The number input is no longer supported, please remove your usage.');
    }
    /**
     * Indicates the thousands separator for numbers (based on localization) will be
     * inserted wherever necessary during typing; automatically set to true if the
     * localized thousands separator is detected inside the mask.
     *
     * @deprecated use allowThousandsSeparator instead
     */
    set thousandsSeparator(value) {
        console.warn('The thousandsSeparator input has been renamed, please use the allowThousandsSeparator input instead.');
        this._options.patternOptions.allowThousandsSeparator = value;
        if (this.mask) {
            this.mask.settings.patternOptions.allowThousandsSeparator = value;
            this.mask.updated();
        }
    }
    /**
     * Indicates to display the localized symbol for currency or percent;
     * backwards compatible with old 'data-show-currency'; value true equates to currency
     *
     * @deprecated use prefix or suffix instead
     */
    set showSymbol(_value) {
        console.warn('The showSymbol input is no longer supported, please use the prefix or suffix input instead.');
    }
    constructor(element) {
        this.element = element;
        /**
         * Called when mask value changes
         */
        this.write = new EventEmitter();
        this._symbols = {};
        this._patternOptions = {
            symbols: this._symbols
        };
        this._options = {
            patternOptions: this._patternOptions
        };
    }
    ngAfterViewInit() {
        this.jQueryElement = jQuery(this.element.nativeElement);
        this.jQueryElement.mask(this._options);
        this.mask = this.jQueryElement.data('mask');
        /**
         * Bind to jQueryElement's events
         */
        this.jQueryElement
            .on('write.mask', (event) => {
            this.write.emit(event);
        });
    }
    /** Destructor. */
    ngOnDestroy() {
        if (this.jQueryElement) {
            this.jQueryElement.off();
            this.jQueryElement = undefined;
        }
        if (this.mask) {
            this.mask.destroy();
            this.mask = null;
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoMaskDirective, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.1.4", type: SohoMaskDirective, selector: "input[soho-mask]", inputs: { options: "options", definitions: "definitions", guide: "guide", keepCharacterPositions: "keepCharacterPositions", maskAPI: "maskAPI", sohoPattern: "sohoPattern", pipe: "pipe", placeholder: "placeholder", process: "process", processOnBlur: "processOnBlur", processOnInitialize: "processOnInitialize", patternOptions: "patternOptions", allowDecimal: "allowDecimal", allowLeadingZeros: "allowLeadingZeros", allowNegative: "allowNegative", allowThousandsSeparator: "allowThousandsSeparator", decimalLimit: "decimalLimit", integerLimit: "integerLimit", prefix: "prefix", requireDecimal: "requireDecimal", suffix: "suffix", symbols: "symbols", locale: "locale", currencySymbol: "currencySymbol", decimalSymbol: "decimalSymbol", negativeSymbol: "negativeSymbol", thousandsSymbol: "thousandsSymbol", groupComplete: "groupComplete", mode: "mode", mustComplete: "mustComplete", negative: "negative", number: "number", thousandsSeparator: "thousandsSeparator", showSymbol: "showSymbol" }, outputs: { write: "write" }, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoMaskDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'input[soho-mask]' // eslint-disable-line
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { options: [{
                type: Input
            }], definitions: [{
                type: Input
            }], guide: [{
                type: Input
            }], keepCharacterPositions: [{
                type: Input
            }], maskAPI: [{
                type: Input
            }], sohoPattern: [{
                type: Input
            }], pipe: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], process: [{
                type: Input
            }], processOnBlur: [{
                type: Input
            }], processOnInitialize: [{
                type: Input
            }], patternOptions: [{
                type: Input
            }], allowDecimal: [{
                type: Input
            }], allowLeadingZeros: [{
                type: Input
            }], allowNegative: [{
                type: Input
            }], allowThousandsSeparator: [{
                type: Input
            }], decimalLimit: [{
                type: Input
            }], integerLimit: [{
                type: Input
            }], prefix: [{
                type: Input
            }], requireDecimal: [{
                type: Input
            }], suffix: [{
                type: Input
            }], symbols: [{
                type: Input
            }], locale: [{
                type: Input
            }], currencySymbol: [{
                type: Input
            }], decimalSymbol: [{
                type: Input
            }], negativeSymbol: [{
                type: Input
            }], thousandsSymbol: [{
                type: Input
            }], groupComplete: [{
                type: Input
            }], mode: [{
                type: Input
            }], mustComplete: [{
                type: Input
            }], negative: [{
                type: Input
            }], number: [{
                type: Input
            }], thousandsSeparator: [{
                type: Input
            }], showSymbol: [{
                type: Input
            }], write: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1tYXNrLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvbWFzay9zb2hvLW1hc2suZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFFTCxNQUFNLEVBQ1AsTUFBTSxlQUFlLENBQUM7O0FBS3ZCLE1BQU0sT0FBTyxpQkFBaUI7SUFPNUIsNEJBQTRCO0lBQzVCLElBQWEsT0FBTyxDQUFDLEtBQStCO1FBQ2xELElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxPQUFPLEtBQUssS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ3hFLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUNiLHNFQUFzRTtZQUN0RSwyRkFBMkY7WUFDM0YseUZBQXlGO1lBQ3pGLDhEQUE4RDtZQUM5RCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDbEM7SUFDSCxDQUFDO0lBRUQseURBQXlEO0lBQ3pELElBQWEsV0FBVyxDQUFDLEtBQWdDO1FBQ3ZELElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztRQUNsQyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDWixJQUFJLENBQUMsSUFBWSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQ2hELElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7U0FDckI7SUFDSCxDQUFDO0lBRUQsNEZBQTRGO0lBQzVGLElBQWEsS0FBSyxDQUFDLEtBQWM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEdBQUcsS0FB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LEtBQUs7Z0JBU08sTUFBTTtzQkFBbEIsS0FBSztnQkFTTyxPQUFPO3NCQUFuQixLQUFLO2dCQVNPLE1BQU07c0JBQWxCLEtBQUs7Z0JBU08sY0FBYztzQkFBMUIsS0FBSztnQkFTTyxhQUFhO3NCQUF6QixLQUFLO2dCQVNPLGNBQWM7c0JBQTFCLEtBQUs7Z0JBU08sZUFBZTtzQkFBM0IsS0FBSztnQkFnQk8sYUFBYTtzQkFBekIsS0FBSztnQkFTTyxJQUFJO3NCQUFoQixLQUFLO2dCQWVPLFlBQVk7c0JBQXhCLEtBQUs7Z0JBVU8sUUFBUTtzQkFBcEIsS0FBSztnQkFlTyxNQUFNO3NCQUFsQixLQUFLO2dCQVdPLGtCQUFrQjtzQkFBOUIsS0FBSztnQkFnQk8sVUFBVTtzQkFBdEIsS0FBSztnQkFPSSxLQUFLO3NCQUFkLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBEaXJlY3RpdmUsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdpbnB1dFtzb2hvLW1hc2tdJyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9NYXNrRGlyZWN0aXZlIGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICAvKiogUHJpdmF0ZSBjb250cm9sIG9wdGlvbnMuICovXG4gIHByaXZhdGUgX29wdGlvbnM6IFNvaG9NYXNrT3B0aW9ucztcbiAgcHJpdmF0ZSBfcGF0dGVybk9wdGlvbnM6IFNvaG9NYXNrUGF0dGVybk9wdGlvbnM7XG4gIHByaXZhdGUgX3N5bWJvbHM6IFNvaG9NYXNrUGF0dGVyblN5bWJvbHM7XG5cbiAgLyoqIFNldHMgYWxsIHRoZSBvcHRpb25zLiAqL1xuICBASW5wdXQoKSBzZXQgb3B0aW9ucyh2YWx1ZTogU29ob01hc2tPcHRpb25zIHwgc3RyaW5nKSB7XG4gICAgdGhpcy5fb3B0aW9ucyA9ICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSA/IEpTT04ucGFyc2UodmFsdWUpIDogdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgLy8gQWZ0ZXIgdGhlIG1hc2sgaGFzIGJlZW4gY3JlYXRlZCBkbyBub3Qgb3ZlcndyaXRlIHRoZSBtYXNrLnNldHRpbmdzLlxuICAgICAgLy8gVGhhdCB3aWxsIGNhdXNlIGNlcnRhaW4gcmVxdWlyZWQgZGVmYXVsdHMgdG8gZ28gbWlzc2luZyBvdXQgb2YgdGhlIG1hc2suc2V0dGluZ3Mgb2JqZWN0LlxuICAgICAgLy8gSW5zdGVhZCBqdXN0IGNhbGwgdXBkYXRlZCgpIHdpdGggdGhlIG5ldyBfb3B0aW9ucy4gVGhlIG1hc2staW5wdXQuanMgdXBkYXRlKCkgZnVuY3Rpb25cbiAgICAgIC8vIG1lcmdlcyB0aGUgbmV3IHNldHRpbmcgaW4gdy9vIGxvc2luZyBhbnkgaW1wb3J0YW50IGRlZmF1bHQuXG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCh0aGlzLl9vcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICAvKiogRGVmaW5pdGlvbnMgb2YgcGF0dGVybihzKSBhcyBhIHJlZ3VsYXIgZXhwcmVzc2lvbi4gKi9cbiAgQElucHV0KCkgc2V0IGRlZmluaXRpb25zKHZhbHVlOiB7IFtrZXk6IHN0cmluZ106IFJlZ0V4cCB9KSB7XG4gICAgdGhpcy5fb3B0aW9ucy5kZWZpbml0aW9ucyA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgICh0aGlzLm1hc2sgYXMgYW55KS5zZXR0aW5ncy5kZWZpbml0aW9ucyA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogV2hlbiB0cnVlLCBhcHBlbmRzIHRoZSBsZWZ0b3ZlciBjaGFyYWN0ZXJzIGluIHRoZSBwbGFjZWhvbGRlciB0byB0aGUgY29uZm9ybWVkIHZhbHVlLiAqL1xuICBASW5wdXQoKSBzZXQgZ3VpZGUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9vcHRpb25zLmd1aWRlID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgdGhpcy5tYXNrLnNldHRpbmdzLmd1aWRlID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBXaGVuIHRydWUsIGtlZXBzIGdyb3VwcyBvZiBjaGFyYWN0ZXIgaW50YWN0LiAqL1xuICBASW5wdXQoKSBzZXQga2VlcENoYXJhY3RlclBvc2l0aW9ucyh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX29wdGlvbnMua2VlcENoYXJhY3RlclBvc2l0aW9ucyA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5rZWVwQ2hhcmFjdGVyUG9zaXRpb25zID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBGdW5jdGlvbiB0aGF0IHJlcGxhY2VzIHRoZSBpbnRlcm5hbCBtYXNraW5nIGZ1bmN0aW9uYWxpdHkuICovXG4gIEBJbnB1dCgpIHNldCBtYXNrQVBJKHZhbHVlOiBGdW5jdGlvbikge1xuICAgIHRoaXMuX29wdGlvbnMubWFza0FQSSA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5tYXNrQVBJID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiAgVGhlIHBhdHRlcm4gdG8gdXNlIGZvciB0aGUgbWFzay5cbiAgICpcbiAgICogVGhpcyB1c2VzIHRoZSBzb2hvUHJlZml4IG90aGVyd2lzZSB0aGUgcGF0dGVybiBpbnRlcmZlcmVzXG4gICAqIHdpdGggdGhlIHBhdHRlcm4gb24gZm9ybSBncm91cHMuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgc29ob1BhdHRlcm4odmFsdWU6IFNvaG9NYXNrUGF0dGVybikge1xuICAgIHRoaXMuX29wdGlvbnMucGF0dGVybiA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5wYXR0ZXJuID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBGdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIGFmdGVyIHRoZSBtYXNraW5nIHByb2Nlc3MgaXMgY29tcGxldGUuICovXG4gIEBJbnB1dCgpIHNldCBwaXBlKHZhbHVlOiBGdW5jdGlvbikge1xuICAgIHRoaXMuX29wdGlvbnMucGlwZSA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5waXBlID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGUgcGxhY2Vob2xkZXIgdGV4dCBmb3IgdGhlIG1hc2suICovXG4gIEBJbnB1dCgpIHNldCBwbGFjZWhvbGRlcih2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5wbGFjZWhvbGRlckNoYXIgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICB0aGlzLm1hc2suc2V0dGluZ3MucGxhY2Vob2xkZXJDaGFyID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBJbmRpY2F0ZXMgc3BlY2lhbCBmb3JtYXR0aW5nIHJ1bGVzIG1heSBhcHBseSB0byB0aGUgbWFzay4gKi9cbiAgQElucHV0KCkgc2V0IHByb2Nlc3ModmFsdWU6IFNvaG9NYXNrUHJvY2Vzcykge1xuICAgIHRoaXMuX29wdGlvbnMucHJvY2VzcyA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5wcm9jZXNzID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBXaGVuIHRydWUsIHRoZSBvbmJsdXIgZXZlbnQgZXhlY3V0ZXMgbWFzayBwcm9jZXNzaW5nLiAqL1xuICBASW5wdXQoKSBzZXQgcHJvY2Vzc09uQmx1cih2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX29wdGlvbnMucHJvY2Vzc09uQmx1ciA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5wcm9jZXNzT25CbHVyID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBJbmRpY2F0ZXMgdG8gaW5pdGlhbGx5IG1hc2sgdGhlIHZhbHVlIG9mIHRoZSBpbnB1dCBmaWVsZC4gKi9cbiAgQElucHV0KCkgc2V0IHByb2Nlc3NPbkluaXRpYWxpemUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9vcHRpb25zLnByb2Nlc3NPbkluaXRpYWxpemUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICB0aGlzLm1hc2suc2V0dGluZ3MucHJvY2Vzc09uSW5pdGlhbGl6ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogVGhlIHBhdHRlcm4gb3B0aW9ucy4gKi9cbiAgQElucHV0KCkgc2V0IHBhdHRlcm5PcHRpb25zKHZhbHVlOiBTb2hvTWFza1BhdHRlcm5PcHRpb25zIHwgc3RyaW5nKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5wYXR0ZXJuT3B0aW9ucyA9ICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSA/IEpTT04ucGFyc2UodmFsdWUpIDogdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgdGhpcy5tYXNrLnNldHRpbmdzLnBhdHRlcm5PcHRpb25zID0gdGhpcy5fb3B0aW9ucy5wYXR0ZXJuT3B0aW9ucztcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFdoZW4gdHJ1ZSwgdGhlIGRlY2ltYWwgc2VwYXJhdG9yIHN5bWJvbCBpcyBhbGxvd2VkIGluIGEgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IGFsbG93RGVjaW1hbCh2YWx1ZTogYm9vbGVhbikge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuYWxsb3dEZWNpbWFsID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgKHRoaXMubWFzay5zZXR0aW5ncyBhcyBhbnkpLnBhdHRlcm5PcHRpb25zLmFsbG93RGVjaW1hbCA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogV2hlbiB0cnVlLCBhbGxvd3MgbGVhZGluZyB6ZXJvcyBpbiBhIGZvcm1hdHRlZCBudW1iZXIuICovXG4gIEBJbnB1dCgpIHNldCBhbGxvd0xlYWRpbmdaZXJvcyh2YWx1ZTogYm9vbGVhbikge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuYWxsb3dMZWFkaW5nWmVyb3MgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuYWxsb3dMZWFkaW5nWmVyb3MgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFdoZW4gdHJ1ZSwgdGhlIG5lZ2F0aXZlIHN5bWJvbCBpcyBhbGxvd2VkIGluIGEgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IGFsbG93TmVnYXRpdmUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAodGhpcy5fb3B0aW9ucyBhcyBhbnkpLnBhdHRlcm5PcHRpb25zLmFsbG93TmVnYXRpdmUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuYWxsb3dOZWdhdGl2ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogV2hlbiB0cnVlLCBhZGRzIHRoZSB0aG91c2FuZHMgc2VwYXJhdG9yIHN5bWJvbCB0byB0aGUgY29ycmVjdCBsb2NhdGlvbiBpbiBhIGZvcm1hdHRlZCBudW1iZXIuICovXG4gIEBJbnB1dCgpIHNldCBhbGxvd1Rob3VzYW5kc1NlcGFyYXRvcih2YWx1ZTogYm9vbGVhbikge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuYWxsb3dUaG91c2FuZHNTZXBhcmF0b3IgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuYWxsb3dUaG91c2FuZHNTZXBhcmF0b3IgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBkaWdpdHMgdG8gdGhlIGxlZnQgb2YgdGhlIGRlY2ltYWwgc2VwYXJhdG9yIHN5bWJvbCBpbiBhIGZvcm1hdHRlZCBudW1iZXIuICovXG4gIEBJbnB1dCgpIHNldCBkZWNpbWFsTGltaXQodmFsdWU6IG51bWJlcikge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuZGVjaW1hbExpbWl0ID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgKHRoaXMubWFzayBhcyBhbnkpLnNldHRpbmdzLnBhdHRlcm5PcHRpb25zLmRlY2ltYWxMaW1pdCA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogVGhlIG1heGltdW0gbnVtYmVyIG9mIGRpZ2l0cyB0byB0aGUgcmlnaHQgb2YgZGVjaW1hbCBzZXBhcmF0b3Igc3ltYm9sIGluIGEgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IGludGVnZXJMaW1pdCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5pbnRlZ2VyTGltaXQgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuaW50ZWdlckxpbWl0ID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGUgY2hhcmFjdGVyIHRoYXQgcHJlY2VkZXMgdGhlIG1hc2tlZCB2YWx1ZS4gKi9cbiAgQElucHV0KCkgc2V0IHByZWZpeCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5wcmVmaXggPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMucHJlZml4ID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBXaGVuIHRydWUsIHRoZSBkZWNpbWFsIHNlcGFyYXRvciBzeW1ib2wgaXMgcmVxdWlyZWQgaW4gYSBmb3JtYXR0ZWQgbnVtYmVyLiAqL1xuICBASW5wdXQoKSBzZXQgcmVxdWlyZURlY2ltYWwodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAodGhpcy5fb3B0aW9ucyBhcyBhbnkpLnBhdHRlcm5PcHRpb25zLnJlcXVpcmVEZWNpbWFsID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgKHRoaXMubWFzayBhcyBhbnkpLnNldHRpbmdzLnBhdHRlcm5PcHRpb25zLnJlcXVpcmVEZWNpbWFsID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGUgY2hhcmFjdGVyIHRoYXQgZm9sbG93cyB0aGUgbWFza2VkIHZhbHVlLiAqL1xuICBASW5wdXQoKSBzZXQgc3VmZml4KHZhbHVlOiBzdHJpbmcpIHtcbiAgICAodGhpcy5fb3B0aW9ucyBhcyBhbnkpLnBhdHRlcm5PcHRpb25zLnN1ZmZpeCA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgICh0aGlzLm1hc2sgYXMgYW55KS5zZXR0aW5ncy5wYXR0ZXJuT3B0aW9ucy5zdWZmaXggPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBzeW1ib2xzIHRvIHVzZSBmb3IgdGhlIGZvcm1hdHRlZCBudW1iZXIuICovXG4gIEBJbnB1dCgpIHNldCBzeW1ib2xzKHZhbHVlOiBTb2hvTWFza1BhdHRlcm5TeW1ib2xzIHwgc3RyaW5nKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5zeW1ib2xzID0gKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpID8gSlNPTi5wYXJzZSh2YWx1ZSkgOiB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuc3ltYm9scyA9ICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuc3ltYm9scztcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBsb2NhbGUgdG8gdXNlIGZvciB0aGUgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IGxvY2FsZSh2YWx1ZTogc3RyaW5nKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5sb2NhbGUgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMubG9jYWxlID0gKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5sb2NhbGU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGUgY3VycmVuY3kgc3ltYm9sIHRvIHVzZSBmb3IgdGhlIGZvcm1hdHRlZCBudW1iZXIuICovXG4gIEBJbnB1dCgpIHNldCBjdXJyZW5jeVN5bWJvbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5zeW1ib2xzLmN1cnJlbmN5ID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgKHRoaXMubWFzayBhcyBhbnkpLnNldHRpbmdzLnBhdHRlcm5PcHRpb25zLnN5bWJvbHMuY3VycmVuY3kgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBkZWNpbWFsIHNlcGFyYXRvciBzeW1ib2wgdG8gdXNlIGZvciB0aGUgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IGRlY2ltYWxTeW1ib2wodmFsdWU6IHN0cmluZykge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuc3ltYm9scy5kZWNpbWFsID0gdmFsdWU7XG4gICAgaWYgKHRoaXMubWFzaykge1xuICAgICAgKHRoaXMubWFzayBhcyBhbnkpLnNldHRpbmdzLnBhdHRlcm5PcHRpb25zLnN5bWJvbHMuZGVjaW1hbCA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogVGhlIG5lZ2F0aXZlIHN5bWJvbCB0byB1c2UgZm9yIHRoZSBmb3JtYXR0ZWQgbnVtYmVyLiAqL1xuICBASW5wdXQoKSBzZXQgbmVnYXRpdmVTeW1ib2wodmFsdWU6IHN0cmluZykge1xuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuc3ltYm9scy5uZWdhdGl2ZSA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgICh0aGlzLm1hc2sgYXMgYW55KS5zZXR0aW5ncy5wYXR0ZXJuT3B0aW9ucy5zeW1ib2xzLm5lZ2F0aXZlID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGUgdGhvdXNhbmRzIHNlcGFyYXRvciBzeW1ib2wgdG8gdXNlIGZvciB0aGUgZm9ybWF0dGVkIG51bWJlci4gKi9cbiAgQElucHV0KCkgc2V0IHRob3VzYW5kc1N5bWJvbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgKHRoaXMuX29wdGlvbnMgYXMgYW55KS5wYXR0ZXJuT3B0aW9ucy5zeW1ib2xzLnRob3VzYW5kcyA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgICh0aGlzLm1hc2sgYXMgYW55KS5zZXR0aW5ncy5wYXR0ZXJuT3B0aW9ucy5zeW1ib2xzLnRob3VzYW5kcyA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXNrLnVwZGF0ZWQoKTtcbiAgICB9XG4gIH1cblxuICAvLyBkZXByZWNhdGVkIG1ldGhvZHNcbiAgLyoqXG4gICAqIEluZGljYXRlcyBpZiBlYWNoIHNlY3Rpb24gb2YgdGhlIGdyb3VwIHBhdHRlcm4gbWF0Y2ggbXVzdCBiZSBmdWxsIGluIG9yZGVyIGZvclxuICAgKiB0aGUgbGl0ZXJhbHMgaW4tYmV0d2VlbiBlYWNoIHNlY3Rpb24gdG8gYmUgYXV0b21hdGljYWxseSBhZGRlZCAobWVhbmluZyB5b3UgY2FuJ3RcbiAgICogdHlwZSBhIGxpdGVyYWwgdG8gZW5kIHRoYXQgZ3JvdXAgdW50aWwgYWxsIGNoYXJhY3RlcnMgaW4gdGhhdCBncm91cCBhcmUgZW50ZXJlZCkuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIG5vdCBzdXBwb3J0ZWRcbiAgICovXG4gIEBJbnB1dCgpIHNldCBncm91cENvbXBsZXRlKF92YWx1ZTogYm9vbGVhbikge1xuICAgIGNvbnNvbGUud2FybignVGhlIGdyb3VwQ29tcGxldGUgaW5wdXQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCwgcGxlYXNlIHJlbW92ZSB5b3VyIHVzYWdlLicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyBzcGVjaWFsIGZvcm1hdHRpbmcgcnVsZXMgbWF5IGFwcGx5IHRvIHRoZSBtYXNrLlxuICAgKlxuICAgKiBAZGVwcmVjYXRlZCB1c2UgcHJvY2VzcyBpbnN0ZWFkXG4gICAqL1xuICBASW5wdXQoKSBzZXQgbW9kZSh2YWx1ZTogU29ob01hc2tNb2RlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICBjb25zb2xlLndhcm4oJ1RoZSBtb2RlIGlucHV0IGhhcyBiZWVuIHJlbmFtZWQsIHBsZWFzZSB1c2UgdGhlIHByb2Nlc3MgaW5wdXQgaW5zdGVhZC4nKTtcblxuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucHJvY2VzcyA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgIHRoaXMubWFzay5zZXR0aW5ncy5wcm9jZXNzID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJbmRpY2F0ZXMgdG8gY29tcGxldGUgdGhlIGZ1bGwgbWFzayBvciB0aGUgbWFzayB3aWxsIHJldmVydCB0byBlbXB0eS5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWQgbm90IHN1cHBvcnRlZFxuICAgKi9cbiAgQElucHV0KCkgc2V0IG11c3RDb21wbGV0ZShfdmFsdWU6IGJvb2xlYW4pIHtcbiAgICBjb25zb2xlLndhcm4oJ1RoZSBtdXN0Q29tcGxldGUgaW5wdXQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCwgcGxlYXNlIHJlbW92ZSB5b3VyIHVzYWdlLicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyB5b3UgY2FuIGVudGVyIHRoZSBuZWdhdGl2ZSBzeW1ib2wgaW4gZnJvbnQgb2YgdGhlIG51bWJlcjtcbiAgICogYXV0b21hdGljYWxseSBzZXQgdG8gdHJ1ZSBpZiBhIG5lZ2F0aXZlIHN5bWJvbCBpcyBkZXRlY3RlZCBpbnNpZGUgdGhlIG1hc2suXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIHVzZSBhbGxvd05lZ2F0aXZlIGluc3RlYWRcbiAgICovXG4gIEBJbnB1dCgpIHNldCBuZWdhdGl2ZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIGNvbnNvbGUud2FybignVGhlIG5lZ2F0aXZlIGlucHV0IGhhcyBiZWVuIHJlbmFtZWQsIHBsZWFzZSB1c2UgdGhlIGFsbG93TmVnYXRpdmUgaW5wdXQgaW5zdGVhZC4nKTtcblxuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuYWxsb3dOZWdhdGl2ZSA9IHZhbHVlO1xuICAgIGlmICh0aGlzLm1hc2spIHtcbiAgICAgICh0aGlzLm1hc2sgYXMgYW55KS5zZXR0aW5ncy5wYXR0ZXJuT3B0aW9ucy5hbGxvd05lZ2F0aXZlID0gdmFsdWU7XG4gICAgICB0aGlzLm1hc2sudXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpb24gZGVmaW5lZCBpbiBjb250cm9sLCBidXQgbm90IHJlZmVyZW5jZWQuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICBASW5wdXQoKSBzZXQgbnVtYmVyKF92YWx1ZTogYm9vbGVhbikge1xuICAgIGNvbnNvbGUud2FybignVGhlIG51bWJlciBpbnB1dCBpcyBubyBsb25nZXIgc3VwcG9ydGVkLCBwbGVhc2UgcmVtb3ZlIHlvdXIgdXNhZ2UuJyk7XG4gIH1cblxuICAvKipcbiAgICogSW5kaWNhdGVzIHRoZSB0aG91c2FuZHMgc2VwYXJhdG9yIGZvciBudW1iZXJzIChiYXNlZCBvbiBsb2NhbGl6YXRpb24pIHdpbGwgYmVcbiAgICogaW5zZXJ0ZWQgd2hlcmV2ZXIgbmVjZXNzYXJ5IGR1cmluZyB0eXBpbmc7IGF1dG9tYXRpY2FsbHkgc2V0IHRvIHRydWUgaWYgdGhlXG4gICAqIGxvY2FsaXplZCB0aG91c2FuZHMgc2VwYXJhdG9yIGlzIGRldGVjdGVkIGluc2lkZSB0aGUgbWFzay5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWQgdXNlIGFsbG93VGhvdXNhbmRzU2VwYXJhdG9yIGluc3RlYWRcbiAgICovXG4gIEBJbnB1dCgpIHNldCB0aG91c2FuZHNTZXBhcmF0b3IodmFsdWU6IGJvb2xlYW4pIHtcbiAgICBjb25zb2xlLndhcm4oJ1RoZSB0aG91c2FuZHNTZXBhcmF0b3IgaW5wdXQgaGFzIGJlZW4gcmVuYW1lZCwgcGxlYXNlIHVzZSB0aGUgYWxsb3dUaG91c2FuZHNTZXBhcmF0b3IgaW5wdXQgaW5zdGVhZC4nKTtcblxuICAgICh0aGlzLl9vcHRpb25zIGFzIGFueSkucGF0dGVybk9wdGlvbnMuYWxsb3dUaG91c2FuZHNTZXBhcmF0b3IgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICAodGhpcy5tYXNrIGFzIGFueSkuc2V0dGluZ3MucGF0dGVybk9wdGlvbnMuYWxsb3dUaG91c2FuZHNTZXBhcmF0b3IgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFzay51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyB0byBkaXNwbGF5IHRoZSBsb2NhbGl6ZWQgc3ltYm9sIGZvciBjdXJyZW5jeSBvciBwZXJjZW50O1xuICAgKiBiYWNrd2FyZHMgY29tcGF0aWJsZSB3aXRoIG9sZCAnZGF0YS1zaG93LWN1cnJlbmN5JzsgdmFsdWUgdHJ1ZSBlcXVhdGVzIHRvIGN1cnJlbmN5XG4gICAqXG4gICAqIEBkZXByZWNhdGVkIHVzZSBwcmVmaXggb3Igc3VmZml4IGluc3RlYWRcbiAgICovXG4gIEBJbnB1dCgpIHNldCBzaG93U3ltYm9sKF92YWx1ZTogU29ob01hc2tTaG93U3ltYm9sKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICBjb25zb2xlLndhcm4oJ1RoZSBzaG93U3ltYm9sIGlucHV0IGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQsIHBsZWFzZSB1c2UgdGhlIHByZWZpeCBvciBzdWZmaXggaW5wdXQgaW5zdGVhZC4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBtYXNrIHZhbHVlIGNoYW5nZXNcbiAgICovXG4gIEBPdXRwdXQoKSB3cml0ZTogRXZlbnRFbWl0dGVyPFNvaG9NYXNrRXZlbnQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvTWFza0V2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBMb2NhbCB2YXJpYWJsZXNcbiAgICovXG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcbiAgcHJpdmF0ZSBtYXNrPzogU29ob01hc2tTdGF0aWMgfCBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZikge1xuICAgIHRoaXMuX3N5bWJvbHMgPSB7fTtcbiAgICB0aGlzLl9wYXR0ZXJuT3B0aW9ucyA9IHtcbiAgICAgIHN5bWJvbHM6IHRoaXMuX3N5bWJvbHNcbiAgICB9O1xuICAgIHRoaXMuX29wdGlvbnMgPSB7XG4gICAgICBwYXR0ZXJuT3B0aW9uczogdGhpcy5fcGF0dGVybk9wdGlvbnNcbiAgICB9O1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cbiAgICB0aGlzLmpRdWVyeUVsZW1lbnQubWFzayh0aGlzLl9vcHRpb25zKTtcblxuICAgIHRoaXMubWFzayA9IHRoaXMualF1ZXJ5RWxlbWVudC5kYXRhKCdtYXNrJyk7XG5cbiAgICAvKipcbiAgICAgKiBCaW5kIHRvIGpRdWVyeUVsZW1lbnQncyBldmVudHNcbiAgICAgKi9cbiAgICB0aGlzLmpRdWVyeUVsZW1lbnRcbiAgICAgIC5vbignd3JpdGUubWFzaycsIChldmVudDogU29ob01hc2tFdmVudCkgPT4ge1xuICAgICAgICB0aGlzLndyaXRlLmVtaXQoZXZlbnQpO1xuICAgICAgfSk7XG4gIH1cblxuICAvKiogRGVzdHJ1Y3Rvci4gKi9cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9mZigpO1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICB0aGlzLm1hc2suZGVzdHJveSgpO1xuICAgICAgdGhpcy5tYXNrID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cbiJdfQ==