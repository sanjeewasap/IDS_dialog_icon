import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Output, Self, Optional } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
export class SohoColorPickerComponent {
    /**
     * Indicates the color list
     */
    set colors(colors) {
        this.options.colors = colors;
        if (this.colorpicker) {
            this.colorpicker.settings.colors = colors;
            this.markForRefresh();
        }
    }
    /**
     * Enables or disables the control
     */
    set disabled(value) {
        this.isDisabled = value;
        this.options.disabled = value;
        if (this.colorpicker) {
            this.colorpicker.settings.disabled = value;
        }
        if (this.colorpicker) {
            if (value) {
                this.ngZone.runOutsideAngular(() => this.colorpicker.disable());
                this.isDisabled = true;
            }
            else {
                this.ngZone.runOutsideAngular(() => this.colorpicker.enable());
                this.isDisabled = false;
                this.isReadOnly = false;
            }
        }
    }
    get disabled() {
        return this.isDisabled;
    }
    /**
     * Enables or disables editing
     */
    set editable(value) {
        this.isEditable = value;
        this.options.editable = value;
        if (this.colorpicker) {
            this.colorpicker.settings.editable = value;
        }
        if (this.colorpicker) {
            if (value) {
                this.ngZone.runOutsideAngular(() => this.colorpicker.enable());
                this.isEditable = true;
            }
            else {
                this.ngZone.runOutsideAngular(() => this.colorpicker.readonly());
                this.isEditable = false;
            }
        }
    }
    get editable() {
        return this.isEditable;
    }
    /**
     * Enables or disables forces upper case hex.
     */
    set uppercase(value) {
        this.isUppercase = value;
        this.options.uppercase = value;
        if (this.colorpicker) {
            this.colorpicker.settings.uppercase = value;
            this.markForRefresh();
        }
    }
    /**
     * Enables or disables the clear option.
     */
    set clearable(value) {
        this.isClearable = value;
        this.options.clearable = value;
        if (this.colorpicker) {
            this.colorpicker.settings.clearable = value;
            this.markForRefresh();
        }
    }
    /**
     * Enables or disables the clear option.
     */
    set customColors(value) {
        this.hasCustomColor = value;
        this.options.customColors = value;
        if (this.colorpicker) {
            this.colorpicker.settings.customColors = value;
            this.markForRefresh();
        }
    }
    /**
     * Enables or disables the colorOnly option.
     */
    set colorOnly(value) {
        this.isColorOnly = value;
        this.options.colorOnly = value;
        if (this.colorpicker) {
            this.colorpicker.settings.colorOnly = value;
            this.markForRefresh();
        }
    }
    /**
     * Sets the clearableText option.
     */
    set clearableText(value) {
        this.clearableTextString = value;
        this.options.clearableText = value;
        if (this.colorpicker) {
            this.colorpicker.settings.clearableText = value;
            this.markForRefresh();
        }
    }
    /**
     * Add extra attributes like id's to the component
     */
    set attributes(value) {
        this.options.attributes = value;
        if (this.colorpicker) {
            this.colorpicker.settings.attributes = value;
            this.markForRefresh();
        }
    }
    /**
     * Sets the control to readonly
     */
    set readonly(value) {
        this.isReadOnly = value;
        // 4.3.1 did not have this method in time add a safety check it works for future versions
        if (this.colorpicker && this.colorpicker.readonly) {
            if (value) {
                this.ngZone.runOutsideAngular(() => this.colorpicker.readonly());
                this.isReadOnly = true;
            }
            else {
                this.ngZone.runOutsideAngular(() => this.colorpicker.enable());
                this.isDisabled = false;
                this.isReadOnly = false;
            }
        }
    }
    get readonly() {
        return this.isReadOnly;
    }
    /**
     * Sets the control to show color label
     */
    set showLabel(value) {
        this.isShowLabel = value;
        this.options.showLabel = value;
        if (this.colorpicker) {
            this.colorpicker.settings.showLabel = value;
            this.markForRefresh();
        }
    }
    get showLabel() {
        return this.isShowLabel;
    }
    /**
     * Public API
     */
    getLabelValue() {
        return this.colorpicker.getLabelValue();
    }
    getHexValue() {
        return this.colorpicker.getHexValue();
    }
    /**
     * Bind attributes to the host input element
     */
    get isColorpicker() {
        return true;
    }
    /**
     * Creates an instance of SohoColorPickerComponent.
     *
     * @param element the element this component encapsulates.
     * @param ngZone the angualar zone for this component
     * @param ngControl any associated form control (optional)
     *
     */
    constructor(element, ngZone, ngControl, ref) {
        this.element = element;
        this.ngZone = ngZone;
        this.ngControl = ngControl;
        this.ref = ref;
        this.isEditable = undefined;
        this.isUppercase = undefined;
        this.isClearable = undefined;
        this.isDisabled = undefined;
        this.isReadOnly = undefined;
        this.isShowLabel = undefined;
        this.isColorOnly = undefined;
        this.hasCustomColor = undefined;
        this.clearableTextString = '';
        this.options = {
            showLabel: false,
            editable: true,
            uppercase: true,
            colorOnly: false,
            clearable: true,
            customColors: false,
            disabled: false
        };
        /**
         * Called when the colorpicker value changes
         *
         * @todo replace override of native attribute
         */
        // eslint-disable-next-line @angular-eslint/no-output-native, @angular-eslint/no-output-rename
        this.change = new EventEmitter();
        /**
         * Called when the colorpicker updates in some way.
         */
        this.updatedEvent = new EventEmitter();
        // Is the control using a form control and/or ngModel?
        if (this.ngControl) {
            // Wrap the accessor to allow updates to be pushed,
            // but also use the standard accessors provided by angular.
            this.valueAccessor =
                new SohoColorPickerComponentValueAccessorDelegator(// teslint-disable-line
                this.ngControl.valueAccessor, this); // eslint-disable-line
            // ... change the accessor on the control to use ours.
            this.ngControl.valueAccessor = this.valueAccessor;
        }
    }
    ngAfterViewInit() {
        // call outside the angular zone so change detection
        // isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            // assign element to local variable
            this.jQueryElement = jQuery(this.element.nativeElement);
            // initialise the colorpicker control
            this.jQueryElement.colorpicker(this.options);
            // extract the api
            this.colorpicker = this.jQueryElement.data('colorpicker');
            // Add event binding
            this.jQueryElement
                .on('change', (event) => this.onChanged(event));
            this.runUpdatedOnCheck = true;
        });
    }
    ngAfterViewChecked() {
        if (this.runUpdatedOnCheck) {
            this.ngZone.runOutsideAngular(() => {
                // this.disabled = this.isDisabled;
                // We need to update the control AFTER the model
                // has been updated (assuming there is one), so
                // execute updated after angular has generated
                // the model and the view markup.
                setTimeout(() => this.updated());
                this.runUpdatedOnCheck = false;
            });
        }
    }
    /**
     * Event handler for the 'changed' event on the 'colorpicker' component.
     *
     *
     * @param event the standard jQuery event.
     */
    onChanged(event) {
        // Retrieve the value from the 'colorpicker' component.
        const internalValue = this.colorpicker.element.val();
        // Make sure calls to angular are made in the right zone.
        this.ngZone.run(() => {
            // ... update the model (which will fire change
            // detection if required).
            this.colorpicker.setColor(internalValue);
            this.valueAccessor.onChangeFn(internalValue);
            this.change.emit(event);
        });
    }
    /**
     * In case options are being bound asynchronously, you will need to trigger updated on
     * soho colorpicker control so it updates its value labels.
     */
    updated() {
        if (this.colorpicker) {
            // Calling updated when an item is selected, looses the selection!
            this.ngZone.runOutsideAngular(() => this.colorpicker.updated());
        }
        return this;
    }
    onUpdated(event) {
        // Fire the event, in the angular zone.
        this.ngZone.run(() => this.updatedEvent.next(event));
    }
    /**
     * This function is called when the control status changes to or from "DISABLED".
     * Depending on the value, it will enable or disable the appropriate DOM element.
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    ngOnDestroy() {
        if (this.colorpicker) {
            this.colorpicker.destroy();
            this.colorpicker = null;
        }
    }
    /**
     * Marks the components as requiring a rebuild after the next update.
     */
    markForRefresh() {
        // Run updated on the next updated check.
        this.runUpdatedOnCheck = true;
        // ... make sure the change detector kicks in, otherwise if the inputs
        // were change programmatially the component may not be eligible for
        // updating.
        this.ref.markForCheck();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoColorPickerComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }, { token: i1.NgControl, optional: true, self: true }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoColorPickerComponent, selector: "input[soho-colorpicker]", inputs: { colors: "colors", disabled: "disabled", editable: "editable", uppercase: "uppercase", clearable: "clearable", customColors: "customColors", colorOnly: "colorOnly", clearableText: "clearableText", attributes: "attributes", readonly: "readonly", showLabel: "showLabel" }, outputs: { change: "change", updatedEvent: "updated" }, host: { properties: { "class.colorpicker": "this.isColorpicker" } }, ngImport: i0, template: '<ng-content></ng-content>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoColorPickerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'input[soho-colorpicker]',
                    template: '<ng-content></ng-content>',
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }, { type: i1.NgControl, decorators: [{
                    type: Self
                }, {
                    type: Optional
                }] }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { colors: [{
                type: Input
            }], disabled: [{
                type: Input
            }], editable: [{
                type: Input
            }], uppercase: [{
                type: Input
            }], clearable: [{
                type: Input
            }], customColors: [{
                type: Input
            }], colorOnly: [{
                type: Input
            }], clearableText: [{
                type: Input
            }], attributes: [{
                type: Input
            }], readonly: [{
                type: Input
            }], showLabel: [{
                type: Input
            }], change: [{
                type: Output
            }], updatedEvent: [{
                type: Output,
                args: ['updated']
            }], isColorpicker: [{
                type: HostBinding,
                args: ['class.colorpicker']
            }] } });
/**
 * Provides a 'wrapper' around the {ControlValueAccessor} added by
 * angular when handling changing color.s
 *
 * This class allows the {SohoColorPickerComponent} to interoperate with
 * the {ControlValueAccessor}.  Specifically, providing access to the
 * onChange function, which we must call when the value of the colorpicker
 * is modified.
 */
class SohoColorPickerComponentValueAccessorDelegator {
    /**
     * Creates an instance of SohoColorPickerComponentValueAccessorDelegate.
     *
     * @param delegate the value accessor
     * @param colorpicker the colorpicker linked to the accessor
     */
    constructor(delegate, colorpicker) {
        this.delegate = delegate;
        this.colorpicker = colorpicker;
    }
    writeValue(value) {
        // Just pass it on.
        this.delegate.writeValue(value);
        this.colorpicker.markForRefresh();
    }
    registerOnChange(fn) {
        // Keep a reference to the change function, then we an call it.
        this.onChangeFn = fn;
        // Give the delegate a chance to store this too.
        this.delegate.registerOnChange(fn);
    }
    registerOnTouched(fn) {
        this.delegate.registerOnTouched(fn);
    }
    setDisabledState(isDisabled) {
        this.delegate.setDisabledState(isDisabled);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1jb2xvcnBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZHMtZW50ZXJwcmlzZS1uZy9zcmMvbGliL2NvbG9ycGlja2VyL3NvaG8tY29sb3JwaWNrZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUVULFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUVMLE1BQU0sRUFFTixJQUFJLEVBQ0osUUFBUSxFQUVULE1BQU0sZUFBZSxDQUFDOzs7QUFXdkIsTUFBTSxPQUFPLHdCQUF3QjtJQWtDbkM7O09BRUc7SUFDSCxJQUFhLE1BQU0sQ0FBQyxNQUEwQztRQUMzRCxJQUFJLENBQUMsT0FBZSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFFdEMsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3BCLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDMUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3ZCO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsSUFBYSxRQUFRLENBQUMsS0FBMEI7UUFDOUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFDdkIsSUFBSSxDQUFDLE9BQWUsQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDO1FBRXZDLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDO1NBQzVDO1FBRUQsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3BCLElBQUksS0FBSyxFQUFFO2dCQUNULElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUs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K0Q7UUFDL0QsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7UUFFckIsZ0RBQWdEO1FBQ2hELElBQUksQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELGlCQUFpQixDQUFDLEVBQU87UUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRUQsZ0JBQWdCLENBQUUsVUFBbUI7UUFDbEMsSUFBSSxDQUFDLFFBQWdCLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDdEQsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3Q2hlY2tlZCxcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBIb3N0QmluZGluZyxcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0LFxuICBOZ1pvbmUsXG4gIFNlbGYsXG4gIE9wdGlvbmFsLFxuICBDaGFuZ2VEZXRlY3RvclJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIE5nQ29udHJvbCxcbiAgQ29udHJvbFZhbHVlQWNjZXNzb3Jcbn0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdpbnB1dFtzb2hvLWNvbG9ycGlja2VyXScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6ICc8bmctY29udGVudD48L25nLWNvbnRlbnQ+JyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgU29ob0NvbG9yUGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95IHtcblxuICAvKipcbiAgICogRmxhZyB0byBmb3JjZSBhbiB1cGRhdGUgb2YgdGhlIGNvbnRyb2wgYWZ0ZXIgdGhlIHZpZXcgaXMgY3JlYXRlZC5cbiAgICovXG4gIHByaXZhdGUgcnVuVXBkYXRlZE9uQ2hlY2s/OiBib29sZWFuO1xuXG4gIC8qKiBWYWx1ZSBBY2Nlc3NvciAqL1xuICBwcml2YXRlIHZhbHVlQWNjZXNzb3I/OiBTb2hvQ29sb3JQaWNrZXJDb21wb25lbnRWYWx1ZUFjY2Vzc29yRGVsZWdhdG9yO1xuXG4gIC8qKlxuICAgKiBMb2NhbCB2YXJpYWJsZXNcbiAgICovXG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudDogYW55O1xuICBwcml2YXRlIGNvbG9ycGlja2VyOiBhbnk7XG4gIHByaXZhdGUgaXNFZGl0YWJsZT86IGJvb2xlYW4gPSB1bmRlZmluZWQ7XG4gIGlzVXBwZXJjYXNlPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgaXNDbGVhcmFibGU/OiBib29sZWFuID0gdW5kZWZpbmVkO1xuICBwcml2YXRlIGlzRGlzYWJsZWQ/OiBib29sZWFuID0gdW5kZWZpbmVkO1xuICBwcml2YXRlIGlzUmVhZE9ubHk/OiBib29sZWFuID0gdW5kZWZpbmVkO1xuICBwcml2YXRlIGlzU2hvd0xhYmVsPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgaXNDb2xvck9ubHk/OiBib29sZWFuID0gdW5kZWZpbmVkO1xuICBoYXNDdXN0b21Db2xvcj86IGJvb2xlYW4gPSB1bmRlZmluZWQ7XG4gIGNsZWFyYWJsZVRleHRTdHJpbmcgPSAnJztcbiAgcHJpdmF0ZSBvcHRpb25zPzogU29ob0NvbG9yUGlja2VyT3B0aW9ucyA9IHtcbiAgICBzaG93TGFiZWw6IGZhbHNlLFxuICAgIGVkaXRhYmxlOiB0cnVlLFxuICAgIHVwcGVyY2FzZTogdHJ1ZSxcbiAgICBjb2xvck9ubHk6IGZhbHNlLFxuICAgIGNsZWFyYWJsZTogdHJ1ZSxcbiAgICBjdXN0b21Db2xvcnM6IGZhbHNlLFxuICAgIGRpc2FibGVkOiBmYWxzZVxuICB9O1xuXG4gIC8qKlxuICAgKiBJbmRpY2F0ZXMgdGhlIGNvbG9yIGxpc3RcbiAgICovXG4gIEBJbnB1dCgpIHNldCBjb2xvcnMoY29sb3JzOiBBcnJheTxTb2hvQ29sb3JPcHRpb24+IHwgdW5kZWZpbmVkKSB7XG4gICAgKHRoaXMub3B0aW9ucyBhcyBhbnkpLmNvbG9ycyA9IGNvbG9ycztcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLmNvbG9ycyA9IGNvbG9ycztcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgY29udHJvbFxuICAgKi9cbiAgQElucHV0KCkgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5pc0Rpc2FibGVkID0gdmFsdWU7XG4gICAgKHRoaXMub3B0aW9ucyBhcyBhbnkpLmRpc2FibGVkID0gdmFsdWU7XG5cbiAgICBpZiAodGhpcy5jb2xvcnBpY2tlcikge1xuICAgICAgdGhpcy5jb2xvcnBpY2tlci5zZXR0aW5ncy5kaXNhYmxlZCA9IHZhbHVlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb2xvcnBpY2tlci5kaXNhYmxlKCkpO1xuICAgICAgICB0aGlzLmlzRGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb2xvcnBpY2tlci5lbmFibGUoKSk7XG4gICAgICAgIHRoaXMuaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmVhZE9ubHkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXQgZGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNEaXNhYmxlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGVzIG9yIGRpc2FibGVzIGVkaXRpbmdcbiAgICovXG4gIEBJbnB1dCgpIHNldCBlZGl0YWJsZSh2YWx1ZTogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuaXNFZGl0YWJsZSA9IHZhbHVlO1xuICAgICh0aGlzLm9wdGlvbnMgYXMgYW55KS5lZGl0YWJsZSA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMuY29sb3JwaWNrZXIpIHtcbiAgICAgIHRoaXMuY29sb3JwaWNrZXIuc2V0dGluZ3MuZWRpdGFibGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb2xvcnBpY2tlcikge1xuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuY29sb3JwaWNrZXIuZW5hYmxlKCkpO1xuICAgICAgICB0aGlzLmlzRWRpdGFibGUgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb2xvcnBpY2tlci5yZWFkb25seSgpKTtcbiAgICAgICAgdGhpcy5pc0VkaXRhYmxlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVkaXRhYmxlKCkge1xuICAgIHJldHVybiB0aGlzLmlzRWRpdGFibGU7XG4gIH1cblxuICAvKipcbiAgICogRW5hYmxlcyBvciBkaXNhYmxlcyBmb3JjZXMgdXBwZXIgY2FzZSBoZXguXG4gICAqL1xuICBASW5wdXQoKSBzZXQgdXBwZXJjYXNlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5pc1VwcGVyY2FzZSA9IHZhbHVlO1xuICAgICh0aGlzLm9wdGlvbnMgYXMgYW55KS51cHBlcmNhc2UgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLnVwcGVyY2FzZSA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGVzIG9yIGRpc2FibGVzIHRoZSBjbGVhciBvcHRpb24uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgY2xlYXJhYmxlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5pc0NsZWFyYWJsZSA9IHZhbHVlO1xuICAgICh0aGlzLm9wdGlvbnMgYXMgYW55KS5jbGVhcmFibGUgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLmNsZWFyYWJsZSA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGVzIG9yIGRpc2FibGVzIHRoZSBjbGVhciBvcHRpb24uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgY3VzdG9tQ29sb3JzKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5oYXNDdXN0b21Db2xvciA9IHZhbHVlO1xuICAgICh0aGlzLm9wdGlvbnMgYXMgYW55KS5jdXN0b21Db2xvcnMgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLmN1c3RvbUNvbG9ycyA9IHZhbHVlO1xuICAgICAgdGhpcy5tYXJrRm9yUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGVzIG9yIGRpc2FibGVzIHRoZSBjb2xvck9ubHkgb3B0aW9uLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGNvbG9yT25seSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuaXNDb2xvck9ubHkgPSB2YWx1ZTtcbiAgICAodGhpcy5vcHRpb25zIGFzIGFueSkuY29sb3JPbmx5ID0gdmFsdWU7XG5cbiAgICBpZiAodGhpcy5jb2xvcnBpY2tlcikge1xuICAgICAgdGhpcy5jb2xvcnBpY2tlci5zZXR0aW5ncy5jb2xvck9ubHkgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgY2xlYXJhYmxlVGV4dCBvcHRpb24uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgY2xlYXJhYmxlVGV4dCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5jbGVhcmFibGVUZXh0U3RyaW5nID0gdmFsdWU7XG4gICAgKHRoaXMub3B0aW9ucyBhcyBhbnkpLmNsZWFyYWJsZVRleHQgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLmNsZWFyYWJsZVRleHQgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGV4dHJhIGF0dHJpYnV0ZXMgbGlrZSBpZCdzIHRvIHRoZSBjb21wb25lbnRcbiAgICovXG4gIEBJbnB1dCgpIHNldCBhdHRyaWJ1dGVzKHZhbHVlOiBBcnJheTxPYmplY3Q+IHwgT2JqZWN0KSB7XG4gICAgKHRoaXMub3B0aW9ucyBhcyBhbnkpLmF0dHJpYnV0ZXMgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyKSB7XG4gICAgICB0aGlzLmNvbG9ycGlja2VyLnNldHRpbmdzLmF0dHJpYnV0ZXMgPSB2YWx1ZTtcbiAgICAgIHRoaXMubWFya0ZvclJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgY29udHJvbCB0byByZWFkb25seVxuICAgKi9cbiAgQElucHV0KCkgc2V0IHJlYWRvbmx5KHZhbHVlOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5pc1JlYWRPbmx5ID0gdmFsdWU7XG5cbiAgICAvLyA0LjMuMSBkaWQgbm90IGhhdmUgdGhpcyBtZXRob2QgaW4gdGltZSBhZGQgYSBzYWZldHkgY2hlY2sgaXQgd29ya3MgZm9yIGZ1dHVyZSB2ZXJzaW9uc1xuICAgIGlmICh0aGlzLmNvbG9ycGlja2VyICYmIHRoaXMuY29sb3JwaWNrZXIucmVhZG9ubHkpIHtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLmNvbG9ycGlja2VyLnJlYWRvbmx5KCkpO1xuICAgICAgICB0aGlzLmlzUmVhZE9ubHkgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb2xvcnBpY2tlci5lbmFibGUoKSk7XG4gICAgICAgIHRoaXMuaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmVhZE9ubHkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXQgcmVhZG9ubHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNSZWFkT25seTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBjb250cm9sIHRvIHNob3cgY29sb3IgbGFiZWxcbiAgICovXG4gIEBJbnB1dCgpIHNldCBzaG93TGFiZWwodmFsdWU6IGJvb2xlYW4gfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLmlzU2hvd0xhYmVsID0gdmFsdWU7XG4gICAgKHRoaXMub3B0aW9ucyBhcyBhbnkpLnNob3dMYWJlbCA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMuY29sb3JwaWNrZXIpIHtcbiAgICAgIHRoaXMuY29sb3JwaWNrZXIuc2V0dGluZ3Muc2hvd0xhYmVsID0gdmFsdWU7XG4gICAgICB0aGlzLm1hcmtGb3JSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNob3dMYWJlbCgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1Nob3dMYWJlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgY29sb3JwaWNrZXIgdmFsdWUgY2hhbmdlc1xuICAgKlxuICAgKiBAdG9kbyByZXBsYWNlIG92ZXJyaWRlIG9mIG5hdGl2ZSBhdHRyaWJ1dGVcbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8tb3V0cHV0LW5hdGl2ZSwgQGFuZ3VsYXItZXNsaW50L25vLW91dHB1dC1yZW5hbWVcbiAgQE91dHB1dCgpIGNoYW5nZTogRXZlbnRFbWl0dGVyPFNvaG9Db2xvclBpY2tlckV2ZW50PiA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob0NvbG9yUGlja2VyRXZlbnQ+KCk7XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoZSBjb2xvcnBpY2tlciB1cGRhdGVzIGluIHNvbWUgd2F5LlxuICAgKi9cbiAgQE91dHB1dCgndXBkYXRlZCcpICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHVwZGF0ZWRFdmVudDogRXZlbnRFbWl0dGVyPEpRdWVyeS5UcmlnZ2VyZWRFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPEpRdWVyeS5UcmlnZ2VyZWRFdmVudD4oKTtcblxuICAvKipcbiAgICogUHVibGljIEFQSVxuICAgKi9cbiAgZ2V0TGFiZWxWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jb2xvcnBpY2tlci5nZXRMYWJlbFZhbHVlKCk7XG4gIH1cbiAgZ2V0SGV4VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sb3JwaWNrZXIuZ2V0SGV4VmFsdWUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCaW5kIGF0dHJpYnV0ZXMgdG8gdGhlIGhvc3QgaW5wdXQgZWxlbWVudFxuICAgKi9cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5jb2xvcnBpY2tlcicpIGdldCBpc0NvbG9ycGlja2VyKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgU29ob0NvbG9yUGlja2VyQ29tcG9uZW50LlxuICAgKlxuICAgKiBAcGFyYW0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGlzIGNvbXBvbmVudCBlbmNhcHN1bGF0ZXMuXG4gICAqIEBwYXJhbSBuZ1pvbmUgdGhlIGFuZ3VhbGFyIHpvbmUgZm9yIHRoaXMgY29tcG9uZW50XG4gICAqIEBwYXJhbSBuZ0NvbnRyb2wgYW55IGFzc29jaWF0ZWQgZm9ybSBjb250cm9sIChvcHRpb25hbClcbiAgICpcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxuICAgIEBTZWxmKCkgQE9wdGlvbmFsKCkgcHVibGljIG5nQ29udHJvbDogTmdDb250cm9sLFxuICAgIHB1YmxpYyByZWY6IENoYW5nZURldGVjdG9yUmVmKSB7XG5cbiAgICAvLyBJcyB0aGUgY29udHJvbCB1c2luZyBhIGZvcm0gY29udHJvbCBhbmQvb3IgbmdNb2RlbD9cbiAgICBpZiAodGhpcy5uZ0NvbnRyb2wpIHtcbiAgICAgIC8vIFdyYXAgdGhlIGFjY2Vzc29yIHRvIGFsbG93IHVwZGF0ZXMgdG8gYmUgcHVzaGVkLFxuICAgICAgLy8gYnV0IGFsc28gdXNlIHRoZSBzdGFuZGFyZCBhY2Nlc3NvcnMgcHJvdmlkZWQgYnkgYW5ndWxhci5cbiAgICAgIHRoaXMudmFsdWVBY2Nlc3NvciA9XG4gICAgICAgIG5ldyBTb2hvQ29sb3JQaWNrZXJDb21wb25lbnRWYWx1ZUFjY2Vzc29yRGVsZWdhdG9yKCAvLyB0ZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICAgICh0aGlzLm5nQ29udHJvbC52YWx1ZUFjY2Vzc29yIGFzIGFueSksIHRoaXMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgICAgIC8vIC4uLiBjaGFuZ2UgdGhlIGFjY2Vzc29yIG9uIHRoZSBjb250cm9sIHRvIHVzZSBvdXJzLlxuICAgICAgdGhpcy5uZ0NvbnRyb2wudmFsdWVBY2Nlc3NvciA9IHRoaXMudmFsdWVBY2Nlc3NvcjtcbiAgICB9XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvblxuICAgIC8vIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgLy8gYXNzaWduIGVsZW1lbnQgdG8gbG9jYWwgdmFyaWFibGVcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIC8vIGluaXRpYWxpc2UgdGhlIGNvbG9ycGlja2VyIGNvbnRyb2xcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5jb2xvcnBpY2tlcih0aGlzLm9wdGlvbnMpO1xuXG4gICAgICAvLyBleHRyYWN0IHRoZSBhcGlcbiAgICAgIHRoaXMuY29sb3JwaWNrZXIgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnY29sb3JwaWNrZXInKTtcblxuICAgICAgLy8gQWRkIGV2ZW50IGJpbmRpbmdcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudFxuICAgICAgICAub24oJ2NoYW5nZScsIChldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KSA9PiB0aGlzLm9uQ2hhbmdlZChldmVudCkpO1xuXG4gICAgICB0aGlzLnJ1blVwZGF0ZWRPbkNoZWNrID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICBpZiAodGhpcy5ydW5VcGRhdGVkT25DaGVjaykge1xuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuXG4gICAgICAgIC8vIHRoaXMuZGlzYWJsZWQgPSB0aGlzLmlzRGlzYWJsZWQ7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gdXBkYXRlIHRoZSBjb250cm9sIEFGVEVSIHRoZSBtb2RlbFxuICAgICAgICAvLyBoYXMgYmVlbiB1cGRhdGVkIChhc3N1bWluZyB0aGVyZSBpcyBvbmUpLCBzb1xuICAgICAgICAvLyBleGVjdXRlIHVwZGF0ZWQgYWZ0ZXIgYW5ndWxhciBoYXMgZ2VuZXJhdGVkXG4gICAgICAgIC8vIHRoZSBtb2RlbCBhbmQgdGhlIHZpZXcgbWFya3VwLlxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMudXBkYXRlZCgpKTtcbiAgICAgICAgdGhpcy5ydW5VcGRhdGVkT25DaGVjayA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV2ZW50IGhhbmRsZXIgZm9yIHRoZSAnY2hhbmdlZCcgZXZlbnQgb24gdGhlICdjb2xvcnBpY2tlcicgY29tcG9uZW50LlxuICAgKlxuICAgKlxuICAgKiBAcGFyYW0gZXZlbnQgdGhlIHN0YW5kYXJkIGpRdWVyeSBldmVudC5cbiAgICovXG4gIHByaXZhdGUgb25DaGFuZ2VkKGV2ZW50OiBhbnkpIHtcbiAgICAvLyBSZXRyaWV2ZSB0aGUgdmFsdWUgZnJvbSB0aGUgJ2NvbG9ycGlja2VyJyBjb21wb25lbnQuXG4gICAgY29uc3QgaW50ZXJuYWxWYWx1ZSA9IHRoaXMuY29sb3JwaWNrZXIuZWxlbWVudC52YWwoKTtcblxuICAgIC8vIE1ha2Ugc3VyZSBjYWxscyB0byBhbmd1bGFyIGFyZSBtYWRlIGluIHRoZSByaWdodCB6b25lLlxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICAvLyAuLi4gdXBkYXRlIHRoZSBtb2RlbCAod2hpY2ggd2lsbCBmaXJlIGNoYW5nZVxuICAgICAgLy8gZGV0ZWN0aW9uIGlmIHJlcXVpcmVkKS5cbiAgICAgIHRoaXMuY29sb3JwaWNrZXIuc2V0Q29sb3IoaW50ZXJuYWxWYWx1ZSk7XG4gICAgICAodGhpcy52YWx1ZUFjY2Vzc29yIGFzIGFueSkub25DaGFuZ2VGbihpbnRlcm5hbFZhbHVlKTtcblxuICAgICAgdGhpcy5jaGFuZ2UuZW1pdChldmVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogSW4gY2FzZSBvcHRpb25zIGFyZSBiZWluZyBib3VuZCBhc3luY2hyb25vdXNseSwgeW91IHdpbGwgbmVlZCB0byB0cmlnZ2VyIHVwZGF0ZWQgb25cbiAgICogc29obyBjb2xvcnBpY2tlciBjb250cm9sIHNvIGl0IHVwZGF0ZXMgaXRzIHZhbHVlIGxhYmVscy5cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVkKCk6IFNvaG9Db2xvclBpY2tlckNvbXBvbmVudCB7XG4gICAgaWYgKHRoaXMuY29sb3JwaWNrZXIpIHtcbiAgICAgIC8vIENhbGxpbmcgdXBkYXRlZCB3aGVuIGFuIGl0ZW0gaXMgc2VsZWN0ZWQsIGxvb3NlcyB0aGUgc2VsZWN0aW9uIVxuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb2xvcnBpY2tlci51cGRhdGVkKCkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIG9uVXBkYXRlZChldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KSB7XG4gICAgLy8gRmlyZSB0aGUgZXZlbnQsIGluIHRoZSBhbmd1bGFyIHpvbmUuXG4gICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMudXBkYXRlZEV2ZW50Lm5leHQoZXZlbnQpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSBjb250cm9sIHN0YXR1cyBjaGFuZ2VzIHRvIG9yIGZyb20gXCJESVNBQkxFRFwiLlxuICAgKiBEZXBlbmRpbmcgb24gdGhlIHZhbHVlLCBpdCB3aWxsIGVuYWJsZSBvciBkaXNhYmxlIHRoZSBhcHByb3ByaWF0ZSBET00gZWxlbWVudC5cbiAgICovXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuY29sb3JwaWNrZXIpIHtcbiAgICAgIHRoaXMuY29sb3JwaWNrZXIuZGVzdHJveSgpO1xuICAgICAgdGhpcy5jb2xvcnBpY2tlciA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1hcmtzIHRoZSBjb21wb25lbnRzIGFzIHJlcXVpcmluZyBhIHJlYnVpbGQgYWZ0ZXIgdGhlIG5leHQgdXBkYXRlLlxuICAgKi9cbiAgbWFya0ZvclJlZnJlc2goKSB7XG4gICAgLy8gUnVuIHVwZGF0ZWQgb24gdGhlIG5leHQgdXBkYXRlZCBjaGVjay5cbiAgICB0aGlzLnJ1blVwZGF0ZWRPbkNoZWNrID0gdHJ1ZTtcblxuICAgIC8vIC4uLiBtYWtlIHN1cmUgdGhlIGNoYW5nZSBkZXRlY3RvciBraWNrcyBpbiwgb3RoZXJ3aXNlIGlmIHRoZSBpbnB1dHNcbiAgICAvLyB3ZXJlIGNoYW5nZSBwcm9ncmFtbWF0aWFsbHkgdGhlIGNvbXBvbmVudCBtYXkgbm90IGJlIGVsaWdpYmxlIGZvclxuICAgIC8vIHVwZGF0aW5nLlxuICAgIHRoaXMucmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG59XG5cbi8qKlxuICogUHJvdmlkZXMgYSAnd3JhcHBlcicgYXJvdW5kIHRoZSB7Q29udHJvbFZhbHVlQWNjZXNzb3J9IGFkZGVkIGJ5XG4gKiBhbmd1bGFyIHdoZW4gaGFuZGxpbmcgY2hhbmdpbmcgY29sb3Iuc1xuICpcbiAqIFRoaXMgY2xhc3MgYWxsb3dzIHRoZSB7U29ob0NvbG9yUGlja2VyQ29tcG9uZW50fSB0byBpbnRlcm9wZXJhdGUgd2l0aFxuICogdGhlIHtDb250cm9sVmFsdWVBY2Nlc3Nvcn0uICBTcGVjaWZpY2FsbHksIHByb3ZpZGluZyBhY2Nlc3MgdG8gdGhlXG4gKiBvbkNoYW5nZSBmdW5jdGlvbiwgd2hpY2ggd2UgbXVzdCBjYWxsIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSBjb2xvcnBpY2tlclxuICogaXMgbW9kaWZpZWQuXG4gKi9cbmNsYXNzIFNvaG9Db2xvclBpY2tlckNvbXBvbmVudFZhbHVlQWNjZXNzb3JEZWxlZ2F0b3IgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciB7XG4gIC8qKlxuICAgKiBUaGUgRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSB2YWx1ZSBvZiB0aGUgY29udHJvbCBjaGFuZ2VzLlxuICAgKi9cbiAgcHVibGljIG9uQ2hhbmdlRm4/OiBGdW5jdGlvbjtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBTb2hvQ29sb3JQaWNrZXJDb21wb25lbnRWYWx1ZUFjY2Vzc29yRGVsZWdhdGUuXG4gICAqXG4gICAqIEBwYXJhbSBkZWxlZ2F0ZSB0aGUgdmFsdWUgYWNjZXNzb3JcbiAgICogQHBhcmFtIGNvbG9ycGlja2VyIHRoZSBjb2xvcnBpY2tlciBsaW5rZWQgdG8gdGhlIGFjY2Vzc29yXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRlbGVnYXRlOiBDb250cm9sVmFsdWVBY2Nlc3NvcixcbiAgICBwcml2YXRlIGNvbG9ycGlja2VyOiBTb2hvQ29sb3JQaWNrZXJDb21wb25lbnQpIHsgfVxuXG4gIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIC8vIEp1c3QgcGFzcyBpdCBvbi5cbiAgICB0aGlzLmRlbGVnYXRlLndyaXRlVmFsdWUodmFsdWUpO1xuICAgIHRoaXMuY29sb3JwaWNrZXIubWFya0ZvclJlZnJlc2goKTtcbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xuICAgIC8vIEtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIGNoYW5nZSBmdW5jdGlvbiwgdGhlbiB3ZSBhbiBjYWxsIGl0LlxuICAgIHRoaXMub25DaGFuZ2VGbiA9IGZuO1xuXG4gICAgLy8gR2l2ZSB0aGUgZGVsZWdhdGUgYSBjaGFuY2UgdG8gc3RvcmUgdGhpcyB0b28uXG4gICAgdGhpcy5kZWxlZ2F0ZS5yZWdpc3Rlck9uQ2hhbmdlKGZuKTtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLmRlbGVnYXRlLnJlZ2lzdGVyT25Ub3VjaGVkKGZuKTtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGU/KGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAodGhpcy5kZWxlZ2F0ZSBhcyBhbnkpLnNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZCk7XG4gIH1cbn1cbiJdfQ==