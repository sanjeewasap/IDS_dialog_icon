/* eslint-disable @angular-eslint/no-input-rename */
import { ChangeDetectionStrategy, Component, HostBinding, Input } from "@angular/core";
import * as i0 from "@angular/core";
export class SohoStepChartComponent {
    get isStepChart() {
        return true;
    }
    /** The number of steps to show. */
    set steps(steps) {
        this.options.steps = steps;
        if (this.stepchart) {
            this.stepchart.settings.steps = steps;
            this.updateRequired = true;
        }
    }
    /** The number of steps complete (linear). */
    set completed(completed) {
        this.options.completed = completed;
        if (this.stepchart) {
            this.stepchart.settings.completed = completed;
            this.updateRequired = true;
        }
    }
    /** The number of the in progress step (linear). */
    set inProgress(inProgress) {
        this.options.inProgress = inProgress;
        if (this.stepchart) {
            this.stepchart.settings.inProgress = inProgress;
            this.updateRequired = true;
        }
    }
    /** The icon to display fx. 'icon-error', 'icon-success' */
    set iconType(iconType) {
        this.options.iconType = iconType;
        if (this.stepchart) {
            this.stepchart.settings.iconType = iconType;
            this.updateRequired = true;
        }
    }
    /**
     * The completed text or uses a localized 'N of N Steps complete'.
     *  You can use {0} and {1} to replace n of n in the string.
     */
    set completedText(completedText) {
        this.options.completedText = completedText;
        if (this.stepchart) {
            this.stepchart.settings.completedText = completedText;
            this.updateRequired = true;
        }
    }
    /**
     * The additional text to show on the right. Defaults to none.
     * You can use {0} to replace with the steps remaining count and {1} to replace the number of steps.
     */
    set extraText(extraText) {
        this.options.extraText = extraText;
        if (this.stepchart) {
            this.stepchart.settings.extraText = extraText;
            this.updateRequired = true;
        }
    }
    /** The color to show completed steps. Defaults to primary color. */
    set completedColor(completedColor) {
        this.options.completedColor = completedColor;
        if (this.stepchart) {
            this.stepchart.settings.completedColor = completedColor;
            this.updateRequired = true;
        }
    }
    /** The color to steps when all are completed. Defaults to primary color. */
    set allCompletedColor(allCompletedColor) {
        this.options.allCompletedColor = allCompletedColor;
        if (this.stepchart) {
            this.stepchart.settings.allCompletedColor = allCompletedColor;
            this.updateRequired = true;
        }
    }
    /** The color to show in-progress steps. Defaults to ruby02. */
    set inProgressColor(inProgressColor) {
        this.options.inProgressColor = inProgressColor;
        if (this.stepchart) {
            this.stepchart.settings.inProgressColor = inProgressColor;
            this.updateRequired = true;
        }
    }
    /** Add extra attributes like id's to the chart elements.
     * For example { name: 'id', value: 'my-unique-id' }
     */
    set attributes(attributes) {
        this.options.attributes = attributes;
        if (this.stepchart) {
            this.stepchart.settings.attributes = attributes;
            this.updateRequired = true;
        }
    }
    constructor(element, ngZone) {
        this.element = element;
        this.ngZone = ngZone;
        this.options = {};
        this.updateRequired = false;
    }
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // assign element to local variable
            this.jQueryElement = jQuery(this.element.nativeElement);
            // initialise the tag control
            this.jQueryElement.stepchart(this.options);
            // extract the api
            this.stepchart = this.jQueryElement.data('stepchart');
        });
    }
    ngAfterViewChecked() {
        if (this.stepchart && this.updateRequired) {
            this.ngZone.runOutsideAngular(() => this.stepchart?.updated(this.stepchart.settings));
            this.updateRequired = false;
        }
    }
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                // remove the event listeners on this element.
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            // Destroy any widget resources.
            if (this.stepchart) {
                // Error occurs in teardown in enterprise
                // this.stepchart.destroy();
                this.stepchart = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoStepChartComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoStepChartComponent, selector: "[soho-stepchart]", inputs: { steps: "steps", completed: "completed", inProgress: "inProgress", iconType: "iconType", completedText: "completedText", extraText: "extraText", completedColor: "completedColor", allCompletedColor: "allCompletedColor", inProgressColor: "inProgressColor", attributes: "attributes" }, host: { properties: { "class.step-chart": "this.isStepChart" } }, ngImport: i0, template: '<ng-content></ng-content>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoStepChartComponent, decorators: [{
            type: Component,
            args: [{
                    // eslint-disable-next-line @angular-eslint/component-selector
                    selector: '[soho-stepchart]',
                    template: '<ng-content></ng-content>',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { isStepChart: [{
                type: HostBinding,
                args: ['class.step-chart']
            }], steps: [{
                type: Input
            }], completed: [{
                type: Input
            }], inProgress: [{
                type: Input
            }], iconType: [{
                type: Input
            }], completedText: [{
                type: Input
            }], extraText: [{
                type: Input
            }], completedColor: [{
                type: Input
            }], allCompletedColor: [{
                type: Input
            }], inProgressColor: [{
                type: Input
            }], attributes: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1zdGVwY2hhcnQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9zdGVwY2hhcnQvc29oby1zdGVwY2hhcnQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG9EQUFvRDtBQUNwRCxPQUFPLEVBR0gsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxXQUFXLEVBQ1gsS0FBSyxFQUdSLE1BQU0sZUFBZSxDQUFDOztBQVF2QixNQUFNLE9BQU8sc0JBQXNCO0lBRy9CLElBQXFDLFdBQVc7UUFDNUMsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVELG1DQUFtQztJQUNuQyxJQUFhLEtBQUssQ0FBQyxLQUFhO1FBQzVCLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUMzQixJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDaEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztZQUN0QyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztTQUM5QjtJQUNMLENBQUM7SUFFRCw2Q0FBNkM7SUFDN0MsSUFBYSxTQUFTLENBQUMsU0FBaUI7UUFDcEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQ25DLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNoQixJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1lBQzlDLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1NBQzlCO0lBQ0wsQ0FBQztJQUVELG1EQUFtRDtJQUNuRCxJQUFhLFVBQVUsQ0FBQyxVQUFrQjtRQUN0QyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDckMsSUFBSSxJQUFJLENB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QUM7YUFDekI7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7OEdBdEpRLHNCQUFzQjtrR0FBdEIsc0JBQXNCLDhaQUhyQiwyQkFBMkI7OzJGQUc1QixzQkFBc0I7a0JBTmxDLFNBQVM7bUJBQUM7b0JBQ1AsOERBQThEO29CQUM5RCxRQUFRLEVBQUUsa0JBQWtCO29CQUM1QixRQUFRLEVBQUUsMkJBQTJCO29CQUNyQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtpQkFDbEQ7c0hBSXdDLFdBQVc7c0JBQS9DLFdBQVc7dUJBQUMsa0JBQWtCO2dCQUtsQixLQUFLO3NCQUFqQixLQUFLO2dCQVNPLFNBQVM7c0JBQXJCLEtBQUs7Z0JBU08sVUFBVTtzQkFBdEIsS0FBSztnQkFTTyxRQUFRO3NCQUFwQixLQUFLO2dCQVlPLGFBQWE7c0JBQXpCLEtBQUs7Z0JBWU8sU0FBUztzQkFBckIsS0FBSztnQkFTTyxjQUFjO3NCQUExQixLQUFLO2dCQVNPLGlCQUFpQjtzQkFBN0IsS0FBSztnQkFTTyxlQUFlO3NCQUEzQixLQUFLO2dCQVdPLFVBQVU7c0JBQXRCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lICovXG5pbXBvcnQge1xuICAgIEFmdGVyVmlld0NoZWNrZWQsXG4gICAgQWZ0ZXJWaWV3SW5pdCxcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgICBDb21wb25lbnQsXG4gICAgRWxlbWVudFJlZixcbiAgICBIb3N0QmluZGluZyxcbiAgICBJbnB1dCxcbiAgICBOZ1pvbmUsXG4gICAgT25EZXN0cm95XG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbkBDb21wb25lbnQoe1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvY29tcG9uZW50LXNlbGVjdG9yXG4gICAgc2VsZWN0b3I6ICdbc29oby1zdGVwY2hhcnRdJyxcbiAgICB0ZW1wbGF0ZTogJzxuZy1jb250ZW50PjwvbmctY29udGVudD4nLFxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvU3RlcENoYXJ0Q29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95IHtcbiAgICBwcml2YXRlIG9wdGlvbnM6IFNvaG9TdGVwQ2hhcnRPcHRpb25zID0ge307XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLnN0ZXAtY2hhcnQnKSBnZXQgaXNTdGVwQ2hhcnQoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKiBUaGUgbnVtYmVyIG9mIHN0ZXBzIHRvIHNob3cuICovXG4gICAgQElucHV0KCkgc2V0IHN0ZXBzKHN0ZXBzOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLnN0ZXBzID0gc3RlcHM7XG4gICAgICAgIGlmICh0aGlzLnN0ZXBjaGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQuc2V0dGluZ3Muc3RlcHMgPSBzdGVwcztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFRoZSBudW1iZXIgb2Ygc3RlcHMgY29tcGxldGUgKGxpbmVhcikuICovXG4gICAgQElucHV0KCkgc2V0IGNvbXBsZXRlZChjb21wbGV0ZWQ6IG51bWJlcikge1xuICAgICAgICB0aGlzLm9wdGlvbnMuY29tcGxldGVkID0gY29tcGxldGVkO1xuICAgICAgICBpZiAodGhpcy5zdGVwY2hhcnQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RlcGNoYXJ0LnNldHRpbmdzLmNvbXBsZXRlZCA9IGNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFRoZSBudW1iZXIgb2YgdGhlIGluIHByb2dyZXNzIHN0ZXAgKGxpbmVhcikuICovXG4gICAgQElucHV0KCkgc2V0IGluUHJvZ3Jlc3MoaW5Qcm9ncmVzczogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5pblByb2dyZXNzID0gaW5Qcm9ncmVzcztcbiAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnN0ZXBjaGFydC5zZXR0aW5ncy5pblByb2dyZXNzID0gaW5Qcm9ncmVzcztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFRoZSBpY29uIHRvIGRpc3BsYXkgZnguICdpY29uLWVycm9yJywgJ2ljb24tc3VjY2VzcycgKi9cbiAgICBASW5wdXQoKSBzZXQgaWNvblR5cGUoaWNvblR5cGU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmljb25UeXBlID0gaWNvblR5cGU7XG4gICAgICAgIGlmICh0aGlzLnN0ZXBjaGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQuc2V0dGluZ3MuaWNvblR5cGUgPSBpY29uVHlwZTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGNvbXBsZXRlZCB0ZXh0IG9yIHVzZXMgYSBsb2NhbGl6ZWQgJ04gb2YgTiBTdGVwcyBjb21wbGV0ZScuXG4gICAgICogIFlvdSBjYW4gdXNlIHswfSBhbmQgezF9IHRvIHJlcGxhY2UgbiBvZiBuIGluIHRoZSBzdHJpbmcuXG4gICAgICovXG4gICAgQElucHV0KCkgc2V0IGNvbXBsZXRlZFRleHQoY29tcGxldGVkVGV4dDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5jb21wbGV0ZWRUZXh0ID0gY29tcGxldGVkVGV4dDtcbiAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnN0ZXBjaGFydC5zZXR0aW5ncy5jb21wbGV0ZWRUZXh0ID0gY29tcGxldGVkVGV4dDtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGFkZGl0aW9uYWwgdGV4dCB0byBzaG93IG9uIHRoZSByaWdodC4gRGVmYXVsdHMgdG8gbm9uZS4gXG4gICAgICogWW91IGNhbiB1c2UgezB9IHRvIHJlcGxhY2Ugd2l0aCB0aGUgc3RlcHMgcmVtYWluaW5nIGNvdW50IGFuZCB7MX0gdG8gcmVwbGFjZSB0aGUgbnVtYmVyIG9mIHN0ZXBzLlxuICAgICAqL1xuICAgIEBJbnB1dCgpIHNldCBleHRyYVRleHQoZXh0cmFUZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmV4dHJhVGV4dCA9IGV4dHJhVGV4dDtcbiAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnN0ZXBjaGFydC5zZXR0aW5ncy5leHRyYVRleHQgPSBleHRyYVRleHQ7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBUaGUgY29sb3IgdG8gc2hvdyBjb21wbGV0ZWQgc3RlcHMuIERlZmF1bHRzIHRvIHByaW1hcnkgY29sb3IuICovXG4gICAgQElucHV0KCkgc2V0IGNvbXBsZXRlZENvbG9yKGNvbXBsZXRlZENvbG9yOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmNvbXBsZXRlZENvbG9yID0gY29tcGxldGVkQ29sb3I7XG4gICAgICAgIGlmICh0aGlzLnN0ZXBjaGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQuc2V0dGluZ3MuY29tcGxldGVkQ29sb3IgPSBjb21wbGV0ZWRDb2xvcjtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFRoZSBjb2xvciB0byBzdGVwcyB3aGVuIGFsbCBhcmUgY29tcGxldGVkLiBEZWZhdWx0cyB0byBwcmltYXJ5IGNvbG9yLiAqL1xuICAgIEBJbnB1dCgpIHNldCBhbGxDb21wbGV0ZWRDb2xvcihhbGxDb21wbGV0ZWRDb2xvcjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5hbGxDb21wbGV0ZWRDb2xvciA9IGFsbENvbXBsZXRlZENvbG9yO1xuICAgICAgICBpZiAodGhpcy5zdGVwY2hhcnQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RlcGNoYXJ0LnNldHRpbmdzLmFsbENvbXBsZXRlZENvbG9yID0gYWxsQ29tcGxldGVkQ29sb3I7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBUaGUgY29sb3IgdG8gc2hvdyBpbi1wcm9ncmVzcyBzdGVwcy4gRGVmYXVsdHMgdG8gcnVieTAyLiAqL1xuICAgIEBJbnB1dCgpIHNldCBpblByb2dyZXNzQ29sb3IoaW5Qcm9ncmVzc0NvbG9yOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmluUHJvZ3Jlc3NDb2xvciA9IGluUHJvZ3Jlc3NDb2xvcjtcbiAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnN0ZXBjaGFydC5zZXR0aW5ncy5pblByb2dyZXNzQ29sb3IgPSBpblByb2dyZXNzQ29sb3I7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBBZGQgZXh0cmEgYXR0cmlidXRlcyBsaWtlIGlkJ3MgdG8gdGhlIGNoYXJ0IGVsZW1lbnRzLiBcbiAgICAgKiBGb3IgZXhhbXBsZSB7IG5hbWU6ICdpZCcsIHZhbHVlOiAnbXktdW5pcXVlLWlkJyB9IFxuICAgICAqL1xuICAgIEBJbnB1dCgpIHNldCBhdHRyaWJ1dGVzKGF0dHJpYnV0ZXM6IEFycmF5PE9iamVjdD4gfCBPYmplY3QpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuXG4gICAgICAgIGlmICh0aGlzLnN0ZXBjaGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQuc2V0dGluZ3MuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcbiAgICBwcml2YXRlIHN0ZXBjaGFydD86IFNvaG9TdGVwQ2hhcnQgfCBudWxsO1xuICAgIHByaXZhdGUgdXBkYXRlUmVxdWlyZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmUsXG4gICAgKSB7IH1cblxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgLy8gYXNzaWduIGVsZW1lbnQgdG8gbG9jYWwgdmFyaWFibGVcbiAgICAgICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgICAgICAgIC8vIGluaXRpYWxpc2UgdGhlIHRhZyBjb250cm9sXG4gICAgICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQuc3RlcGNoYXJ0KHRoaXMub3B0aW9ucyk7XG5cbiAgICAgICAgICAgIC8vIGV4dHJhY3QgdGhlIGFwaVxuICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnc3RlcGNoYXJ0Jyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0ICYmIHRoaXMudXBkYXRlUmVxdWlyZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuc3RlcGNoYXJ0Py51cGRhdGVkKHRoaXMuc3RlcGNoYXJ0LnNldHRpbmdzKSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXJzIG9uIHRoaXMgZWxlbWVudC5cbiAgICAgICAgICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEZXN0cm95IGFueSB3aWRnZXQgcmVzb3VyY2VzLlxuICAgICAgICAgICAgaWYgKHRoaXMuc3RlcGNoYXJ0KSB7XG4gICAgICAgICAgICAgICAgLy8gRXJyb3Igb2NjdXJzIGluIHRlYXJkb3duIGluIGVudGVycHJpc2VcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnN0ZXBjaGFydC5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGVwY2hhcnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59Il19