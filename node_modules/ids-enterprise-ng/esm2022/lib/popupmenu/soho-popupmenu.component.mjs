import { Component, EventEmitter, HostBinding, Input, Output, } from '@angular/core';
import * as i0 from "@angular/core";
/**
 * SUB COMPONENT: SOHO-MENUPOPUPMENU-HEADING
 */
export class SohoPopupMenuHeadingComponent {
    get isHeading() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuHeadingComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuHeadingComponent, selector: "li[soho-popupmenu-heading]", host: { properties: { "class.heading": "this.isHeading" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuHeadingComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-popupmenu-heading]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isHeading: [{
                type: HostBinding,
                args: ['class.heading']
            }] } });
/**
 * SUB COMPONENT: SOHO-POPUPMENU-SHORTCUT-TEXT
 */
export class SohoPopupMenuShortCutTextComponent {
    get isShortCutText() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuShortCutTextComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuShortCutTextComponent, selector: "span[soho-popupmenu-shortcut-text]", host: { properties: { "class.shortcut-text": "this.isShortCutText" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuShortCutTextComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'span[soho-popupmenu-shortcut-text]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isShortCutText: [{
                type: HostBinding,
                args: ['class.shortcut-text']
            }] } });
/**
 * SUB COMPONENT: SOHO-MENUPOPUPMENU-SEPARATOR
 */
export class SohoPopupMenuSeparatorComponent {
    constructor() {
        this.singleSelectableSection = false;
        this.multiSelectableSection = false;
    }
    get isSeparator() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuSeparatorComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuSeparatorComponent, selector: "li[soho-popupmenu-separator]", inputs: { singleSelectableSection: "singleSelectableSection", multiSelectableSection: "multiSelectableSection" }, host: { properties: { "class.separator": "this.isSeparator", "class.single-selectable-section": "this.singleSelectableSection", "class.multi-selectable-section": "this.multiSelectableSection" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuSeparatorComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-popupmenu-separator]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isSeparator: [{
                type: HostBinding,
                args: ['class.separator']
            }], singleSelectableSection: [{
                type: HostBinding,
                args: ['class.single-selectable-section']
            }, {
                type: Input
            }], multiSelectableSection: [{
                type: HostBinding,
                args: ['class.multi-selectable-section']
            }, {
                type: Input
            }] } });
/**
 * SUB COMPONENT: SOHO-MENUPOPUPMENU-LABEL
 */
export class SohoPopupMenuItemLabelComponent {
    get hrefAttr() {
        if (this.menuId) {
            return '#' + this.menuId;
        }
        if (this.menuUrl) {
            return this.menuUrl;
        }
        return '#';
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuItemLabelComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuItemLabelComponent, selector: "a[soho-popupmenu-label]", inputs: { menuId: "menuId", menuUrl: "menuUrl" }, host: { properties: { "attr.href": "this.hrefAttr" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuItemLabelComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'a[soho-popupmenu-label]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { hrefAttr: [{
                type: HostBinding,
                args: ['attr.href']
            }], menuId: [{
                type: Input
            }], menuUrl: [{
                type: Input
            }] } });
/**
 * SUB COMPONENT: SOHO-MENUPOPUPMENU-ITEM
 */
export class SohoPopupMenuItemComponent {
    constructor() {
        this.isSelectable = false;
        this.isDisabled = false;
        this.isIndented = false;
        this.subMenu = false;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuItemComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuItemComponent, selector: "li[soho-popupmenu-item]", inputs: { isChecked: "isChecked", isSelectable: "isSelectable", isDisabled: "isDisabled", isIndented: "isIndented", subMenu: "subMenu" }, host: { properties: { "class.is-checked": "this.isChecked", "class.is-selectable": "this.isSelectable", "class.is-disabled": "this.isDisabled", "class.is-indented": "this.isIndented", "class.submenu": "this.subMenu" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuItemComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-popupmenu-item]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isChecked: [{
                type: HostBinding,
                args: ['class.is-checked']
            }, {
                type: Input
            }], isSelectable: [{
                type: HostBinding,
                args: ['class.is-selectable']
            }, {
                type: Input
            }], isDisabled: [{
                type: HostBinding,
                args: ['class.is-disabled']
            }, {
                type: Input
            }], isIndented: [{
                type: HostBinding,
                args: ['class.is-indented']
            }, {
                type: Input
            }], subMenu: [{
                type: HostBinding,
                args: ['class.submenu']
            }, {
                type: Input
            }] } });
/**
 * MAIN COMPONENT: SOHO-MENUPOPUPMENU
 */
export class SohoPopupMenuComponent {
    set popupmenuOptions(_popupMenuOptions) {
        this._popupMenuOptions = _popupMenuOptions;
        if (this.jQueryElement) {
            this.popupmenu.settings = _popupMenuOptions;
        }
    }
    get popupmenuOptions() {
        if (this.popupmenu) {
            return this.popupmenu.settings;
        }
        return this._popupMenuOptions;
    }
    /** id (or jQuery object) of associated drop down list. */
    set menu(menu) {
        this._popupMenuOptions.menu = menu;
        if (this.popupmenu) {
            this.popupmenu.settings.menu = menu;
        }
    }
    get menu() {
        if (this.popupmenu) {
            return this.popupmenu.settings.menu;
        }
        return this._popupMenuOptions.menu;
    }
    /** 'click' | 'rightClick' | 'immediate' */
    set trigger(trigger) {
        this._popupMenuOptions.trigger = trigger;
        if (this.popupmenu) {
            this.popupmenu.settings.trigger = trigger;
        }
    }
    get trigger() {
        if (this.popupmenu) {
            return this.popupmenu.settings.trigger;
        }
        return this._popupMenuOptions.trigger;
    }
    /** Auto Focus */
    set autoFocus(autoFocus) {
        this._popupMenuOptions.autoFocus = autoFocus;
        if (this.popupmenu) {
            this.popupmenu.settings.autoFocus = autoFocus;
        }
    }
    get autoFocus() {
        if (this.popupmenu) {
            return this.popupmenu.settings.autoFocus;
        }
        return this._popupMenuOptions.autoFocus;
    }
    /** Mouse focus. */
    set mouseFocus(mouseFocus) {
        this._popupMenuOptions.mouseFocus = mouseFocus;
        if (this.popupmenu) {
            this.popupmenu.settings.mouseFocus = mouseFocus;
        }
    }
    get mouseFocus() {
        if (this.popupmenu) {
            return this.popupmenu.settings.mouseFocus;
        }
        return this._popupMenuOptions.mouseFocus;
    }
    /** Attach to body. */
    set attachToBody(attachToBody) {
        this._popupMenuOptions.attachToBody = attachToBody;
        if (this.popupmenu) {
            this.popupmenu.settings.attachToBody = attachToBody;
        }
    }
    get attachToBody() {
        if (this.popupmenu) {
            return this.popupmenu.settings.attachToBody;
        }
        return this._popupMenuOptions.attachToBody;
    }
    /** beforeOpen - ajax callback for open event */
    set beforeOpen(beforeOpen) {
        this._popupMenuOptions.beforeOpen = beforeOpen;
        if (this.popupmenu) {
            this.popupmenu.settings.beforeOpen = beforeOpen;
        }
    }
    get beforeOpen() {
        if (this.popupmenu) {
            return this.popupmenu.settings.beforeOpen;
        }
        return this._popupMenuOptions.beforeOpen;
    }
    /** Switches aria to use listbox construct instead of menu construct (internal). */
    set ariaListbox(ariaListbox) {
        this._popupMenuOptions.ariaListbox = ariaListbox;
        if (this.popupmenu) {
            this.popupmenu.settings.ariaListbox = ariaListbox;
        }
    }
    get ariaListbox() {
        if (this.popupmenu) {
            return this.popupmenu.settings.ariaListbox;
        }
        return this._popupMenuOptions.ariaListbox;
    }
    /**
     * By default, menus open up underneath their target element.  Set this to true to
     * use mouse coordinates for positioning a menu inside of its target element.
     */
    set useCoordsForClick(useCoordsForClick) {
        this._popupMenuOptions.useCoordsForClick = useCoordsForClick;
        if (this.popupmenu) {
            this.popupmenu.settings.useCoordsForClick = useCoordsForClick;
        }
    }
    get useCoordsForClick() {
        if (this.popupmenu) {
            return this.popupmenu.settings.useCoordsForClick;
        }
        return this._popupMenuOptions.useCoordsForClick;
    }
    /** Can pass in the event object so you can do a right click with immediate */
    set eventObj(eventObj) {
        this._popupMenuOptions.eventObj = eventObj;
        if (this.popupmenu) {
            this.popupmenu.settings.eventObj = eventObj;
        }
    }
    get eventObj() {
        if (this.popupmenu) {
            return this.popupmenu.settings.eventObj;
        }
        return this._popupMenuOptions.eventObj;
    }
    set placementOpts(placementOpts) {
        this._popupMenuOptions.placementOpts = placementOpts;
        if (this.popupmenu) {
            this.popupmenu.settings.placementOpts = placementOpts;
        }
    }
    get placementOpts() {
        if (this.popupmenu) {
            return this.popupmenu.settings.placementOpts;
        }
        return this._popupMenuOptions.placementOpts;
    }
    set offset(offset) {
        this._popupMenuOptions.offset = offset;
        if (this.popupmenu) {
            this.popupmenu.settings.offset = offset;
        }
    }
    get offset() {
        if (this.popupmenu) {
            return this.popupmenu.settings.offset;
        }
        return this._popupMenuOptions.offset;
    }
    set removeOnDestroy(removeOnDestroy) {
        this._popupMenuOptions.removeOnDestroy = removeOnDestroy;
        if (this.popupmenu) {
            this.popupmenu.settings.removeOnDestroy = removeOnDestroy;
        }
    }
    get removeOnDestroy() {
        if (this.popupmenu) {
            return this.popupmenu.settings.removeOnDestroy;
        }
        return this._popupMenuOptions.removeOnDestroy;
    }
    set attributes(attributes) {
        this._popupMenuOptions.attributes = attributes;
        if (this.popupmenu) {
            this.popupmenu.settings.attributes = attributes;
        }
    }
    get attributes() {
        if (this.popupmenu) {
            return this.popupmenu.settings.attributes;
        }
        return this._popupMenuOptions.attributes;
    }
    constructor(elementRef, ngZone) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        // -------------------------------------------
        // Component Output
        // -------------------------------------------
        this.selected = new EventEmitter();
        this.popupmenuafterplace = new EventEmitter();
        this.beforeopen = new EventEmitter();
        /**
         * @todo remove override of native element
         */
        // eslint-disable-next-line @angular-eslint/no-output-native
        this.open = new EventEmitter();
        this.afteropen = new EventEmitter();
        // using output renaming since close conflicts with the close method
        // in this class.
        this.closeEvent = new EventEmitter(); // eslint-disable-line
        // -------------------------------------------
        // Host Bindings
        // -------------------------------------------
        this.isPopupmenu = true;
        this.isSelectable = false;
        this.isMultiselectable = false;
        this._popupMenuOptions = {};
    }
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // Wrap for later.
            this.jQueryElement = jQuery(this.elementRef.nativeElement);
            // Initialise the SohoXi control.
            this.jQueryElement.popupmenu(this._popupMenuOptions);
            // Once the control is initialised, extract the control plug-in from the element.
            this.popupmenu = this.jQueryElement.data('popupmenu');
            // bind to jquery events and emit as angular events
            this.jQueryElement.on('selected', (e, args) => this.ngZone.run(() => this.selected.emit({ e, args })));
            this.jQueryElement.on('popupmenuafterplace', (e, args) => this.ngZone.run(() => this.popupmenuafterplace.emit({ e, args })));
            this.jQueryElement.on('beforeopen', (e, args) => this.ngZone.run(() => this.beforeopen.emit({ e, args })));
            this.jQueryElement.on('open', (e, args) => this.ngZone.run(() => this.open.emit({ e, args })));
            this.jQueryElement.on('afteropen', (e, args) => this.ngZone.run(() => this.afteropen.emit({ e, args })));
            this.jQueryElement.on('close', (e, args) => this.ngZone.run(() => this.closeEvent.emit({ e, args })));
        });
    }
    /**
     * Returns the selected html element.
     */
    getSelected() {
        if (this.popupmenu) {
            return this.ngZone.runOutsideAngular(() => this.popupmenu?.getSelected());
        }
    }
    /**
     * Updates the control to reflect the settings.
     */
    updated(settings) {
        if (this.popupmenu) {
            this.ngZone.runOutsideAngular(() => this.popupmenu?.updated(settings));
        }
    }
    /**
     * Tear down the markup for the popup menu
     */
    teardown() {
        if (this.popupmenu) {
            this.ngZone.runOutsideAngular(() => this.popupmenu?.teardown());
        }
    }
    /**
     * Closes the popup menu
     */
    close(isCancelled, noFocus) {
        if (this.popupmenu) {
            this.ngZone.runOutsideAngular(() => this.popupmenu?.close(isCancelled, noFocus));
        }
    }
    /**
     * Destroy the markup and any other resources.
     */
    destroy() {
        setTimeout(() => {
            this.ngZone.runOutsideAngular(() => {
                if (this.jQueryElement) {
                    this.jQueryElement.off();
                    this.jQueryElement = undefined;
                }
                if (this.popupmenu) {
                    this.popupmenu.destroy();
                    this.popupmenu = undefined;
                }
            });
        }, 200);
    }
    /**
     * Cleanup just before Angular destroys the component.
     * Unsubscribe observables, detach event handlers and remove other resources to avoid memory leaks.
     */
    ngOnDestroy() {
        this.destroy();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoPopupMenuComponent, selector: "ul[soho-popupmenu]", inputs: { popupmenuOptions: "popupmenuOptions", menu: "menu", trigger: "trigger", autoFocus: "autoFocus", mouseFocus: "mouseFocus", attachToBody: "attachToBody", beforeOpen: "beforeOpen", ariaListbox: "ariaListbox", useCoordsForClick: "useCoordsForClick", eventObj: "eventObj", placementOpts: "placementOpts", offset: "offset", removeOnDestroy: "removeOnDestroy", attributes: "attributes", isSelectable: "isSelectable", isMultiselectable: "isMultiselectable" }, outputs: { selected: "selected", popupmenuafterplace: "popupmenuafterplace", beforeopen: "beforeopen", open: "open", afteropen: "afteropen", closeEvent: "close" }, host: { properties: { "class.popupmenu": "this.isPopupmenu", "class.is-selectable": "this.isSelectable", "class.is-multiselectable": "this.isMultiselectable" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPopupMenuComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'ul[soho-popupmenu]',
                    template: `<ng-content></ng-content>`
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { popupmenuOptions: [{
                type: Input
            }], menu: [{
                type: Input
            }], trigger: [{
                type: Input
            }], autoFocus: [{
                type: Input
            }], mouseFocus: [{
                type: Input
            }], attachToBody: [{
                type: Input
            }], beforeOpen: [{
                type: Input
            }], ariaListbox: [{
                type: Input
            }], useCoordsForClick: [{
                type: Input
            }], eventObj: [{
                type: Input
            }], placementOpts: [{
                type: Input
            }], offset: [{
                type: Input
            }], removeOnDestroy: [{
                type: Input
            }], attributes: [{
                type: Input
            }], selected: [{
                type: Output
            }], popupmenuafterplace: [{
                type: Output
            }], beforeopen: [{
                type: Output
            }], open: [{
                type: Output
            }], afteropen: [{
                type: Output
            }], closeEvent: [{
                type: Output,
                args: ['close']
            }], isPopupmenu: [{
                type: HostBinding,
                args: ['class.popupmenu']
            }], isSelectable: [{
                type: HostBinding,
                args: ['class.is-selectable']
            }, {
                type: Input
            }], isMultiselectable: [{
                type: HostBinding,
                args: ['class.is-multiselectable']
            }, {
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1wb3B1cG1lbnUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9wb3B1cG1lbnUvc29oby1wb3B1cG1lbnUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxTQUFTLEVBRVQsWUFBWSxFQUNaLFdBQVcsRUFDWCxLQUFLLEVBRUwsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFDOztBQUV2Qjs7R0FFRztBQUtILE1BQU0sT0FBTyw2QkFBNkI7SUFDeEMsSUFBa0MsU0FBUztRQUN6QyxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7OEdBSFUsNkJBQTZCO2tHQUE3Qiw2QkFBNkIsK0hBRjlCLDJCQUEyQjs7MkZBRTFCLDZCQUE2QjtrQkFKekMsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUsNEJBQTRCO29CQUN0QyxRQUFRLEVBQUUsMkJBQTJCO2lCQUN0Qzs4QkFFbUMsU0FBUztzQkFBMUMsV0FBVzt1QkFBQyxlQUFlOztBQUs5Qjs7R0FFRztBQUtILE1BQU0sT0FBTyxrQ0FBa0M7SUFDN0MsSUFBd0MsY0FBYztRQUNwRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7OEdBSFUsa0NBQWtDO2tHQUFsQyxrQ0FBa0Msa0pBRm5DLDJCQUEyQjs7MkZBRTFCLGtDQUFrQztrQkFKOUMsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUsb0NBQW9DO29CQUM5QyxRQUFRLEVBQUUsMkJBQTJCO2lCQUN0Qzs4QkFFeUMsY0FBYztzQkFBckQsV0FBVzt1QkFBQyxxQkFBcUI7O0FBS3BDOztHQUVHO0FBS0gsTUFBTSxPQUFPLCtCQUErQjtJQUo1QztRQVEyRCw0QkFBdUIsR0FBRyxLQUFLLENBQUM7UUFDakMsMkJBQXNCLEdBQUcsS0FBSyxDQUFDO0tBQ3hGO0lBTEMsSUFBb0MsV0FBVztRQUM3QyxPQUFPLElBQUks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QUVHLFNBQVM7c0JBQWxCLE1BQU07Z0JBSVUsVUFBVTtzQkFBMUIsTUFBTTt1QkFBQyxPQUFPO2dCQU1pQixXQUFXO3NCQUExQyxXQUFXO3VCQUFDLGlCQUFpQjtnQkFDZSxZQUFZO3NCQUF4RCxXQUFXO3VCQUFDLHFCQUFxQjs7c0JBQUcsS0FBSztnQkFDUSxpQkFBaUI7c0JBQWxFLFdBQVc7dUJBQUMsMEJBQTBCOztzQkFBRyxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCwgTmdab25lLFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbi8qKlxuICogU1VCIENPTVBPTkVOVDogU09ITy1NRU5VUE9QVVBNRU5VLUhFQURJTkdcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbGlbc29oby1wb3B1cG1lbnUtaGVhZGluZ10nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmBcbn0pXG5leHBvcnQgY2xhc3MgU29ob1BvcHVwTWVudUhlYWRpbmdDb21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmhlYWRpbmcnKSBnZXQgaXNIZWFkaW5nKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbi8qKlxuICogU1VCIENPTVBPTkVOVDogU09ITy1QT1BVUE1FTlUtU0hPUlRDVVQtVEVYVFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzcGFuW3NvaG8tcG9wdXBtZW51LXNob3J0Y3V0LXRleHRdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Qb3B1cE1lbnVTaG9ydEN1dFRleHRDb21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnNob3J0Y3V0LXRleHQnKSBnZXQgaXNTaG9ydEN1dFRleHQoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxuLyoqXG4gKiBTVUIgQ09NUE9ORU5UOiBTT0hPLU1FTlVQT1BVUE1FTlUtU0VQQVJBVE9SXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2xpW3NvaG8tcG9wdXBtZW51LXNlcGFyYXRvcl0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmBcbn0pXG5leHBvcnQgY2xhc3MgU29ob1BvcHVwTWVudVNlcGFyYXRvckNvbXBvbmVudCB7XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2VwYXJhdG9yJykgZ2V0IGlzU2VwYXJhdG9yKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2luZ2xlLXNlbGVjdGFibGUtc2VjdGlvbicpIEBJbnB1dCgpIHNpbmdsZVNlbGVjdGFibGVTZWN0aW9uID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MubXVsdGktc2VsZWN0YWJsZS1zZWN0aW9uJykgQElucHV0KCkgbXVsdGlTZWxlY3RhYmxlU2VjdGlvbiA9IGZhbHNlO1xufVxuXG4vKipcbiAqIFNVQiBDT01QT05FTlQ6IFNPSE8tTUVOVVBPUFVQTUVOVS1MQUJFTFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhW3NvaG8tcG9wdXBtZW51LWxhYmVsXScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvUG9wdXBNZW51SXRlbUxhYmVsQ29tcG9uZW50IHtcbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmhyZWYnKSBnZXQgaHJlZkF0dHIoKSB7XG4gICAgaWYgKHRoaXMubWVudUlkKSB7XG4gICAgICByZXR1cm4gJyMnICsgdGhpcy5tZW51SWQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubWVudVVybCkge1xuICAgICAgcmV0dXJuIHRoaXMubWVudVVybDtcbiAgICB9XG5cbiAgICByZXR1cm4gJyMnO1xuICB9XG5cbiAgQElucHV0KCkgbWVudUlkPzogc3RyaW5nO1xuICBASW5wdXQoKSBtZW51VXJsPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIFNVQiBDT01QT05FTlQ6IFNPSE8tTUVOVVBPUFVQTUVOVS1JVEVNXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2xpW3NvaG8tcG9wdXBtZW51LWl0ZW1dJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Qb3B1cE1lbnVJdGVtQ29tcG9uZW50IHtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pcy1jaGVja2VkJykgQElucHV0KCkgaXNDaGVja2VkPzogYm9vbGVhbjtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pcy1zZWxlY3RhYmxlJykgQElucHV0KCkgaXNTZWxlY3RhYmxlID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MuaXMtZGlzYWJsZWQnKSBASW5wdXQoKSBpc0Rpc2FibGVkID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MuaXMtaW5kZW50ZWQnKSBASW5wdXQoKSBpc0luZGVudGVkID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc3VibWVudScpIEBJbnB1dCgpIHN1Yk1lbnUgPSBmYWxzZTtcbn1cblxuLyoqXG4gKiBNQUlOIENPTVBPTkVOVDogU09ITy1NRU5VUE9QVVBNRU5VXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3VsW3NvaG8tcG9wdXBtZW51XScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvUG9wdXBNZW51Q29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICBASW5wdXQoKSBzZXQgcG9wdXBtZW51T3B0aW9ucyhfcG9wdXBNZW51T3B0aW9uczogU29ob1BvcHVwTWVudU9wdGlvbnMpIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zID0gX3BvcHVwTWVudU9wdGlvbnM7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MgPSBfcG9wdXBNZW51T3B0aW9ucztcbiAgICB9XG4gIH1cblxuICBnZXQgcG9wdXBtZW51T3B0aW9ucygpOiBTb2hvUG9wdXBNZW51T3B0aW9ucyB7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICByZXR1cm4gKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3M7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3BvcHVwTWVudU9wdGlvbnM7XG4gIH1cblxuICAvKiogaWQgKG9yIGpRdWVyeSBvYmplY3QpIG9mIGFzc29jaWF0ZWQgZHJvcCBkb3duIGxpc3QuICovXG4gIEBJbnB1dCgpIHNldCBtZW51KG1lbnU6IHN0cmluZyB8IEpRdWVyeSkge1xuICAgIHRoaXMuX3BvcHVwTWVudU9wdGlvbnMubWVudSA9IG1lbnU7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5tZW51ID0gbWVudTtcbiAgICB9XG4gIH1cblxuICBnZXQgbWVudSgpOiBzdHJpbmcgfCBKUXVlcnkge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLm1lbnU7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkubWVudTtcbiAgfVxuXG4gIC8qKiAnY2xpY2snIHwgJ3JpZ2h0Q2xpY2snIHwgJ2ltbWVkaWF0ZScgKi9cbiAgQElucHV0KCkgc2V0IHRyaWdnZXIodHJpZ2dlcjogU29ob1BvcHVwTWVudVRyaWdnZXIpIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zLnRyaWdnZXIgPSB0cmlnZ2VyO1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MudHJpZ2dlciA9IHRyaWdnZXI7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHRyaWdnZXIoKTogU29ob1BvcHVwTWVudVRyaWdnZXIge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLnRyaWdnZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkudHJpZ2dlcjtcbiAgfVxuXG4gIC8qKiBBdXRvIEZvY3VzICovXG4gIEBJbnB1dCgpIHNldCBhdXRvRm9jdXMoYXV0b0ZvY3VzOiBib29sZWFuKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5hdXRvRm9jdXMgPSBhdXRvRm9jdXM7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5hdXRvRm9jdXMgPSBhdXRvRm9jdXM7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGF1dG9Gb2N1cygpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5hdXRvRm9jdXM7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkuYXV0b0ZvY3VzO1xuICB9XG5cbiAgLyoqIE1vdXNlIGZvY3VzLiAqL1xuICBASW5wdXQoKSBzZXQgbW91c2VGb2N1cyhtb3VzZUZvY3VzOiBib29sZWFuKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5tb3VzZUZvY3VzID0gbW91c2VGb2N1cztcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLm1vdXNlRm9jdXMgPSBtb3VzZUZvY3VzO1xuICAgIH1cbiAgfVxuXG4gIGdldCBtb3VzZUZvY3VzKCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLm1vdXNlRm9jdXM7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkubW91c2VGb2N1cztcbiAgfVxuXG4gIC8qKiBBdHRhY2ggdG8gYm9keS4gKi9cbiAgQElucHV0KCkgc2V0IGF0dGFjaFRvQm9keShhdHRhY2hUb0JvZHk6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zLmF0dGFjaFRvQm9keSA9IGF0dGFjaFRvQm9keTtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmF0dGFjaFRvQm9keSA9IGF0dGFjaFRvQm9keTtcbiAgICB9XG4gIH1cblxuICBnZXQgYXR0YWNoVG9Cb2R5KCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmF0dGFjaFRvQm9keTtcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuX3BvcHVwTWVudU9wdGlvbnMgYXMgYW55KS5hdHRhY2hUb0JvZHk7XG4gIH1cblxuICAvKiogYmVmb3JlT3BlbiAtIGFqYXggY2FsbGJhY2sgZm9yIG9wZW4gZXZlbnQgKi9cbiAgQElucHV0KCkgc2V0IGJlZm9yZU9wZW4oYmVmb3JlT3BlbjogU29ob1BvcHVwTWVudVNvdXJjZUZ1bmN0aW9uKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5iZWZvcmVPcGVuID0gYmVmb3JlT3BlbjtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmJlZm9yZU9wZW4gPSBiZWZvcmVPcGVuO1xuICAgIH1cbiAgfVxuXG4gIGdldCBiZWZvcmVPcGVuKCk6IFNvaG9Qb3B1cE1lbnVTb3VyY2VGdW5jdGlvbiB7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICByZXR1cm4gKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MuYmVmb3JlT3BlbjtcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuX3BvcHVwTWVudU9wdGlvbnMgYXMgYW55KS5iZWZvcmVPcGVuO1xuICB9XG5cbiAgLyoqIFN3aXRjaGVzIGFyaWEgdG8gdXNlIGxpc3Rib3ggY29uc3RydWN0IGluc3RlYWQgb2YgbWVudSBjb25zdHJ1Y3QgKGludGVybmFsKS4gKi9cbiAgQElucHV0KCkgc2V0IGFyaWFMaXN0Ym94KGFyaWFMaXN0Ym94OiBib29sZWFuKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5hcmlhTGlzdGJveCA9IGFyaWFMaXN0Ym94O1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MuYXJpYUxpc3Rib3ggPSBhcmlhTGlzdGJveDtcbiAgICB9XG4gIH1cblxuICBnZXQgYXJpYUxpc3Rib3goKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICByZXR1cm4gKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MuYXJpYUxpc3Rib3g7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkuYXJpYUxpc3Rib3g7XG4gIH1cblxuICAvKipcbiAgICogQnkgZGVmYXVsdCwgbWVudXMgb3BlbiB1cCB1bmRlcm5lYXRoIHRoZWlyIHRhcmdldCBlbGVtZW50LiAgU2V0IHRoaXMgdG8gdHJ1ZSB0b1xuICAgKiB1c2UgbW91c2UgY29vcmRpbmF0ZXMgZm9yIHBvc2l0aW9uaW5nIGEgbWVudSBpbnNpZGUgb2YgaXRzIHRhcmdldCBlbGVtZW50LlxuICAgKi9cbiAgQElucHV0KCkgc2V0IHVzZUNvb3Jkc0ZvckNsaWNrKHVzZUNvb3Jkc0ZvckNsaWNrOiBib29sZWFuKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy51c2VDb29yZHNGb3JDbGljayA9IHVzZUNvb3Jkc0ZvckNsaWNrO1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MudXNlQ29vcmRzRm9yQ2xpY2sgPSB1c2VDb29yZHNGb3JDbGljaztcbiAgICB9XG4gIH1cblxuICBnZXQgdXNlQ29vcmRzRm9yQ2xpY2soKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICByZXR1cm4gKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MudXNlQ29vcmRzRm9yQ2xpY2s7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkudXNlQ29vcmRzRm9yQ2xpY2s7XG4gIH1cblxuICAvKiogQ2FuIHBhc3MgaW4gdGhlIGV2ZW50IG9iamVjdCBzbyB5b3UgY2FuIGRvIGEgcmlnaHQgY2xpY2sgd2l0aCBpbW1lZGlhdGUgKi9cbiAgQElucHV0KCkgc2V0IGV2ZW50T2JqKGV2ZW50T2JqOiBhbnkpIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zLmV2ZW50T2JqID0gZXZlbnRPYmo7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5ldmVudE9iaiA9IGV2ZW50T2JqO1xuICAgIH1cbiAgfVxuXG4gIGdldCBldmVudE9iaigpOiBhbnkge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmV2ZW50T2JqO1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5fcG9wdXBNZW51T3B0aW9ucyBhcyBhbnkpLmV2ZW50T2JqO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHBsYWNlbWVudE9wdHMocGxhY2VtZW50T3B0czogU29ob1BvcHVwbWVudVBsYWNlbWVudE9wdHMpIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zLnBsYWNlbWVudE9wdHMgPSBwbGFjZW1lbnRPcHRzO1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgKHRoaXMucG9wdXBtZW51IGFzIGFueSkuc2V0dGluZ3MucGxhY2VtZW50T3B0cyA9IHBsYWNlbWVudE9wdHM7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHBsYWNlbWVudE9wdHMoKTogU29ob1BvcHVwbWVudVBsYWNlbWVudE9wdHMge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLnBsYWNlbWVudE9wdHM7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkucGxhY2VtZW50T3B0cztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBvZmZzZXQob2Zmc2V0OiBTb2hvUG9wdXBtZW51T2Zmc2V0KSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG9mZnNldCgpOiBTb2hvUG9wdXBtZW51T2Zmc2V0IHtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5wb3B1cG1lbnUgYXMgYW55KS5zZXR0aW5ncy5vZmZzZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0aGlzLl9wb3B1cE1lbnVPcHRpb25zIGFzIGFueSkub2Zmc2V0O1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHJlbW92ZU9uRGVzdHJveShyZW1vdmVPbkRlc3Ryb3k6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9wb3B1cE1lbnVPcHRpb25zLnJlbW92ZU9uRGVzdHJveSA9IHJlbW92ZU9uRGVzdHJveTtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLnJlbW92ZU9uRGVzdHJveSA9IHJlbW92ZU9uRGVzdHJveTtcbiAgICB9XG4gIH1cblxuICBnZXQgcmVtb3ZlT25EZXN0cm95KCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLnJlbW92ZU9uRGVzdHJveTtcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuX3BvcHVwTWVudU9wdGlvbnMgYXMgYW55KS5yZW1vdmVPbkRlc3Ryb3k7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgYXR0cmlidXRlcyhhdHRyaWJ1dGVzOiBBcnJheTxPYmplY3Q+IHwgT2JqZWN0IHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fcG9wdXBNZW51T3B0aW9ucy5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgIH1cbiAgfVxuXG4gIGdldCBhdHRyaWJ1dGVzKCk6IEFycmF5PE9iamVjdD4gfCBPYmplY3QgfCB1bmRlZmluZWQge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLnBvcHVwbWVudSBhcyBhbnkpLnNldHRpbmdzLmF0dHJpYnV0ZXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3BvcHVwTWVudU9wdGlvbnMuYXR0cmlidXRlcztcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gQ29tcG9uZW50IE91dHB1dFxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgQE91dHB1dCgpIHNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvUG9wdXBNZW51RXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIHBvcHVwbWVudWFmdGVycGxhY2UgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Qb3B1cE1lbnVFdmVudD4oKTtcblxuICBAT3V0cHV0KCkgYmVmb3Jlb3BlbiA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob1BvcHVwTWVudUV2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBAdG9kbyByZW1vdmUgb3ZlcnJpZGUgb2YgbmF0aXZlIGVsZW1lbnRcbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8tb3V0cHV0LW5hdGl2ZVxuICBAT3V0cHV0KCkgb3BlbiA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob1BvcHVwTWVudUV2ZW50PigpO1xuXG4gIEBPdXRwdXQoKSBhZnRlcm9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Qb3B1cE1lbnVFdmVudD4oKTtcblxuICAvLyB1c2luZyBvdXRwdXQgcmVuYW1pbmcgc2luY2UgY2xvc2UgY29uZmxpY3RzIHdpdGggdGhlIGNsb3NlIG1ldGhvZFxuICAvLyBpbiB0aGlzIGNsYXNzLlxuICBAT3V0cHV0KCdjbG9zZScpIGNsb3NlRXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Qb3B1cE1lbnVFdmVudD4oKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gSG9zdCBCaW5kaW5nc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5wb3B1cG1lbnUnKSBpc1BvcHVwbWVudSA9IHRydWU7XG4gIEBIb3N0QmluZGluZygnY2xhc3MuaXMtc2VsZWN0YWJsZScpIEBJbnB1dCgpIGlzU2VsZWN0YWJsZSA9IGZhbHNlO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmlzLW11bHRpc2VsZWN0YWJsZScpIEBJbnB1dCgpIGlzTXVsdGlzZWxlY3RhYmxlID0gZmFsc2U7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBQcml2YXRlIE1lbWJlciBEYXRhXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSZWZlcmVuY2UgdG8gdGhlIGpRdWVyeSBjb250cm9sLlxuICBwcml2YXRlIGpRdWVyeUVsZW1lbnQ/OiBKUXVlcnk7XG5cbiAgcHJpdmF0ZSBwb3B1cG1lbnU/OiBTb2hvUG9wdXBNZW51U3RhdGljO1xuXG4gIHByaXZhdGUgX3BvcHVwTWVudU9wdGlvbnM6IFNvaG9Qb3B1cE1lbnVPcHRpb25zID0ge307XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLCBwcml2YXRlIG5nWm9uZTogTmdab25lKSB7IH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgLy8gV3JhcCBmb3IgbGF0ZXIuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSBqUXVlcnkodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuXG4gICAgICAvLyBJbml0aWFsaXNlIHRoZSBTb2hvWGkgY29udHJvbC5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5wb3B1cG1lbnUodGhpcy5fcG9wdXBNZW51T3B0aW9ucyk7XG5cbiAgICAgIC8vIE9uY2UgdGhlIGNvbnRyb2wgaXMgaW5pdGlhbGlzZWQsIGV4dHJhY3QgdGhlIGNvbnRyb2wgcGx1Zy1pbiBmcm9tIHRoZSBlbGVtZW50LlxuICAgICAgdGhpcy5wb3B1cG1lbnUgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgncG9wdXBtZW51Jyk7XG5cbiAgICAgIC8vIGJpbmQgdG8ganF1ZXJ5IGV2ZW50cyBhbmQgZW1pdCBhcyBhbmd1bGFyIGV2ZW50c1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdzZWxlY3RlZCcsIChlOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFyZ3M6IEpRdWVyeSkgPT5cbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMuc2VsZWN0ZWQuZW1pdCh7IGUsIGFyZ3MgfSkpKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdwb3B1cG1lbnVhZnRlcnBsYWNlJywgKGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgYXJnczogSlF1ZXJ5KSA9PlxuICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5wb3B1cG1lbnVhZnRlcnBsYWNlLmVtaXQoeyBlLCBhcmdzIH0pKSk7XG5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignYmVmb3Jlb3BlbicsIChlOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFyZ3M6IEpRdWVyeSkgPT5cbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMuYmVmb3Jlb3Blbi5lbWl0KHsgZSwgYXJncyB9KSkpO1xuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ29wZW4nLCAoZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBhcmdzOiBKUXVlcnkpID0+XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLm9wZW4uZW1pdCh7IGUsIGFyZ3MgfSkpKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdhZnRlcm9wZW4nLCAoZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBhcmdzOiBKUXVlcnkpID0+XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmFmdGVyb3Blbi5lbWl0KHsgZSwgYXJncyB9KSkpO1xuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ2Nsb3NlJywgKGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgYXJnczogSlF1ZXJ5KSA9PlxuICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5jbG9zZUV2ZW50LmVtaXQoeyBlLCBhcmdzIH0pKSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgc2VsZWN0ZWQgaHRtbCBlbGVtZW50LlxuICAgKi9cbiAgZ2V0U2VsZWN0ZWQoKTogYW55IHtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgIHJldHVybiB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLnBvcHVwbWVudT8uZ2V0U2VsZWN0ZWQoKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnRyb2wgdG8gcmVmbGVjdCB0aGUgc2V0dGluZ3MuXG4gICAqL1xuICB1cGRhdGVkKHNldHRpbmdzOiBhbnkpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wb3B1cG1lbnUpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMucG9wdXBtZW51Py51cGRhdGVkKHNldHRpbmdzKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRlYXIgZG93biB0aGUgbWFya3VwIGZvciB0aGUgcG9wdXAgbWVudVxuICAgKi9cbiAgdGVhcmRvd24oKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucG9wdXBtZW51KSB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLnBvcHVwbWVudT8udGVhcmRvd24oKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgcG9wdXAgbWVudVxuICAgKi9cbiAgY2xvc2UoaXNDYW5jZWxsZWQ/OiBib29sZWFuLCBub0ZvY3VzPzogYm9vbGVhbik6IHZvaWQge1xuICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5wb3B1cG1lbnU/LmNsb3NlKGlzQ2FuY2VsbGVkLCBub0ZvY3VzKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3kgdGhlIG1hcmt1cCBhbmQgYW55IG90aGVyIHJlc291cmNlcy5cbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcHVwbWVudSkge1xuICAgICAgICAgIHRoaXMucG9wdXBtZW51LmRlc3Ryb3koKTtcbiAgICAgICAgICB0aGlzLnBvcHVwbWVudSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgMjAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIGp1c3QgYmVmb3JlIEFuZ3VsYXIgZGVzdHJveXMgdGhlIGNvbXBvbmVudC5cbiAgICogVW5zdWJzY3JpYmUgb2JzZXJ2YWJsZXMsIGRldGFjaCBldmVudCBoYW5kbGVycyBhbmQgcmVtb3ZlIG90aGVyIHJlc291cmNlcyB0byBhdm9pZCBtZW1vcnkgbGVha3MuXG4gICAqL1xuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3koKTtcbiAgfVxufVxuIl19