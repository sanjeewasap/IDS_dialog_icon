// tslint:disable-next-line:no-unused-variable
import { ChangeDetectionStrategy, Component, Input, } from '@angular/core';
import * as i0 from "@angular/core";
/**
 * Angular Wrapper for the Soho Module Nav control.
 * This Component attaches to an element annotated with the `soho-module-nav` attribute,
 */
export class SohoModuleNavComponent {
    /** Constructor. */
    constructor(elementRef, ngZone) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        /** Stored settings */
        this._options = {
            accordionSettings: {},
            displayMode: false,
            initChildren: true,
            filterable: false,
            pinSections: false,
            showDetailView: false,
        };
        /** Internal use flags */
        this._updateRequired = false;
    }
    // -------------------------------------------
    // Inputs
    // -------------------------------------------
    set accordionSettings(val) {
        this._options.accordionSettings = val;
        this.updated({ accordionSettings: this._options.accordionSettings });
    }
    get accordionSettings() {
        return this.modulenav?.settings.accordionSettings || this._options.accordionSettings;
    }
    set displayMode(val) {
        this._options.displayMode = val;
        this.updated({ displayMode: this._options.displayMode });
    }
    get displayMode() {
        return this.modulenav?.settings.displayMode || this._options.displayMode;
    }
    set filterable(val) {
        this._options.filterable = val;
        this.updated({ filterable: this._options.filterable });
    }
    get filterable() {
        return this.modulenav?.settings.filterable || this._options.filterable || false;
    }
    set initChildren(val) {
        this._options.initChildren = val;
        this.updated({ initChildren: this._options.initChildren });
    }
    get initChildren() {
        return this.modulenav?.settings.initChildren || this._options.initChildren || false;
    }
    set pinSections(val) {
        this._options.pinSections = val;
        this.updated({ pinSections: this._options.pinSections });
    }
    get pinSections() {
        return this.modulenav?.settings.pinSections || this._options.pinSections || false;
    }
    set showDetailView(val) {
        this._options.showDetailView = val;
        this.updated({ showDetailView: this._options.showDetailView });
    }
    get showDetailView() {
        return this.modulenav?.settings.showDetailView || this._options.showDetailView || false;
    }
    // -------------------------------------------
    // Public API
    // -------------------------------------------
    accordionAPI() {
        return this.modulenav?.accordionAPI;
    }
    containerEl() {
        return this.modulenav?.containerEl;
    }
    switcherAPI() {
        return this.modulenav?.switcherAPI;
    }
    searchAPI() {
        return this.modulenav?.searchAPI;
    }
    settingsAPI() {
        return this.modulenav?.switcherAPI;
    }
    init() {
        this.modulenav?.init();
    }
    /** Triggers a UI Resync. */
    updated(val) {
        if (val) {
            this._options = jQuery.extend({}, this._options, val);
            if (this.modulenav) {
                this.ngZone.runOutsideAngular(() => {
                    this.modulenav?.updated(this._options);
                });
            }
        }
    }
    teardown() {
        this.modulenav?.teardown();
    }
    /**
     * Updates the accordion and expands the target header
     * @param sohoModuleNavComponent
     * @param target
     */
    updateLazy(sohoModuleNavComponent, target) {
        const $applicationMenu = jQuery(sohoModuleNavComponent.elementRef.nativeElement).data('modulenav');
        this.ngZone.runOutsideAngular(() => {
            setTimeout(() => {
                $applicationMenu.accordionAPI.updated();
                const header = jQuery(target).closest('.accordion-header');
                $applicationMenu.accordionAPI.expand(header);
            }, 1);
        });
    }
    // ------------------------------------------
    // Lifecycle Events
    // ------------------------------------------
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // Initialize/store instance
            this.jQueryElement = jQuery(this.elementRef.nativeElement);
            this.jQueryElement.modulenav(this._options);
            this.modulenav = this.jQueryElement.data('modulenav');
        });
    }
    ngAfterViewChecked() {
        if (this.modulenav && this._updateRequired) {
            this.ngZone.runOutsideAngular(() => this.modulenav?.updated(this._options));
            this._updateRequired = false;
        }
    }
    ngOnDestroy() {
        // call outside the angular zone so change detection
        // isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.modulenav) {
                this.modulenav.destroy();
                this.modulenav = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoModuleNavComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoModuleNavComponent, selector: "soho-module-nav, [soho-module-nav]", inputs: { accordionSettings: "accordionSettings", displayMode: "displayMode", filterable: "filterable", initChildren: "initChildren", pinSections: "pinSections", showDetailView: "showDetailView" }, ngImport: i0, template: "<ng-content id=\"nav\" [ngClass]=\"{ 'module-nav': true }\"></ng-content>\n", styles: ["soho-module-nav{display:contents}\n"], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoModuleNavComponent, decorators: [{
            type: Component,
            args: [{ selector: 'soho-module-nav, [soho-module-nav]', changeDetection: ChangeDetectionStrategy.OnPush, template: "<ng-content id=\"nav\" [ngClass]=\"{ 'module-nav': true }\"></ng-content>\n", styles: ["soho-module-nav{display:contents}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { accordionSettings: [{
                type: Input
            }], displayMode: [{
                type: Input
            }], filterable: [{
                type: Input
            }], initChildren: [{
                type: Input
            }], pinSections: [{
                type: Input
            }], showDetailView: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1tb2R1bGUtbmF2LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvbW9kdWxlLW5hdi9zb2hvLW1vZHVsZS1uYXYuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9tb2R1bGUtbmF2L3NvaG8tbW9kdWxlLW5hdi5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw4Q0FBOEM7QUFDOUMsT0FBTyxFQUdMLHVCQUF1QixFQUN2QixTQUFTLEVBSVQsS0FBSyxHQUtOLE1BQU0sZUFBZSxDQUFDOztBQUV2Qjs7O0dBR0c7QUFPSCxNQUFNLE9BQU8sc0JBQXNCO0lBcUJqQyxtQkFBbUI7SUFDbkIsWUFDVSxVQUFzQixFQUN0QixNQUFjO1FBRGQsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBaEJ4QixzQkFBc0I7UUFDZCxhQUFRLEdBQXlCO1lBQ3ZDLGlCQUFpQixFQUFFLEVBQUU7WUFDckIsV0FBVyxFQUFFLEtBQUs7WUFDbEIsWUFBWSxFQUFFLElBQUk7WUFDbEIsVUFBVSxFQUFFLEtBQUs7WUFDakIsV0FBVyxFQUFFLEtBQUs7WUFDbEIsY0FBYyxFQUFFLEtBQUs7U0FDdEIsQ0FBQztRQUVGLHlCQUF5QjtRQUNqQixvQkFBZSxHQUFZLEtBQUssQ0FBQztJQU1yQyxDQUFDO0lBRUwsOENBQThDO0lBQzlDLFNBQVM7SUFDVCw4Q0FBOEM7SUFFOUMsSUFBYSxpQkFBaUIsQ0FBQyxHQUFxQztRQUNsRSxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixHQUFHLEdBQUcsQ0FBQztRQUN0QyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxD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QUUsQ0FBQztnQkFDekIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7YUFDdkI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7OEdBNUtVLHNCQUFzQjtrR0FBdEIsc0JBQXNCLGdSQzFCbkMsNkVBQ0E7OzJGRHlCYSxzQkFBc0I7a0JBTmxDLFNBQVM7K0JBQ0Usb0NBQW9DLG1CQUc3Qix1QkFBdUIsQ0FBQyxNQUFNO3NIQWlDbEMsaUJBQWlCO3NCQUE3QixLQUFLO2dCQVFPLFdBQVc7c0JBQXZCLEtBQUs7Z0JBUU8sVUFBVTtzQkFBdEIsS0FBSztnQkFRTyxZQUFZO3NCQUF4QixLQUFLO2dCQVFPLFdBQVc7c0JBQXZCLEtBQUs7Z0JBUU8sY0FBYztzQkFBMUIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby11bnVzZWQtdmFyaWFibGVcbmltcG9ydCB7XG4gIEFmdGVyVmlld0NoZWNrZWQsXG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCwgTmdab25lLFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dCxcbiAgUXVlcnlMaXN0LFxuICBmb3J3YXJkUmVmLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuLyoqXG4gKiBBbmd1bGFyIFdyYXBwZXIgZm9yIHRoZSBTb2hvIE1vZHVsZSBOYXYgY29udHJvbC5cbiAqIFRoaXMgQ29tcG9uZW50IGF0dGFjaGVzIHRvIGFuIGVsZW1lbnQgYW5ub3RhdGVkIHdpdGggdGhlIGBzb2hvLW1vZHVsZS1uYXZgIGF0dHJpYnV0ZSxcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc29oby1tb2R1bGUtbmF2LCBbc29oby1tb2R1bGUtbmF2XScsXG4gIHN0eWxlVXJsczogWycuL3NvaG8tbW9kdWxlLW5hdi5jb21wb25lbnQuY3NzJ10sXG4gIHRlbXBsYXRlVXJsOiAnc29oby1tb2R1bGUtbmF2LmNvbXBvbmVudC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgU29ob01vZHVsZU5hdkNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQsIE9uRGVzdHJveSB7XG5cbiAgLyoqIFJlZmVyZW5jZSB0byB0aGUgalF1ZXJ5IGVsZW1lbnQuICovXG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcblxuICAvKiogUmVmZXJlbmNlIHRvIHRoZSBhbm5vdGF0ZWQgU29Ib1hpIGNvbnRyb2wgKi9cbiAgcHJpdmF0ZSBtb2R1bGVuYXY/OiBTb2hvTW9kdWxlTmF2U3RhdGljIHwgbnVsbDtcblxuICAvKiogU3RvcmVkIHNldHRpbmdzICovXG4gIHByaXZhdGUgX29wdGlvbnM6IFNvaG9Nb2R1bGVOYXZPcHRpb25zID0ge1xuICAgIGFjY29yZGlvblNldHRpbmdzOiB7fSxcbiAgICBkaXNwbGF5TW9kZTogZmFsc2UsXG4gICAgaW5pdENoaWxkcmVuOiB0cnVlLFxuICAgIGZpbHRlcmFibGU6IGZhbHNlLFxuICAgIHBpblNlY3Rpb25zOiBmYWxzZSxcbiAgICBzaG93RGV0YWlsVmlldzogZmFsc2UsXG4gIH07XG5cbiAgLyoqIEludGVybmFsIHVzZSBmbGFncyAqL1xuICBwcml2YXRlIF91cGRhdGVSZXF1aXJlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8qKiBDb25zdHJ1Y3Rvci4gKi9cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmUsXG4gICkgeyB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBJbnB1dHNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIEBJbnB1dCgpIHNldCBhY2NvcmRpb25TZXR0aW5ncyh2YWw6IFNvaG9BY2NvcmRpb25PcHRpb25zIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5hY2NvcmRpb25TZXR0aW5ncyA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBhY2NvcmRpb25TZXR0aW5nczogdGhpcy5fb3B0aW9ucy5hY2NvcmRpb25TZXR0aW5ncyB9KTtcbiAgfVxuICBwdWJsaWMgZ2V0IGFjY29yZGlvblNldHRpbmdzKCk6IFNvaG9BY2NvcmRpb25PcHRpb25zIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LnNldHRpbmdzLmFjY29yZGlvblNldHRpbmdzIHx8IHRoaXMuX29wdGlvbnMuYWNjb3JkaW9uU2V0dGluZ3M7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZGlzcGxheU1vZGUodmFsOiBTb2hvTW9kdWxlTmF2RGlzcGxheU1vZGUgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9vcHRpb25zLmRpc3BsYXlNb2RlID0gdmFsO1xuICAgIHRoaXMudXBkYXRlZCh7IGRpc3BsYXlNb2RlOiB0aGlzLl9vcHRpb25zLmRpc3BsYXlNb2RlIH0pO1xuICB9XG4gIHB1YmxpYyBnZXQgZGlzcGxheU1vZGUoKTogU29ob01vZHVsZU5hdkRpc3BsYXlNb2RlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LnNldHRpbmdzLmRpc3BsYXlNb2RlIHx8IHRoaXMuX29wdGlvbnMuZGlzcGxheU1vZGU7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZmlsdGVyYWJsZSh2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9vcHRpb25zLmZpbHRlcmFibGUgPSB2YWw7XG4gICAgdGhpcy51cGRhdGVkKHsgZmlsdGVyYWJsZTogdGhpcy5fb3B0aW9ucy5maWx0ZXJhYmxlIH0pO1xuICB9XG4gIHB1YmxpYyBnZXQgZmlsdGVyYWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LnNldHRpbmdzLmZpbHRlcmFibGUgfHwgdGhpcy5fb3B0aW9ucy5maWx0ZXJhYmxlIHx8IGZhbHNlO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGluaXRDaGlsZHJlbih2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9vcHRpb25zLmluaXRDaGlsZHJlbiA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBpbml0Q2hpbGRyZW46IHRoaXMuX29wdGlvbnMuaW5pdENoaWxkcmVuIH0pO1xuICB9XG4gIHB1YmxpYyBnZXQgaW5pdENoaWxkcmVuKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZW5hdj8uc2V0dGluZ3MuaW5pdENoaWxkcmVuIHx8IHRoaXMuX29wdGlvbnMuaW5pdENoaWxkcmVuIHx8IGZhbHNlO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHBpblNlY3Rpb25zKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuX29wdGlvbnMucGluU2VjdGlvbnMgPSB2YWw7XG4gICAgdGhpcy51cGRhdGVkKHsgcGluU2VjdGlvbnM6IHRoaXMuX29wdGlvbnMucGluU2VjdGlvbnMgfSk7XG4gIH1cbiAgcHVibGljIGdldCBwaW5TZWN0aW9ucygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LnNldHRpbmdzLnBpblNlY3Rpb25zIHx8IHRoaXMuX29wdGlvbnMucGluU2VjdGlvbnMgfHwgZmFsc2U7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc2hvd0RldGFpbFZpZXcodmFsOiBib29sZWFuKSB7XG4gICAgdGhpcy5fb3B0aW9ucy5zaG93RGV0YWlsVmlldyA9IHZhbDtcbiAgICB0aGlzLnVwZGF0ZWQoeyBzaG93RGV0YWlsVmlldzogdGhpcy5fb3B0aW9ucy5zaG93RGV0YWlsVmlldyB9KTtcbiAgfVxuICBwdWJsaWMgZ2V0IHNob3dEZXRhaWxWaWV3KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZW5hdj8uc2V0dGluZ3Muc2hvd0RldGFpbFZpZXcgfHwgdGhpcy5fb3B0aW9ucy5zaG93RGV0YWlsVmlldyB8fCBmYWxzZTtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gUHVibGljIEFQSVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgcHVibGljIGFjY29yZGlvbkFQSSgpOiBTb2hvQWNjb3JkaW9uU3RhdGljIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LmFjY29yZGlvbkFQSTtcbiAgfVxuXG4gIHB1YmxpYyBjb250YWluZXJFbCgpOiBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2Py5jb250YWluZXJFbDtcbiAgfVxuXG4gIHB1YmxpYyBzd2l0Y2hlckFQSSgpOiBTb2hvTW9kdWxlTmF2U3dpdGNoZXJTdGF0aWMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm1vZHVsZW5hdj8uc3dpdGNoZXJBUEk7XG4gIH1cblxuICBwdWJsaWMgc2VhcmNoQVBJKCk6IFNvaG9TZWFyY2hGaWVsZFN0YXRpYyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubW9kdWxlbmF2Py5zZWFyY2hBUEk7XG4gIH1cblxuICBwdWJsaWMgc2V0dGluZ3NBUEkoKTogU29ob01vZHVsZU5hdlNldHRpbmdzU3RhdGljIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVuYXY/LnN3aXRjaGVyQVBJO1xuICB9XG5cbiAgcHVibGljIGluaXQoKSB7XG4gICAgdGhpcy5tb2R1bGVuYXY/LmluaXQoKTtcbiAgfVxuXG4gIC8qKiBUcmlnZ2VycyBhIFVJIFJlc3luYy4gKi9cbiAgcHVibGljIHVwZGF0ZWQodmFsPzogU29ob01vZHVsZU5hdk9wdGlvbnMpIHtcbiAgICBpZiAodmFsKSB7XG4gICAgICB0aGlzLl9vcHRpb25zID0galF1ZXJ5LmV4dGVuZCh7fSwgdGhpcy5fb3B0aW9ucywgdmFsKTtcbiAgICAgIGlmICh0aGlzLm1vZHVsZW5hdikge1xuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5tb2R1bGVuYXY/LnVwZGF0ZWQodGhpcy5fb3B0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB0ZWFyZG93bigpIHtcbiAgICB0aGlzLm1vZHVsZW5hdj8udGVhcmRvd24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBhY2NvcmRpb24gYW5kIGV4cGFuZHMgdGhlIHRhcmdldCBoZWFkZXJcbiAgICogQHBhcmFtIHNvaG9Nb2R1bGVOYXZDb21wb25lbnRcbiAgICogQHBhcmFtIHRhcmdldFxuICAgKi9cbiAgcHVibGljIHVwZGF0ZUxhenkoc29ob01vZHVsZU5hdkNvbXBvbmVudDogU29ob01vZHVsZU5hdkNvbXBvbmVudCwgdGFyZ2V0OiBhbnkpIHtcbiAgICBjb25zdCAkYXBwbGljYXRpb25NZW51ID0galF1ZXJ5KHNvaG9Nb2R1bGVOYXZDb21wb25lbnQuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KS5kYXRhKCdtb2R1bGVuYXYnKTtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgJGFwcGxpY2F0aW9uTWVudS5hY2NvcmRpb25BUEkudXBkYXRlZCgpO1xuICAgICAgICBjb25zdCBoZWFkZXIgPSBqUXVlcnkodGFyZ2V0KS5jbG9zZXN0KCcuYWNjb3JkaW9uLWhlYWRlcicpO1xuICAgICAgICAkYXBwbGljYXRpb25NZW51LmFjY29yZGlvbkFQSS5leHBhbmQoaGVhZGVyKTtcbiAgICAgIH0sIDEpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIExpZmVjeWNsZSBFdmVudHNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIC8vIEluaXRpYWxpemUvc3RvcmUgaW5zdGFuY2VcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQubW9kdWxlbmF2KHRoaXMuX29wdGlvbnMpO1xuICAgICAgdGhpcy5tb2R1bGVuYXYgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnbW9kdWxlbmF2Jyk7XG4gICAgfSk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XG4gICAgaWYgKHRoaXMubW9kdWxlbmF2ICYmIHRoaXMuX3VwZGF0ZVJlcXVpcmVkKSB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLm1vZHVsZW5hdj8udXBkYXRlZCh0aGlzLl9vcHRpb25zKSk7XG4gICAgICB0aGlzLl91cGRhdGVSZXF1aXJlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb25cbiAgICAvLyBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9mZigpO1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tb2R1bGVuYXYpIHtcbiAgICAgICAgdGhpcy5tb2R1bGVuYXYuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm1vZHVsZW5hdiA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsIjxuZy1jb250ZW50IGlkPVwibmF2XCIgW25nQ2xhc3NdPVwieyAnbW9kdWxlLW5hdic6IHRydWUgfVwiPjwvbmctY29udGVudD5cbiJdfQ==