import { Directive, EventEmitter, Input, Output, } from '@angular/core';
import * as i0 from "@angular/core";
/**
 * Angular Wrapper for the enterprise personalise widget.
 *
 * This component searches for an element with the attribute
 * 'soho-personalize'.
 */
export class SohoPersonalizeDirective {
    /** The starting color. */
    set colors(colors) {
        this.options.colors = colors;
        if (this.personalize) {
            this.ngZone.runOutsideAngular(() => {
                this.personalize?.setColors(colors);
            });
        }
    }
    /** The starting theme. */
    set theme(theme) {
        this.options.theme = theme;
        if (this.personalize) {
            this.ngZone.runOutsideAngular(() => {
                this.personalize?.setTheme(theme);
            });
        }
    }
    /**
     * Constructor.
     */
    constructor(ngZone) {
        this.ngZone = ngZone;
        /** Options. */
        this.options = {};
        this.changetheme = new EventEmitter();
        this.changecolors = new EventEmitter();
    }
    /**
     * After the control has been initialised, and the view is ready,
     * get the SoHoXi controls to apply any renderings.
     */
    ngAfterViewInit() {
        // call outside the angular zone so change detection
        // isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            // assign element to local variable - not this must attach to a root
            // element in this case 'body'
            this.jQueryElement = jQuery('html');
            // Check the element has attached to the body.
            if (this.jQueryElement.length === 0) {
                throw Error('No html tag found');
            }
            this.jQueryElement
                .on('themechanged', (ev, theme) => {
                this.onChangeTheme(ev, theme);
            })
                .on('colorschanged', (ev, colors) => {
                this.onChangeColors(ev, colors);
            });
            /**
             * Bind to jQueryElement's events
             */
            this.jQueryElement.personalize(this.options);
            // extract the api
            this.personalize = this.jQueryElement.data('personalize');
        });
    }
    /**
     * The theme currently set
     */
    get currentTheme() {
        return Soho.theme.currentTheme;
    }
    /**
     * Return a list of all the available themes.
     *
     * @returns The list of themes.
     */
    themes() {
        return Soho.theme.themes();
    }
    /**
     * Return the colors used in the current theme that are recommended for personalization.
     *
     * @returns An object full of the colors with id, name, and hex value.
     */
    personalizationColors() {
        return Soho.theme.personalizationColors();
    }
    onChangeTheme(e, theme) {
        this.ngZone.run(() => {
            const event = e;
            event.theme = theme;
            // Set the legacy property
            event.data = theme;
            this.changetheme.emit(event);
        });
    }
    onChangeColors(e, colors) {
        this.ngZone.run(() => {
            const event = e;
            event.colors = colors;
            // Set the legacy property
            event.data = colors;
            this.changecolors.emit(event);
        });
    }
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.personalize) {
                this.personalize?.destroy();
                this.personalize = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPersonalizeDirective, deps: [{ token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.1.4", type: SohoPersonalizeDirective, selector: "[soho-personalize]", inputs: { options: "options", colors: "colors", theme: "theme" }, outputs: { changetheme: "changetheme", changecolors: "changecolors" }, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoPersonalizeDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[soho-personalize]',
                }]
        }], ctorParameters: function () { return [{ type: i0.NgZone }]; }, propDecorators: { options: [{
                type: Input
            }], colors: [{
                type: Input
            }], theme: [{
                type: Input
            }], changetheme: [{
                type: Output
            }], changecolors: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1wZXJzb25hbGl6ZS5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZHMtZW50ZXJwcmlzZS1uZy9zcmMvbGliL3BlcnNvbmFsaXplL3NvaG8tcGVyc29uYWxpemUuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLEtBQUssRUFDTCxNQUFNLEdBR1AsTUFBTSxlQUFlLENBQUM7O0FBRXZCOzs7OztHQUtHO0FBSUgsTUFBTSxPQUFPLHdCQUF3QjtJQUtuQywwQkFBMEI7SUFDMUIsSUFBYSxNQUFNLENBQUMsTUFBc0M7UUFDeEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQzdCLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNwQixJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRTtnQkFDakMsSUFBSSxDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdEMsQ0FBQyxDQUFDLENBQUM7U0FDSjtJQUNILENBQUM7SUFFRCwwQkFBMEI7SUFDMUIsSUFBYSxLQUFLLENBQUMsS0FBYTtRQUM5QixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDM0IsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3BCLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsR0FBRyxFQUFFO2dCQUNqQyxJQUFJLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztJQVlEOztPQUVHO0lBQ0gsWUFDVSxNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQXJDeEIsZUFBZTtRQUNDLFlBQU8sR0FBMkIsRUFBRSxDQUFDO1FB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LElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtnQkFDcEIsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLEVBQUUsQ0FBQztnQkFDNUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7YUFDekI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7OEdBeklVLHdCQUF3QjtrR0FBeEIsd0JBQXdCOzsyRkFBeEIsd0JBQXdCO2tCQUhwQyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxvQkFBb0I7aUJBQy9COzZGQUlpQixPQUFPO3NCQUF0QixLQUFLO2dCQUdPLE1BQU07c0JBQWxCLEtBQUs7Z0JBVU8sS0FBSztzQkFBakIsS0FBSztnQkFTSSxXQUFXO3NCQUFwQixNQUFNO2dCQUVHLFlBQVk7c0JBQXJCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBEaXJlY3RpdmUsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE91dHB1dCxcbiAgTmdab25lLFxuICBPbkRlc3Ryb3ksXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG4vKipcbiAqIEFuZ3VsYXIgV3JhcHBlciBmb3IgdGhlIGVudGVycHJpc2UgcGVyc29uYWxpc2Ugd2lkZ2V0LlxuICpcbiAqIFRoaXMgY29tcG9uZW50IHNlYXJjaGVzIGZvciBhbiBlbGVtZW50IHdpdGggdGhlIGF0dHJpYnV0ZVxuICogJ3NvaG8tcGVyc29uYWxpemUnLlxuICovXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbc29oby1wZXJzb25hbGl6ZV0nLFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvUGVyc29uYWxpemVEaXJlY3RpdmUgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuXG4gIC8qKiBPcHRpb25zLiAqL1xuICBASW5wdXQoKSBwdWJsaWMgb3B0aW9uczogU29ob1BlcnNvbmFsaXplT3B0aW9ucyA9IHt9O1xuXG4gIC8qKiBUaGUgc3RhcnRpbmcgY29sb3IuICovXG4gIEBJbnB1dCgpIHNldCBjb2xvcnMoY29sb3JzOiBzdHJpbmcgfCBTb2hvUGVyc29uYWxpemVDb2xvcnMpIHtcbiAgICB0aGlzLm9wdGlvbnMuY29sb3JzID0gY29sb3JzO1xuICAgIGlmICh0aGlzLnBlcnNvbmFsaXplKSB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgIHRoaXMucGVyc29uYWxpemU/LnNldENvbG9ycyhjb2xvcnMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBzdGFydGluZyB0aGVtZS4gKi9cbiAgQElucHV0KCkgc2V0IHRoZW1lKHRoZW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLm9wdGlvbnMudGhlbWUgPSB0aGVtZTtcbiAgICBpZiAodGhpcy5wZXJzb25hbGl6ZSkge1xuICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICB0aGlzLnBlcnNvbmFsaXplPy5zZXRUaGVtZSh0aGVtZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBAT3V0cHV0KCkgY2hhbmdldGhlbWUgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9DaGFuZ2VUaGVtZVBlcnNvbmFsaXplRXZlbnQ+KCk7XG5cbiAgQE91dHB1dCgpIGNoYW5nZWNvbG9ycyA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob0NoYW5nZUNvbG9yc1BlcnNvbmFsaXplRXZlbnQ+KCk7XG5cbiAgLyoqIEVQIGFwaSAqL1xuICBwcml2YXRlIHBlcnNvbmFsaXplPzogU29ob1BlcnNvbmFsaXplU3RhdGljIHwgbnVsbDtcblxuICAvKiogalF1ZXJ5IFdpZGdldCAqL1xuICBwcml2YXRlIGpRdWVyeUVsZW1lbnQ/OiBKUXVlcnk8SFRNTEVsZW1lbnQ+O1xuXG4gIC8qKlxuICAgKiBDb25zdHJ1Y3Rvci5cbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmUpIHtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZnRlciB0aGUgY29udHJvbCBoYXMgYmVlbiBpbml0aWFsaXNlZCwgYW5kIHRoZSB2aWV3IGlzIHJlYWR5LFxuICAgKiBnZXQgdGhlIFNvSG9YaSBjb250cm9scyB0byBhcHBseSBhbnkgcmVuZGVyaW5ncy5cbiAgICovXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uXG4gICAgLy8gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAvLyBhc3NpZ24gZWxlbWVudCB0byBsb2NhbCB2YXJpYWJsZSAtIG5vdCB0aGlzIG11c3QgYXR0YWNoIHRvIGEgcm9vdFxuICAgICAgLy8gZWxlbWVudCBpbiB0aGlzIGNhc2UgJ2JvZHknXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSBqUXVlcnkoJ2h0bWwnKTtcblxuICAgICAgLy8gQ2hlY2sgdGhlIGVsZW1lbnQgaGFzIGF0dGFjaGVkIHRvIHRoZSBib2R5LlxuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ05vIGh0bWwgdGFnIGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudFxuICAgICAgICAub24oJ3RoZW1lY2hhbmdlZCcsXG4gICAgICAgICAgKGV2OiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIHRoZW1lOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2VUaGVtZShldiwgdGhlbWUpO1xuICAgICAgICAgIH0pXG4gICAgICAgIC5vbignY29sb3JzY2hhbmdlZCcsXG4gICAgICAgICAgKGV2OiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGNvbG9yczogYW55KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ29sb3JzKGV2LCBjb2xvcnMpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAvKipcbiAgICAgICAqIEJpbmQgdG8galF1ZXJ5RWxlbWVudCdzIGV2ZW50c1xuICAgICAgICovXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQucGVyc29uYWxpemUodGhpcy5vcHRpb25zKTtcblxuICAgICAgLy8gZXh0cmFjdCB0aGUgYXBpXG4gICAgICB0aGlzLnBlcnNvbmFsaXplID0gdGhpcy5qUXVlcnlFbGVtZW50LmRhdGEoJ3BlcnNvbmFsaXplJyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIHRoZW1lIGN1cnJlbnRseSBzZXRcbiAgICovXG4gIHB1YmxpYyBnZXQgY3VycmVudFRoZW1lKCk6IFNvaG9UaGVtZSB7XG4gICAgcmV0dXJuIFNvaG8udGhlbWUuY3VycmVudFRoZW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBhIGxpc3Qgb2YgYWxsIHRoZSBhdmFpbGFibGUgdGhlbWVzLlxuICAgKlxuICAgKiBAcmV0dXJucyBUaGUgbGlzdCBvZiB0aGVtZXMuXG4gICAqL1xuICBwdWJsaWMgdGhlbWVzKCk6IFNvaG9UaGVtZVtdIHtcbiAgICByZXR1cm4gU29oby50aGVtZS50aGVtZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGNvbG9ycyB1c2VkIGluIHRoZSBjdXJyZW50IHRoZW1lIHRoYXQgYXJlIHJlY29tbWVuZGVkIGZvciBwZXJzb25hbGl6YXRpb24uXG4gICAqXG4gICAqIEByZXR1cm5zIEFuIG9iamVjdCBmdWxsIG9mIHRoZSBjb2xvcnMgd2l0aCBpZCwgbmFtZSwgYW5kIGhleCB2YWx1ZS5cbiAgICovXG4gIHB1YmxpYyBwZXJzb25hbGl6YXRpb25Db2xvcnMoKTogU29ob1BlcnNvbmFsaXphdGlvbkNvbG9ycyB7XG4gICAgcmV0dXJuIFNvaG8udGhlbWUucGVyc29uYWxpemF0aW9uQ29sb3JzKCk7XG4gIH1cblxuICBvbkNoYW5nZVRoZW1lKGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgdGhlbWU6IHN0cmluZykge1xuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICBjb25zdCBldmVudCA9IGUgYXMgU29ob0NoYW5nZVRoZW1lUGVyc29uYWxpemVFdmVudDtcbiAgICAgIGV2ZW50LnRoZW1lID0gdGhlbWU7XG4gICAgICAvLyBTZXQgdGhlIGxlZ2FjeSBwcm9wZXJ0eVxuICAgICAgZXZlbnQuZGF0YSA9IHRoZW1lO1xuICAgICAgdGhpcy5jaGFuZ2V0aGVtZS5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIG9uQ2hhbmdlQ29sb3JzKGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgY29sb3JzOiBhbnkpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnQgPSBlIGFzIFNvaG9DaGFuZ2VDb2xvcnNQZXJzb25hbGl6ZUV2ZW50O1xuICAgICAgZXZlbnQuY29sb3JzID0gY29sb3JzO1xuICAgICAgLy8gU2V0IHRoZSBsZWdhY3kgcHJvcGVydHlcbiAgICAgIGV2ZW50LmRhdGEgPSBjb2xvcnM7XG4gICAgICB0aGlzLmNoYW5nZWNvbG9ycy5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcblxuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMucGVyc29uYWxpemUpIHtcbiAgICAgICAgdGhpcy5wZXJzb25hbGl6ZT8uZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnBlcnNvbmFsaXplID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIl19