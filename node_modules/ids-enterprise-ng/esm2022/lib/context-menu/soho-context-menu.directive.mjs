import { Component, Directive, EventEmitter, HostBinding, Input, Output } from '@angular/core';
import * as i0 from "@angular/core";
/**
 * SUB COMPONENT: SOHO-CONTEXT-MENU-HEADING
 */
export class SohoContextMenuHeadingComponent {
    get isHeading() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuHeadingComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuHeadingComponent, selector: "li[soho-context-menu-heading]", host: { properties: { "class.heading": "this.isHeading" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuHeadingComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-context-menu-heading]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isHeading: [{
                type: HostBinding,
                args: ['class.heading']
            }] } });
/**
 * SUB COMPONENT: SOHO-CONTEXT-MENU-SHORTCUT-TEXT
 */
export class SohoContextMenuShortCutTextComponent {
    get isShortCutText() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuShortCutTextComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuShortCutTextComponent, selector: "span[soho-context-menu-shortcut-text]", host: { properties: { "class.shortcut-text": "this.isShortCutText" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuShortCutTextComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'span[soho-context-menu-shortcut-text]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isShortCutText: [{
                type: HostBinding,
                args: ['class.shortcut-text']
            }] } });
/**
 * SUB COMPONENT: SOHO-CONTEXT-MENU-SEPARATOR
 */
export class SohoContextMenuSeparatorComponent {
    constructor() {
        this.singleSelectableSection = false;
        this.multiSelectableSection = false;
    }
    get isSeparator() {
        return true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuSeparatorComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuSeparatorComponent, selector: "li[soho-context-menu-separator]", inputs: { singleSelectableSection: "singleSelectableSection", multiSelectableSection: "multiSelectableSection" }, host: { properties: { "class.separator": "this.isSeparator", "class.single-selectable-section": "this.singleSelectableSection", "class.multi-selectable-section": "this.multiSelectableSection" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuSeparatorComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-context-menu-separator]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isSeparator: [{
                type: HostBinding,
                args: ['class.separator']
            }], singleSelectableSection: [{
                type: HostBinding,
                args: ['class.single-selectable-section']
            }, {
                type: Input
            }], multiSelectableSection: [{
                type: HostBinding,
                args: ['class.multi-selectable-section']
            }, {
                type: Input
            }] } });
/**
 * SUB COMPONENT: SOHO-CONTEXT-MENU-LABEL
 */
export class SohoContextMenuItemLabelComponent {
    get hrefAttr() {
        if (this.menuId) {
            return '#' + this.menuId;
        }
        if (this.menuUrl) {
            return this.menuUrl;
        }
        return '#';
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuItemLabelComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuItemLabelComponent, selector: "a[soho-context-menu-label]", inputs: { menuId: "menuId", menuUrl: "menuUrl" }, host: { properties: { "attr.href": "this.hrefAttr" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuItemLabelComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'a[soho-context-menu-label]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { hrefAttr: [{
                type: HostBinding,
                args: ['attr.href']
            }], menuId: [{
                type: Input
            }], menuUrl: [{
                type: Input
            }] } });
/**
 * SUB COMPONENT: SOHO-CONTEXT-MENU-ITEM
 */
export class SohoContextMenuItemComponent {
    constructor() {
        this.isSelectable = false;
        this.isDisabled = false;
        this.isIndented = false;
        this.subMenu = false;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuItemComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuItemComponent, selector: "li[soho-context-menu-item]", inputs: { isChecked: "isChecked", isSelectable: "isSelectable", isDisabled: "isDisabled", isIndented: "isIndented", subMenu: "subMenu" }, host: { properties: { "class.is-checked": "this.isChecked", "class.is-selectable": "this.isSelectable", "class.is-disabled": "this.isDisabled", "class.is-indented": "this.isIndented", "class.submenu": "this.subMenu" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuItemComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-context-menu-item]',
                    template: `<ng-content></ng-content>`
                }]
        }], propDecorators: { isChecked: [{
                type: HostBinding,
                args: ['class.is-checked']
            }, {
                type: Input
            }], isSelectable: [{
                type: HostBinding,
                args: ['class.is-selectable']
            }, {
                type: Input
            }], isDisabled: [{
                type: HostBinding,
                args: ['class.is-disabled']
            }, {
                type: Input
            }], isIndented: [{
                type: HostBinding,
                args: ['class.is-indented']
            }, {
                type: Input
            }], subMenu: [{
                type: HostBinding,
                args: ['class.submenu']
            }, {
                type: Input
            }] } });
/**
 * MAIN DIRECTIVE: SOHO-CONTEXT-MENU
 */
export class SohoContextMenuDirective {
    // -------------------------------------------
    // Component Inputs
    set trigger(trigger) {
        this.options.trigger = trigger;
        if (this.contextMenu) {
            this.contextMenu.settings.trigger = trigger;
            this.contextMenu?.updated();
        }
    }
    set menu(menu) {
        this.options.menu = menu;
        if (this.contextMenu) {
            this.contextMenu.settings.menu = menu;
            this.contextMenu?.updated();
        }
    }
    /** Auto Focus */
    set autoFocus(autoFocus) {
        this.options.autoFocus = autoFocus;
        if (this.contextMenu) {
            this.contextMenu.settings.autoFocus = autoFocus;
        }
    }
    get autoFocus() {
        if (this.contextMenu) {
            return this.contextMenu.settings.autoFocus;
        }
        return this.options.autoFocus;
    }
    /** Mouse focus. */
    set mouseFocus(mouseFocus) {
        this.options.mouseFocus = mouseFocus;
        if (this.contextMenu) {
            this.contextMenu.settings.mouseFocus = mouseFocus;
        }
    }
    get mouseFocus() {
        if (this.contextMenu) {
            return this.contextMenu.settings.mouseFocus;
        }
        return this.options.mouseFocus;
    }
    /** Attach to body. */
    set attachToBody(attachToBody) {
        this.options.attachToBody = attachToBody;
        if (this.contextMenu) {
            this.contextMenu.settings.attachToBody = attachToBody;
        }
    }
    get attachToBody() {
        if (this.contextMenu) {
            return this.contextMenu.settings.attachToBody;
        }
        return this.options.attachToBody;
    }
    set placementOpts(placementOpts) {
        this.options.placementOpts = placementOpts;
        if (this.contextMenu) {
            this.contextMenu.settings.placementOpts = placementOpts;
        }
    }
    get placementOpts() {
        if (this.contextMenu) {
            return this.contextMenu.settings.placementOpts;
        }
        return this.options.placementOpts;
    }
    set offset(offset) {
        this.options.offset = offset;
        if (this.contextMenu) {
            this.contextMenu.settings.offset = offset;
        }
    }
    get offset() {
        if (this.contextMenu) {
            return this.contextMenu.settings.offset;
        }
        return this.options.offset;
    }
    set removeOnDestroy(removeOnDestroy) {
        this.options.removeOnDestroy = removeOnDestroy;
        if (this.contextMenu) {
            this.contextMenu.settings.removeOnDestroy = removeOnDestroy;
        }
    }
    get removeOnDestroy() {
        if (this.contextMenu) {
            return this.contextMenu.settings.removeOnDestroy;
        }
        return this.options.removeOnDestroy;
    }
    /** beforeOpen - ajax callback for open event */
    set beforeOpen(beforeOpen) {
        this.options.beforeOpen = beforeOpen;
        if (this.contextMenu) {
            this.contextMenu.settings.beforeOpen = beforeOpen;
        }
    }
    get beforeOpen() {
        if (this.contextMenu) {
            return this.contextMenu.settings.beforeOpen;
        }
        return this.options.beforeOpen;
    }
    constructor(element, ngZone) {
        this.element = element;
        this.ngZone = ngZone;
        // -------------------------------------------
        // Default options block
        // -------------------------------------------
        this.options = {
            trigger: 'rightClick'
        };
        // -------------------------------------------
        // Component Output
        // -------------------------------------------
        this.selected = new EventEmitter();
        this.beforeopen = new EventEmitter();
        /**
         * @todo replace override of native attribute
         */
        // eslint-disable-next-line @angular-eslint/no-output-native, @angular-eslint/no-output-rename
        this.open = new EventEmitter();
        // using output renaming since close conflicts with the close method
        // in this class.
        this.closeEvent = new EventEmitter(); // eslint-disable-line
        this.listOffset = { x: 0, y: 0 };
        /** beforeOpen - ajax callback for open event */
        this.lazyLoad = false;
    }
    ngAfterViewInit() {
        if (!this.lazyLoad) {
            this.init();
        }
    }
    init() {
        this.ngZone.runOutsideAngular(() => {
            this.jQueryElement = jQuery(this.element.nativeElement);
            this.jQueryElement.popupmenu(this.options);
            this.contextMenu = this.jQueryElement.data('popupmenu');
            // Add listeners to emit events
            this.jQueryElement.on('selected', (e, args) => this.ngZone.run(() => this.selected.next({ e, args })));
            this.jQueryElement.on('beforeopen', (e, args) => this.ngZone.run(() => this.beforeopen.emit({ e, args })));
            this.jQueryElement.on('close', (e, args) => this.ngZone.run(() => this.closeEvent.emit({ e, args })));
            this.jQueryElement.on('open', (e, args) => this.ngZone.run(() => this.open.emit({ e, args })));
            this.jQueryElement.on('contextmenu', (e, api) => this.onContextMenu(e, api));
        });
    }
    onContextMenu(e, api) {
        if (api && api.elem) {
            this.ngZone.runOutsideAngular(() => {
                const elem = api.elem[0];
                const rect = elem.getBoundingClientRect();
                this.offset = { x: rect.x + this.listOffset.x, y: rect.y + this.listOffset.y };
                if (this.contextMenu) {
                    this.contextMenu.updated();
                    this.contextMenu.position(e);
                }
            });
        }
    }
    updated() {
        this.ngZone.runOutsideAngular(() => this.contextMenu?.updated());
    }
    teardown() {
        this.ngZone.runOutsideAngular(() => this.contextMenu?.teardown());
    }
    /**
     * Closes the popup menu
     *
     * @param isCancelled Internally set option used if the operation is a cancel.
     *  Wont matter for manual api call.
     * @param noFocus Do not return focus to the calling element (fx a button)
     */
    close(isCancelled, noFocus) {
        if (this.contextMenu) {
            this.ngZone.runOutsideAngular(() => this.contextMenu?.close(isCancelled, noFocus));
        }
    }
    ngOnDestroy() {
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.contextMenu) {
                // @todo raise an issue on this failing on removeData!
                // this.menuButton.destroy();
                this.contextMenu.destroy();
                this.contextMenu = null;
            }
        });
    }
    initializeComponent() {
        if (this.lazyLoad) {
            this.options.trigger = 'immediate';
            // Remove all existing events before re-initializing, or the events will keep getting listened
            // to (so on first click, listened to once. On second click, listened to twice).
            if (this.jQueryElement) {
                this.jQueryElement.off();
            }
            this.init();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuDirective, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "16.1.4", type: SohoContextMenuDirective, selector: "[soho-context-menu]", inputs: { trigger: "trigger", menu: "menu", autoFocus: "autoFocus", mouseFocus: "mouseFocus", attachToBody: "attachToBody", placementOpts: "placementOpts", offset: "offset", listOffset: "listOffset", removeOnDestroy: "removeOnDestroy", beforeOpen: "beforeOpen", lazyLoad: "lazyLoad" }, outputs: { selected: "selected", beforeopen: "beforeopen", open: "open", closeEvent: "close" }, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoContextMenuDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[soho-context-menu]', // eslint-disable-line
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { selected: [{
                type: Output
            }], beforeopen: [{
                type: Output
            }], open: [{
                type: Output
            }], closeEvent: [{
                type: Output,
                args: ['close']
            }], trigger: [{
                type: Input
            }], menu: [{
                type: Input
            }], autoFocus: [{
                type: Input
            }], mouseFocus: [{
                type: Input
            }], attachToBody: [{
                type: Input
            }], placementOpts: [{
                type: Input
            }], offset: [{
                type: Input
            }], listOffset: [{
                type: Input
            }], removeOnDestroy: [{
                type: Input
            }], beforeOpen: [{
                type: Input
            }], lazyLoad: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1jb250ZXh0LW1lbnUuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWRzLWVudGVycHJpc2Utbmcvc3JjL2xpYi9jb250ZXh0LW1lbnUvc29oby1jb250ZXh0LW1lbnUuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxTQUFTLEVBQ1QsU0FBUyxFQUVULFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUVMLE1BQU0sRUFDUCxNQUFNLGVBQWUsQ0FBQzs7QUFFdkI7O0dBRUc7QUFLSCxNQUFNLE9BQU8sK0JBQStCO0lBQzFDLElBQWtDLFNBQVM7UUFDekMsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDOzhHQUhVLCtCQUErQjtrR0FBL0IsK0JBQStCLGtJQUZoQywyQkFBMkI7OzJGQUUxQiwrQkFBK0I7a0JBSjNDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLCtCQUErQjtvQkFDekMsUUFBUSxFQUFFLDJCQUEyQjtpQkFDdEM7OEJBRW1DLFNBQVM7c0JBQTFDLFdBQVc7dUJBQUMsZUFBZTs7QUFLOUI7O0dBRUc7QUFLSCxNQUFNLE9BQU8sb0NBQW9DO0lBQy9DLElBQXdDLGNBQWM7UUFDcEQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDOzhHQUhVLG9DQUFvQztrR0FBcEMsb0NBQW9DLHFKQUZyQywyQkFBMkI7OzJGQUUxQixvQ0FBb0M7a0JBSmhELFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLHVDQUF1QztvQkFDakQsUUFBUSxFQUFFLDJCQUEyQjtpQkFDdEM7OEJBRXlDLGNBQWM7c0JBQXJELFdBQVc7dUJBQUMscUJBQXFCOztBQUtwQzs7R0FFRztBQUtILE1BQU0sT0FBTyxpQ0FBaUM7SUFKOUM7UUFRMkQsNEJBQXVCLEdBQUcsS0FBSyxDQUFDO1FBQ2pDLDJCQUFzQixHQUFHLEtBQUssQ0FBQztLQUN4RjtJQUxDLElBQW9DLFdB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QjtnQkFDN0IsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztnQkFDM0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7YUFDekI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTSxtQkFBbUI7UUFDeEIsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2pCLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQztZQUNuQyw4RkFBOEY7WUFDOUYsZ0ZBQWdGO1lBQ2hGLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsQ0FBQzthQUMxQjtZQUNELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNiO0lBQ0gsQ0FBQzs4R0FyUFUsd0JBQXdCO2tHQUF4Qix3QkFBd0I7OzJGQUF4Qix3QkFBd0I7a0JBSnBDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLHFCQUFxQixFQUFFLHNCQUFzQjtpQkFDeEQ7c0hBaUJXLFFBQVE7c0JBQWpCLE1BQU07Z0JBQ0csVUFBVTtzQkFBbkIsTUFBTTtnQkFNRyxJQUFJO3NCQUFiLE1BQU07Z0JBSVUsVUFBVTtzQkFBMUIsTUFBTTt1QkFBQyxPQUFPO2dCQUtGLE9BQU87c0JBQW5CLEtBQUs7Z0JBUU8sSUFBSTtzQkFBaEIsS0FBSztnQkFTTyxTQUFTO3NCQUFyQixLQUFLO2dCQWVPLFVBQVU7c0JBQXRCLEtBQUs7Z0JBZU8sWUFBWTtzQkFBeEIsS0FBSztnQkFjTyxhQUFhO3NCQUF6QixLQUFLO2dCQWNPLE1BQU07c0JBQWxCLEtBQUs7Z0JBY0csVUFBVTtzQkFBbEIsS0FBSztnQkFFTyxlQUFlO3NCQUEzQixLQUFLO2dCQWVPLFVBQVU7c0JBQXRCLEtBQUs7Z0JBZUcsUUFBUTtzQkFBaEIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENvbXBvbmVudCxcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCwgTmdab25lLFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuLyoqXG4gKiBTVUIgQ09NUE9ORU5UOiBTT0hPLUNPTlRFWFQtTUVOVS1IRUFESU5HXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2xpW3NvaG8tY29udGV4dC1tZW51LWhlYWRpbmddJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudUhlYWRpbmdDb21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmhlYWRpbmcnKSBnZXQgaXNIZWFkaW5nKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbi8qKlxuICogU1VCIENPTVBPTkVOVDogU09ITy1DT05URVhULU1FTlUtU0hPUlRDVVQtVEVYVFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzcGFuW3NvaG8tY29udGV4dC1tZW51LXNob3J0Y3V0LXRleHRdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudVNob3J0Q3V0VGV4dENvbXBvbmVudCB7XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2hvcnRjdXQtdGV4dCcpIGdldCBpc1Nob3J0Q3V0VGV4dCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG4vKipcbiAqIFNVQiBDT01QT05FTlQ6IFNPSE8tQ09OVEVYVC1NRU5VLVNFUEFSQVRPUlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdsaVtzb2hvLWNvbnRleHQtbWVudS1zZXBhcmF0b3JdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudVNlcGFyYXRvckNvbXBvbmVudCB7XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2VwYXJhdG9yJykgZ2V0IGlzU2VwYXJhdG9yKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2luZ2xlLXNlbGVjdGFibGUtc2VjdGlvbicpIEBJbnB1dCgpIHNpbmdsZVNlbGVjdGFibGVTZWN0aW9uID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MubXVsdGktc2VsZWN0YWJsZS1zZWN0aW9uJykgQElucHV0KCkgbXVsdGlTZWxlY3RhYmxlU2VjdGlvbiA9IGZhbHNlO1xufVxuXG4vKipcbiAqIFNVQiBDT01QT05FTlQ6IFNPSE8tQ09OVEVYVC1NRU5VLUxBQkVMXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Fbc29oby1jb250ZXh0LW1lbnUtbGFiZWxdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudUl0ZW1MYWJlbENvbXBvbmVudCB7XG4gIEBIb3N0QmluZGluZygnYXR0ci5ocmVmJykgZ2V0IGhyZWZBdHRyKCkge1xuICAgIGlmICh0aGlzLm1lbnVJZCkge1xuICAgICAgcmV0dXJuICcjJyArIHRoaXMubWVudUlkO1xuICAgIH1cbiAgICBpZiAodGhpcy5tZW51VXJsKSB7XG4gICAgICByZXR1cm4gdGhpcy5tZW51VXJsO1xuICAgIH1cbiAgICByZXR1cm4gJyMnO1xuICB9XG4gIEBJbnB1dCgpIG1lbnVJZD86IHN0cmluZztcbiAgQElucHV0KCkgbWVudVVybD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBTVUIgQ09NUE9ORU5UOiBTT0hPLUNPTlRFWFQtTUVOVS1JVEVNXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2xpW3NvaG8tY29udGV4dC1tZW51LWl0ZW1dJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudUl0ZW1Db21wb25lbnQge1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmlzLWNoZWNrZWQnKSBASW5wdXQoKSBpc0NoZWNrZWQ/OiBib29sZWFuO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmlzLXNlbGVjdGFibGUnKSBASW5wdXQoKSBpc1NlbGVjdGFibGUgPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pcy1kaXNhYmxlZCcpIEBJbnB1dCgpIGlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pcy1pbmRlbnRlZCcpIEBJbnB1dCgpIGlzSW5kZW50ZWQgPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5zdWJtZW51JykgQElucHV0KCkgc3ViTWVudSA9IGZhbHNlO1xufVxuXG4vKipcbiAqIE1BSU4gRElSRUNUSVZFOiBTT0hPLUNPTlRFWFQtTUVOVVxuICovXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbc29oby1jb250ZXh0LW1lbnVdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxufSlcblxuZXhwb3J0IGNsYXNzIFNvaG9Db250ZXh0TWVudURpcmVjdGl2ZSBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcbiAgcHJpdmF0ZSBjb250ZXh0TWVudT86IFNvaG9Qb3B1cE1lbnVTdGF0aWMgfCBudWxsO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gRGVmYXVsdCBvcHRpb25zIGJsb2NrXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgcHJpdmF0ZSBvcHRpb25zOiBTb2hvUG9wdXBNZW51T3B0aW9ucyA9IHtcbiAgICB0cmlnZ2VyOiAncmlnaHRDbGljaydcbiAgfTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIENvbXBvbmVudCBPdXRwdXRcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIEBPdXRwdXQoKSBzZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob0NvbnRleHRNZW51RXZlbnQ+KCk7XG4gIEBPdXRwdXQoKSBiZWZvcmVvcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvQ29udGV4dE1lbnVFdmVudD4oKTtcblxuICAvKipcbiAgICogQHRvZG8gcmVwbGFjZSBvdmVycmlkZSBvZiBuYXRpdmUgYXR0cmlidXRlXG4gICAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLW91dHB1dC1uYXRpdmUsIEBhbmd1bGFyLWVzbGludC9uby1vdXRwdXQtcmVuYW1lXG4gIEBPdXRwdXQoKSBvcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvQ29udGV4dE1lbnVFdmVudD4oKTtcblxuICAvLyB1c2luZyBvdXRwdXQgcmVuYW1pbmcgc2luY2UgY2xvc2UgY29uZmxpY3RzIHdpdGggdGhlIGNsb3NlIG1ldGhvZFxuICAvLyBpbiB0aGlzIGNsYXNzLlxuICBAT3V0cHV0KCdjbG9zZScpIGNsb3NlRXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Db250ZXh0TWVudUV2ZW50PigpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBDb21wb25lbnQgSW5wdXRzXG5cbiAgQElucHV0KCkgc2V0IHRyaWdnZXIodHJpZ2dlcjogU29ob1BvcHVwTWVudVRyaWdnZXIpIHtcbiAgICB0aGlzLm9wdGlvbnMudHJpZ2dlciA9IHRyaWdnZXI7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgICh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MudHJpZ2dlciA9IHRyaWdnZXI7XG4gICAgICB0aGlzLmNvbnRleHRNZW51Py51cGRhdGVkKCk7XG4gICAgfVxuICB9XG5cbiAgQElucHV0KCkgc2V0IG1lbnUobWVudTogc3RyaW5nKSB7XG4gICAgdGhpcy5vcHRpb25zLm1lbnUgPSBtZW51O1xuICAgIGlmICh0aGlzLmNvbnRleHRNZW51KSB7XG4gICAgICAodGhpcy5jb250ZXh0TWVudSBhcyBhbnkpLnNldHRpbmdzLm1lbnUgPSBtZW51O1xuICAgICAgdGhpcy5jb250ZXh0TWVudT8udXBkYXRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBBdXRvIEZvY3VzICovXG4gIEBJbnB1dCgpIHNldCBhdXRvRm9jdXMoYXV0b0ZvY3VzOiBib29sZWFuKSB7XG4gICAgdGhpcy5vcHRpb25zLmF1dG9Gb2N1cyA9IGF1dG9Gb2N1cztcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgKHRoaXMuY29udGV4dE1lbnUgYXMgYW55KS5zZXR0aW5ncy5hdXRvRm9jdXMgPSBhdXRvRm9jdXM7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGF1dG9Gb2N1cygpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MuYXV0b0ZvY3VzO1xuICAgIH1cbiAgICByZXR1cm4gKHRoaXMub3B0aW9ucyBhcyBhbnkpLmF1dG9Gb2N1cztcbiAgfVxuXG4gIC8qKiBNb3VzZSBmb2N1cy4gKi9cbiAgQElucHV0KCkgc2V0IG1vdXNlRm9jdXMobW91c2VGb2N1czogYm9vbGVhbikge1xuICAgIHRoaXMub3B0aW9ucy5tb3VzZUZvY3VzID0gbW91c2VGb2N1cztcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgKHRoaXMuY29udGV4dE1lbnUgYXMgYW55KS5zZXR0aW5ncy5tb3VzZUZvY3VzID0gbW91c2VGb2N1cztcbiAgICB9XG4gIH1cblxuICBnZXQgbW91c2VGb2N1cygpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgcmV0dXJuICh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MubW91c2VGb2N1cztcbiAgICB9XG4gICAgcmV0dXJuICh0aGlzLm9wdGlvbnMgYXMgYW55KS5tb3VzZUZvY3VzO1xuICB9XG5cbiAgLyoqIEF0dGFjaCB0byBib2R5LiAqL1xuICBASW5wdXQoKSBzZXQgYXR0YWNoVG9Cb2R5KGF0dGFjaFRvQm9keTogYm9vbGVhbikge1xuICAgIHRoaXMub3B0aW9ucy5hdHRhY2hUb0JvZHkgPSBhdHRhY2hUb0JvZHk7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgICh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MuYXR0YWNoVG9Cb2R5ID0gYXR0YWNoVG9Cb2R5O1xuICAgIH1cbiAgfVxuXG4gIGdldCBhdHRhY2hUb0JvZHkoKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5jb250ZXh0TWVudSBhcyBhbnkpLnNldHRpbmdzLmF0dGFjaFRvQm9keTtcbiAgICB9XG4gICAgcmV0dXJuICh0aGlzLm9wdGlvbnMgYXMgYW55KS5hdHRhY2hUb0JvZHk7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgcGxhY2VtZW50T3B0cyhwbGFjZW1lbnRPcHRzOiBTb2hvUG9wdXBtZW51UGxhY2VtZW50T3B0cykge1xuICAgIHRoaXMub3B0aW9ucy5wbGFjZW1lbnRPcHRzID0gcGxhY2VtZW50T3B0cztcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgKCh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MgYXMgYW55KS5wbGFjZW1lbnRPcHRzID0gcGxhY2VtZW50T3B0cztcbiAgICB9XG4gIH1cblxuICBnZXQgcGxhY2VtZW50T3B0cygpOiBTb2hvUG9wdXBtZW51UGxhY2VtZW50T3B0cyB7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5jb250ZXh0TWVudSBhcyBhbnkpLnNldHRpbmdzLnBsYWNlbWVudE9wdHM7XG4gICAgfVxuICAgIHJldHVybiAodGhpcy5vcHRpb25zIGFzIGFueSkucGxhY2VtZW50T3B0cztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBvZmZzZXQob2Zmc2V0OiBTb2hvUG9wdXBtZW51T2Zmc2V0KSB7XG4gICAgdGhpcy5vcHRpb25zLm9mZnNldCA9IG9mZnNldDtcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgKCh0aGlzLmNvbnRleHRNZW51IGFzIGFueSkuc2V0dGluZ3MgYXMgYW55KS5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG9mZnNldCgpOiBTb2hvUG9wdXBtZW51T2Zmc2V0IHtcbiAgICBpZiAodGhpcy5jb250ZXh0TWVudSkge1xuICAgICAgcmV0dXJuICgodGhpcy5jb250ZXh0TWVudSBhcyBhbnkpLnNldHRpbmdzIGFzIGFueSkub2Zmc2V0O1xuICAgIH1cbiAgICByZXR1cm4gKHRoaXMub3B0aW9ucyBhcyBhbnkpLm9mZnNldDtcbiAgfVxuXG4gIEBJbnB1dCgpIGxpc3RPZmZzZXQ6IFNvaG9Qb3B1cG1lbnVPZmZzZXQgPSB7IHg6IDAsIHk6IDAgfTtcblxuICBASW5wdXQoKSBzZXQgcmVtb3ZlT25EZXN0cm95KHJlbW92ZU9uRGVzdHJveTogYm9vbGVhbikge1xuICAgIHRoaXMub3B0aW9ucy5yZW1vdmVPbkRlc3Ryb3kgPSByZW1vdmVPbkRlc3Ryb3k7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgICh0aGlzLmNvbnRleHRNZW51LnNldHRpbmdzIGFzIGFueSkucmVtb3ZlT25EZXN0cm95ID0gcmVtb3ZlT25EZXN0cm95O1xuICAgIH1cbiAgfVxuXG4gIGdldCByZW1vdmVPbkRlc3Ryb3koKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5jb250ZXh0TWVudS5zZXR0aW5ncyBhcyBhbnkpLnJlbW92ZU9uRGVzdHJveTtcbiAgICB9XG4gICAgcmV0dXJuICh0aGlzLm9wdGlvbnMgYXMgYW55KS5yZW1vdmVPbkRlc3Ryb3k7XG4gIH1cblxuICAvKiogYmVmb3JlT3BlbiAtIGFqYXggY2FsbGJhY2sgZm9yIG9wZW4gZXZlbnQgKi9cbiAgQElucHV0KCkgc2V0IGJlZm9yZU9wZW4oYmVmb3JlT3BlbjogU29ob1BvcHVwTWVudVNvdXJjZUZ1bmN0aW9uKSB7XG4gICAgdGhpcy5vcHRpb25zLmJlZm9yZU9wZW4gPSBiZWZvcmVPcGVuO1xuICAgIGlmICh0aGlzLmNvbnRleHRNZW51KSB7XG4gICAgICAodGhpcy5jb250ZXh0TWVudS5zZXR0aW5ncyBhcyBhbnkpLmJlZm9yZU9wZW4gPSBiZWZvcmVPcGVuO1xuICAgIH1cbiAgfVxuXG4gIGdldCBiZWZvcmVPcGVuKCk6IFNvaG9Qb3B1cE1lbnVTb3VyY2VGdW5jdGlvbiB7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgIHJldHVybiAodGhpcy5jb250ZXh0TWVudS5zZXR0aW5ncyBhcyBhbnkpLmJlZm9yZU9wZW47XG4gICAgfVxuICAgIHJldHVybiAodGhpcy5vcHRpb25zIGFzIGFueSkuYmVmb3JlT3BlbjtcbiAgfVxuXG4gIC8qKiBiZWZvcmVPcGVuIC0gYWpheCBjYWxsYmFjayBmb3Igb3BlbiBldmVudCAqL1xuICBASW5wdXQoKSBsYXp5TG9hZCA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZiwgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSkgeyB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGlmICghdGhpcy5sYXp5TG9hZCkge1xuICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpbml0KCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQucG9wdXBtZW51KHRoaXMub3B0aW9ucyk7XG4gICAgICB0aGlzLmNvbnRleHRNZW51ID0gdGhpcy5qUXVlcnlFbGVtZW50LmRhdGEoJ3BvcHVwbWVudScpO1xuXG4gICAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIGVtaXQgZXZlbnRzXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ3NlbGVjdGVkJywgKGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgYXJnczogSlF1ZXJ5KSA9PlxuICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5zZWxlY3RlZC5uZXh0KHsgZSwgYXJncyB9KSkpO1xuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ2JlZm9yZW9wZW4nLCAoZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBhcmdzOiBKUXVlcnkpID0+XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLmJlZm9yZW9wZW4uZW1pdCh7IGUsIGFyZ3MgfSkpKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdjbG9zZScsIChlOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFyZ3M6IEpRdWVyeSkgPT5cbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHRoaXMuY2xvc2VFdmVudC5lbWl0KHsgZSwgYXJncyB9KSkpO1xuXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ29wZW4nLCAoZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBhcmdzOiBKUXVlcnkpID0+XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLm9wZW4uZW1pdCh7IGUsIGFyZ3MgfSkpKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdjb250ZXh0bWVudScsIChlOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGFwaTogYW55KSA9PiB0aGlzLm9uQ29udGV4dE1lbnUoZSwgYXBpKSk7XG4gICAgfSk7XG4gIH1cblxuICBvbkNvbnRleHRNZW51KGU6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCwgYXBpOiBhbnkpIHtcbiAgICBpZiAoYXBpICYmIGFwaS5lbGVtKSB7XG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVsZW0gPSBhcGkuZWxlbVswXTtcbiAgICAgICAgY29uc3QgcmVjdCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHRoaXMub2Zmc2V0ID0geyB4OiByZWN0LnggKyB0aGlzLmxpc3RPZmZzZXQueCwgeTogcmVjdC55ICsgdGhpcy5saXN0T2Zmc2V0LnkgfTtcbiAgICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgICAgICB0aGlzLmNvbnRleHRNZW51LnVwZGF0ZWQoKTtcbiAgICAgICAgICAodGhpcy5jb250ZXh0TWVudSBhcyBhbnkpLnBvc2l0aW9uKGUpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZWQoKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy5jb250ZXh0TWVudT8udXBkYXRlZCgpKTtcbiAgfVxuXG4gIHRlYXJkb3duKCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuY29udGV4dE1lbnU/LnRlYXJkb3duKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgcG9wdXAgbWVudVxuICAgKlxuICAgKiBAcGFyYW0gaXNDYW5jZWxsZWQgSW50ZXJuYWxseSBzZXQgb3B0aW9uIHVzZWQgaWYgdGhlIG9wZXJhdGlvbiBpcyBhIGNhbmNlbC5cbiAgICogIFdvbnQgbWF0dGVyIGZvciBtYW51YWwgYXBpIGNhbGwuXG4gICAqIEBwYXJhbSBub0ZvY3VzIERvIG5vdCByZXR1cm4gZm9jdXMgdG8gdGhlIGNhbGxpbmcgZWxlbWVudCAoZnggYSBidXR0b24pXG4gICAqL1xuICBjbG9zZShpc0NhbmNlbGxlZD86IGJvb2xlYW4sIG5vRm9jdXM/OiBib29sZWFuKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY29udGV4dE1lbnUpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMuY29udGV4dE1lbnU/LmNsb3NlKGlzQ2FuY2VsbGVkLCBub0ZvY3VzKSk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub2ZmKCk7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmNvbnRleHRNZW51KSB7XG4gICAgICAgIC8vIEB0b2RvIHJhaXNlIGFuIGlzc3VlIG9uIHRoaXMgZmFpbGluZyBvbiByZW1vdmVEYXRhIVxuICAgICAgICAvLyB0aGlzLm1lbnVCdXR0b24uZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmNvbnRleHRNZW51LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5jb250ZXh0TWVudSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgaW5pdGlhbGl6ZUNvbXBvbmVudCgpIHtcbiAgICBpZiAodGhpcy5sYXp5TG9hZCkge1xuICAgICAgdGhpcy5vcHRpb25zLnRyaWdnZXIgPSAnaW1tZWRpYXRlJztcbiAgICAgIC8vIFJlbW92ZSBhbGwgZXhpc3RpbmcgZXZlbnRzIGJlZm9yZSByZS1pbml0aWFsaXppbmcsIG9yIHRoZSBldmVudHMgd2lsbCBrZWVwIGdldHRpbmcgbGlzdGVuZWRcbiAgICAgIC8vIHRvIChzbyBvbiBmaXJzdCBjbGljaywgbGlzdGVuZWQgdG8gb25jZS4gT24gc2Vjb25kIGNsaWNrLCBsaXN0ZW5lZCB0byB0d2ljZSkuXG4gICAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vZmYoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cbiAgfVxufVxuIl19