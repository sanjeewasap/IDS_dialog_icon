import { ChangeDetectionStrategy, Component, HostBinding, Input, Output, EventEmitter, } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoHomePageComponent {
    set homePageOptions(homePageOptions) {
        this._homePageOptions = homePageOptions;
    }
    get homePageOptions() {
        return this._homePageOptions;
    }
    /**
     * Whether to animate widget placement
     */
    set animate(animate) {
        this._homePageOptions.animate = animate;
        if (this.homepage) {
            this.homepage.settings.animate = animate;
        }
    }
    get animate() {
        return this._homePageOptions.animate;
    }
    /**
     * Sets the maximum number of widget columns
     */
    set columns(columns) {
        this._homePageOptions.columns = columns;
        if (this.homepage) {
            this.homepage.settings.columns = columns;
        }
    }
    get columns() {
        return this._homePageOptions.columns;
    }
    /**
     * Set edit for rearranging/reordering cards.
     */
    set editing(editing) {
        this._homePageOptions.editing = editing;
        if (this.homepage) {
            this.homepage.setEdit(editing);
        }
    }
    get editing() {
        return this._homePageOptions.editing;
    }
    /**
     * Specify the speed at which an animation progresses at different points within the animation.
     */
    set easing(easing) {
        this._homePageOptions.easing = easing;
        if (this.homepage) {
            this.homepage.settings.easing = easing;
        }
    }
    get easing() {
        return this._homePageOptions.easing;
    }
    /**
     * Sets gutter size in between widgets
     */
    set gutterSize(gutterSize) {
        this._homePageOptions.gutterSize = gutterSize;
        if (this.homepage) {
            this.homepage.settings.gutterSize = gutterSize;
        }
    }
    get gutterSize() {
        return this._homePageOptions.gutterSize;
    }
    /**
     * Sets the default widget width in pixels
     */
    set widgetWidth(widgetWidth) {
        this._homePageOptions.widgetWidth = widgetWidth;
        if (this.homepage) {
            this.homepage.settings.widgetWidth = widgetWidth;
        }
    }
    get widgetWidth() {
        return this._homePageOptions.widgetWidth;
    }
    /**
     * Sets the default widget height in pixels
     */
    set widgetHeight(widgetHeight) {
        this._homePageOptions.widgetHeight = widgetHeight;
        if (this.homepage) {
            this.homepage.settings.widgetHeight = widgetHeight;
        }
    }
    get widgetHeight() {
        return this._homePageOptions.widgetHeight;
    }
    /**
     * Sets the widgets to smaller size
     */
    set useSmall(useSmall) {
        this._homePageOptions.useSmall = useSmall;
        if (this.homepage) {
            this.homepage.settings.useSmall = useSmall;
        }
    }
    get useSmall() {
        return this._homePageOptions.useSmall;
    }
    /**
     * this ...
     */
    set timeout(timeout) {
        this._homePageOptions.timeout = timeout;
        if (this.homepage) {
            this.homepage.settings.timeout = timeout;
        }
    }
    get timeout() {
        return this._homePageOptions.timeout;
    }
    /**
     * Event fired before a card is removed
     *
     * @param beforeSelectFunction Function callback
     */
    set onBeforeRemoveCard(beforeSelectFunction) {
        this._homePageOptions.onBeforeRemoveCard = beforeSelectFunction;
        if (this.homepage) {
            this.homepage.settings.onBeforeRemoveCard = beforeSelectFunction;
        }
    }
    get onBeforeRemoveCard() {
        if (this.homepage) {
            return this.homepage.settings.onBeforeRemoveCard;
        }
        return this._homePageOptions.onBeforeRemoveCard;
    }
    constructor(elementRef, ngZone) {
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        /**
         * @todo replace override of native attribute
         */
        // eslint-disable-next-line @angular-eslint/no-output-rename, @angular-eslint/no-output-native
        this.resize = new EventEmitter();
        this.resizecard = new EventEmitter();
        this.reordercard = new EventEmitter();
        this.removecard = new EventEmitter();
        this.isHomepage = true;
        this._homePageOptions = {};
    }
    /**
     * Reset columns to their defaults (used on restore menu item).
     */
    refresh(animate) {
        return this.ngZone.runOutsideAngular(() => {
            this.homepage?.refresh(animate);
        });
    }
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            // Wrap for later.
            this.jQueryElement = jQuery(this.elementRef.nativeElement);
            // Initialise the SoHoXi control.
            this.jQueryElement.homepage(this._homePageOptions);
            // Once the control is initialised, extract the control
            // plug-in from the element.  The element name is
            // defined by the plug-in, but in this case is 'homepage'.
            this.homepage = this.jQueryElement.data('homepage');
            this.jQueryElement
                .on('resize', (_e, columns, metadata) => this.onResize(columns, metadata))
                .on('resizecard', (_e, card, metadata) => this.onResizeCard(card, metadata))
                .on('reordercard', (_e, card, metadata) => this.onReorderCard(card, metadata))
                .on('removecard', (_e, card, metadata) => this.onRemoveCard(card, metadata));
        });
    }
    onResize(columns, metadata) {
        const event = { columns: undefined, metadata: undefined };
        event.columns = columns;
        event.metadata = metadata;
        this.ngZone.run(() => {
            this.resize.emit(event);
        });
    }
    onResizeCard(card, metadata) {
        const event = { homepage: this, card, metadata };
        this.ngZone.run(() => {
            this.resizecard.emit(event);
        });
    }
    onReorderCard(card, metadata) {
        const event = { homepage: this, card, metadata };
        this.ngZone.run(() => {
            this.reordercard.emit(event);
        });
    }
    onRemoveCard(card, metadata) {
        const event = { homepage: this, card, metadata };
        this.ngZone.run(() => {
            this.removecard.emit(event);
        });
    }
    ngOnDestroy() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.homepage) {
                this.homepage.destroy();
                this.homepage = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHomePageComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoHomePageComponent, selector: "div[soho-homepage]", inputs: { homePageOptions: "homePageOptions", animate: "animate", columns: "columns", editing: "editing", easing: "easing", gutterSize: "gutterSize", widgetWidth: "widgetWidth", widgetHeight: "widgetHeight", useSmall: "useSmall", timeout: "timeout", onBeforeRemoveCard: "onBeforeRemoveCard" }, outputs: { resize: "resize", resizecard: "resizecard", reordercard: "reordercard", removecard: "removecard" }, host: { properties: { "class.homepage": "this.isHomepage" } }, ngImport: i0, template: `<div class="content"><ng-content></ng-content></div>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoHomePageComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'div[soho-homepage]',
                    template: `<div class="content"><ng-content></ng-content></div>`,
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { resize: [{
                type: Output
            }], resizecard: [{
                type: Output
            }], reordercard: [{
                type: Output
            }], removecard: [{
                type: Output
            }], homePageOptions: [{
                type: Input
            }], animate: [{
                type: Input
            }], columns: [{
                type: Input
            }], editing: [{
                type: Input
            }], easing: [{
                type: Input
            }], gutterSize: [{
                type: Input
            }], widgetWidth: [{
                type: Input
            }], widgetHeight: [{
                type: Input
            }], useSmall: [{
                type: Input
            }], timeout: [{
                type: Input
            }], onBeforeRemoveCard: [{
                type: Input
            }], isHomepage: [{
                type: HostBinding,
                args: ['class.homepage']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby1ob21lcGFnZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZHMtZW50ZXJwcmlzZS1uZy9zcmMvbGliL2hvbWVwYWdlL3NvaG8taG9tZXBhZ2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUVULFdBQVcsRUFDWCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFlBQVksR0FHYixNQUFNLGVBQWUsQ0FBQzs7QUFPdkIsTUFBTSxPQUFPLHFCQUFxQjtJQVdoQyxJQUFhLGVBQWUsQ0FBQyxlQUFvQztRQUMvRCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZUFBZSxDQUFDO0lBQzFDLENBQUM7SUFDRCxJQUFJLGVBQWU7UUFDakIsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0gsSUFBYSxPQUFPLENBQUMsT0FBNEI7UUFDL0MsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFDeEMsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2pCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7U0FDMUM7SUFDSCxDQUFDO0lBRUQsSUFBSSxPQUFPO1FBQ1QsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO0lBQ3ZDLENBQUM7SUFFRDs7T0FFRztJQUNILElBQWEsT0FBTyxDQUFDLE9BQTJCO1FBQzlDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3hDLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNqQixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1NBQzFDO0lBQ0gsQ0FBQztJQUVELElBQUksT0FBTztR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QXhDLFdBQVc7dUJBQUMsZ0JBQWdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgSG9zdEJpbmRpbmcsXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEV2ZW50RW1pdHRlcixcbiAgTmdab25lLFxuICBPbkRlc3Ryb3ksXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdkaXZbc29oby1ob21lcGFnZV0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPGRpdiBjbGFzcz1cImNvbnRlbnRcIj48bmctY29udGVudD48L25nLWNvbnRlbnQ+PC9kaXY+YCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgU29ob0hvbWVQYWdlQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICAvKipcbiAgICogQHRvZG8gcmVwbGFjZSBvdmVycmlkZSBvZiBuYXRpdmUgYXR0cmlidXRlXG4gICAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLW91dHB1dC1yZW5hbWUsIEBhbmd1bGFyLWVzbGludC9uby1vdXRwdXQtbmF0aXZlXG4gIEBPdXRwdXQoKSByZXNpemUgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Ib21lUGFnZUV2ZW50PigpO1xuICBAT3V0cHV0KCkgcmVzaXplY2FyZCA9IG5ldyBFdmVudEVtaXR0ZXI8U29ob0hvbWVQYWdlRWRpdEV2ZW50PigpO1xuICBAT3V0cHV0KCkgcmVvcmRlcmNhcmQgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Ib21lUGFnZUVkaXRFdmVudD4oKTtcbiAgQE91dHB1dCgpIHJlbW92ZWNhcmQgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9Ib21lUGFnZUVkaXRFdmVudD4oKTtcblxuICBASW5wdXQoKSBzZXQgaG9tZVBhZ2VPcHRpb25zKGhvbWVQYWdlT3B0aW9uczogU29ob0hvbWVQYWdlT3B0aW9ucykge1xuICAgIHRoaXMuX2hvbWVQYWdlT3B0aW9ucyA9IGhvbWVQYWdlT3B0aW9ucztcbiAgfVxuICBnZXQgaG9tZVBhZ2VPcHRpb25zKCk6IFNvaG9Ib21lUGFnZU9wdGlvbnMge1xuICAgIHJldHVybiB0aGlzLl9ob21lUGFnZU9wdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0byBhbmltYXRlIHdpZGdldCBwbGFjZW1lbnRcbiAgICovXG4gIEBJbnB1dCgpIHNldCBhbmltYXRlKGFuaW1hdGU6IGJvb2xlYW4gfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9ob21lUGFnZU9wdGlvbnMuYW5pbWF0ZSA9IGFuaW1hdGU7XG4gICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgIHRoaXMuaG9tZXBhZ2Uuc2V0dGluZ3MuYW5pbWF0ZSA9IGFuaW1hdGU7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGFuaW1hdGUoKTogYm9vbGVhbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy5hbmltYXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIG1heGltdW0gbnVtYmVyIG9mIHdpZGdldCBjb2x1bW5zXG4gICAqL1xuICBASW5wdXQoKSBzZXQgY29sdW1ucyhjb2x1bW5zOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9ob21lUGFnZU9wdGlvbnMuY29sdW1ucyA9IGNvbHVtbnM7XG4gICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgIHRoaXMuaG9tZXBhZ2Uuc2V0dGluZ3MuY29sdW1ucyA9IGNvbHVtbnM7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGNvbHVtbnMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5faG9tZVBhZ2VPcHRpb25zLmNvbHVtbnM7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGVkaXQgZm9yIHJlYXJyYW5naW5nL3Jlb3JkZXJpbmcgY2FyZHMuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgZWRpdGluZyhlZGl0aW5nOiBib29sZWFuIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5faG9tZVBhZ2VPcHRpb25zLmVkaXRpbmcgPSBlZGl0aW5nO1xuICAgIGlmICh0aGlzLmhvbWVwYWdlKSB7XG4gICAgICB0aGlzLmhvbWVwYWdlLnNldEVkaXQoKGVkaXRpbmcgYXMgYW55KSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVkaXRpbmcoKTogYm9vbGVhbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy5lZGl0aW5nO1xuICB9XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgdGhlIHNwZWVkIGF0IHdoaWNoIGFuIGFuaW1hdGlvbiBwcm9ncmVzc2VzIGF0IGRpZmZlcmVudCBwb2ludHMgd2l0aGluIHRoZSBhbmltYXRpb24uXG4gICAqL1xuICBASW5wdXQoKSBzZXQgZWFzaW5nKGVhc2luZzogRWFzaW5nVHlwZSB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy5lYXNpbmcgPSBlYXNpbmc7XG4gICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgIHRoaXMuaG9tZXBhZ2Uuc2V0dGluZ3MuZWFzaW5nID0gZWFzaW5nO1xuICAgIH1cbiAgfVxuXG4gIGdldCBlYXNpbmcoKTogRWFzaW5nVHlwZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy5lYXNpbmc7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBndXR0ZXIgc2l6ZSBpbiBiZXR3ZWVuIHdpZGdldHNcbiAgICovXG4gIEBJbnB1dCgpIHNldCBndXR0ZXJTaXplKGd1dHRlclNpemU6IG51bWJlciB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy5ndXR0ZXJTaXplID0gZ3V0dGVyU2l6ZTtcbiAgICBpZiAodGhpcy5ob21lcGFnZSkge1xuICAgICAgdGhpcy5ob21lcGFnZS5zZXR0aW5ncy5ndXR0ZXJTaXplID0gZ3V0dGVyU2l6ZTtcbiAgICB9XG4gIH1cblxuICBnZXQgZ3V0dGVyU2l6ZSgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9ob21lUGFnZU9wdGlvbnMuZ3V0dGVyU2l6ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBkZWZhdWx0IHdpZGdldCB3aWR0aCBpbiBwaXhlbHNcbiAgICovXG4gIEBJbnB1dCgpIHNldCB3aWRnZXRXaWR0aCh3aWRnZXRXaWR0aDogbnVtYmVyIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5faG9tZVBhZ2VPcHRpb25zLndpZGdldFdpZHRoID0gd2lkZ2V0V2lkdGg7XG4gICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgIHRoaXMuaG9tZXBhZ2Uuc2V0dGluZ3Mud2lkZ2V0V2lkdGggPSB3aWRnZXRXaWR0aDtcbiAgICB9XG4gIH1cblxuICBnZXQgd2lkZ2V0V2lkdGgoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5faG9tZVBhZ2VPcHRpb25zLndpZGdldFdpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGRlZmF1bHQgd2lkZ2V0IGhlaWdodCBpbiBwaXhlbHNcbiAgICovXG4gIEBJbnB1dCgpIHNldCB3aWRnZXRIZWlnaHQod2lkZ2V0SGVpZ2h0OiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9ob21lUGFnZU9wdGlvbnMud2lkZ2V0SGVpZ2h0ID0gd2lkZ2V0SGVpZ2h0O1xuICAgIGlmICh0aGlzLmhvbWVwYWdlKSB7XG4gICAgICB0aGlzLmhvbWVwYWdlLnNldHRpbmdzLndpZGdldEhlaWdodCA9IHdpZGdldEhlaWdodDtcbiAgICB9XG4gIH1cblxuICBnZXQgd2lkZ2V0SGVpZ2h0KCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy53aWRnZXRIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgd2lkZ2V0cyB0byBzbWFsbGVyIHNpemVcbiAgICovXG4gIEBJbnB1dCgpIHNldCB1c2VTbWFsbCh1c2VTbWFsbDogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy51c2VTbWFsbCA9IHVzZVNtYWxsO1xuICAgIGlmICh0aGlzLmhvbWVwYWdlKSB7XG4gICAgICB0aGlzLmhvbWVwYWdlLnNldHRpbmdzLnVzZVNtYWxsID0gdXNlU21hbGw7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHVzZVNtYWxsKCk6IGJvb2xlYW4gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9ob21lUGFnZU9wdGlvbnMudXNlU21hbGw7XG4gIH1cblxuICAvKipcbiAgICogdGhpcyAuLi5cbiAgICovXG4gIEBJbnB1dCgpIHNldCB0aW1lb3V0KHRpbWVvdXQ6IG51bWJlciB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX2hvbWVQYWdlT3B0aW9ucy50aW1lb3V0ID0gdGltZW91dDtcbiAgICBpZiAodGhpcy5ob21lcGFnZSkge1xuICAgICAgdGhpcy5ob21lcGFnZS5zZXR0aW5ncy50aW1lb3V0ID0gdGltZW91dDtcbiAgICB9XG4gIH1cblxuICBnZXQgdGltZW91dCgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9ob21lUGFnZU9wdGlvbnMudGltZW91dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmVudCBmaXJlZCBiZWZvcmUgYSBjYXJkIGlzIHJlbW92ZWRcbiAgICpcbiAgICogQHBhcmFtIGJlZm9yZVNlbGVjdEZ1bmN0aW9uIEZ1bmN0aW9uIGNhbGxiYWNrXG4gICAqL1xuICBASW5wdXQoKSBzZXQgb25CZWZvcmVSZW1vdmVDYXJkKGJlZm9yZVNlbGVjdEZ1bmN0aW9uOiBTb2hvSG9tZVBhZ2VCZWZvcmVSZW1vdmVDYXJkRnVuY3Rpb24gfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9ob21lUGFnZU9wdGlvbnMub25CZWZvcmVSZW1vdmVDYXJkID0gYmVmb3JlU2VsZWN0RnVuY3Rpb247XG4gICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgIHRoaXMuaG9tZXBhZ2Uuc2V0dGluZ3Mub25CZWZvcmVSZW1vdmVDYXJkID0gYmVmb3JlU2VsZWN0RnVuY3Rpb247XG4gICAgfVxuICB9XG5cbiAgZ2V0IG9uQmVmb3JlUmVtb3ZlQ2FyZCgpOiBTb2hvSG9tZVBhZ2VCZWZvcmVSZW1vdmVDYXJkRnVuY3Rpb24gfCB1bmRlZmluZWQge1xuICAgIGlmICh0aGlzLmhvbWVwYWdlKSB7XG4gICAgICByZXR1cm4gdGhpcy5ob21lcGFnZS5zZXR0aW5ncy5vbkJlZm9yZVJlbW92ZUNhcmQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9ob21lUGFnZU9wdGlvbnMub25CZWZvcmVSZW1vdmVDYXJkO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5ob21lcGFnZScpIGlzSG9tZXBhZ2UgPSB0cnVlO1xuXG4gIC8vIFJlZmVyZW5jZSB0byB0aGUgalF1ZXJ5IGVsZW1lbnQuXG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcblxuICAvLyBSZWZlcmVuY2UgdG8gdGhlIGFubm90YXRlZCBTb0hvWGkgY29udHJvbFxuICBwcml2YXRlIGhvbWVwYWdlPzogU29ob0hvbWVQYWdlU3RhdGljIHwgbnVsbDtcblxuICBwcml2YXRlIF9ob21lUGFnZU9wdGlvbnM6IFNvaG9Ib21lUGFnZU9wdGlvbnMgPSB7fTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcbiAgKSB7IH1cblxuICAvKipcbiAgICogUmVzZXQgY29sdW1ucyB0byB0aGVpciBkZWZhdWx0cyAodXNlZCBvbiByZXN0b3JlIG1lbnUgaXRlbSkuXG4gICAqL1xuICByZWZyZXNoKGFuaW1hdGU/OiBib29sZWFuKTogdm9pZCB7XG4gICAgcmV0dXJuIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHRoaXMuaG9tZXBhZ2U/LnJlZnJlc2goYW5pbWF0ZSk7XG4gICAgfSk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuXG4gICAgICAvLyBXcmFwIGZvciBsYXRlci5cbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIC8vIEluaXRpYWxpc2UgdGhlIFNvSG9YaSBjb250cm9sLlxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50LmhvbWVwYWdlKHRoaXMuX2hvbWVQYWdlT3B0aW9ucyk7XG5cbiAgICAgIC8vIE9uY2UgdGhlIGNvbnRyb2wgaXMgaW5pdGlhbGlzZWQsIGV4dHJhY3QgdGhlIGNvbnRyb2xcbiAgICAgIC8vIHBsdWctaW4gZnJvbSB0aGUgZWxlbWVudC4gIFRoZSBlbGVtZW50IG5hbWUgaXNcbiAgICAgIC8vIGRlZmluZWQgYnkgdGhlIHBsdWctaW4sIGJ1dCBpbiB0aGlzIGNhc2UgaXMgJ2hvbWVwYWdlJy5cbiAgICAgIHRoaXMuaG9tZXBhZ2UgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgnaG9tZXBhZ2UnKTtcblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50XG4gICAgICAgIC5vbigncmVzaXplJywgKF9lOiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQsIGNvbHVtbnM6IG51bWJlciwgbWV0YWRhdGE6IG9iamVjdCkgPT4gdGhpcy5vblJlc2l6ZShjb2x1bW5zLCBtZXRhZGF0YSkpXG4gICAgICAgIC5vbigncmVzaXplY2FyZCcsIChfZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBjYXJkOiBKUXVlcnksIG1ldGFkYXRhOiBvYmplY3QpID0+IHRoaXMub25SZXNpemVDYXJkKGNhcmQsIG1ldGFkYXRhKSlcbiAgICAgICAgLm9uKCdyZW9yZGVyY2FyZCcsIChfZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBjYXJkOiBKUXVlcnksIG1ldGFkYXRhOiBvYmplY3QpID0+IHRoaXMub25SZW9yZGVyQ2FyZChjYXJkLCBtZXRhZGF0YSkpXG4gICAgICAgIC5vbigncmVtb3ZlY2FyZCcsIChfZTogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50LCBjYXJkOiBKUXVlcnksIG1ldGFkYXRhOiBvYmplY3QpID0+IHRoaXMub25SZW1vdmVDYXJkKGNhcmQsIG1ldGFkYXRhKSk7XG4gICAgfSk7XG4gIH1cblxuICBvblJlc2l6ZShjb2x1bW5zOiBudW1iZXIsIG1ldGFkYXRhOiBvYmplY3QpIHtcbiAgICBjb25zdCBldmVudDogU29ob0hvbWVQYWdlRXZlbnQgPSB7IGNvbHVtbnM6IHVuZGVmaW5lZCwgbWV0YWRhdGE6IHVuZGVmaW5lZCB9O1xuICAgIGV2ZW50LmNvbHVtbnMgPSBjb2x1bW5zO1xuICAgIGV2ZW50Lm1ldGFkYXRhID0gbWV0YWRhdGE7XG5cbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgdGhpcy5yZXNpemUuZW1pdChldmVudCk7XG4gICAgfSk7XG4gIH1cblxuICBvblJlc2l6ZUNhcmQoY2FyZDogSlF1ZXJ5LCBtZXRhZGF0YTogb2JqZWN0KSB7XG4gICAgY29uc3QgZXZlbnQ6IFNvaG9Ib21lUGFnZUVkaXRFdmVudCA9IHsgaG9tZXBhZ2U6IHRoaXMsIGNhcmQsIG1ldGFkYXRhIH07XG5cbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgdGhpcy5yZXNpemVjYXJkLmVtaXQoZXZlbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgb25SZW9yZGVyQ2FyZChjYXJkOiBKUXVlcnksIG1ldGFkYXRhOiBvYmplY3QpIHtcbiAgICBjb25zdCBldmVudDogU29ob0hvbWVQYWdlRWRpdEV2ZW50ID0geyBob21lcGFnZTogdGhpcywgY2FyZCwgbWV0YWRhdGEgfTtcblxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICB0aGlzLnJlb3JkZXJjYXJkLmVtaXQoZXZlbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgb25SZW1vdmVDYXJkKGNhcmQ6IEpRdWVyeSwgbWV0YWRhdGE6IG9iamVjdCkge1xuICAgIGNvbnN0IGV2ZW50OiBTb2hvSG9tZVBhZ2VFZGl0RXZlbnQgPSB7IGhvbWVwYWdlOiB0aGlzLCBjYXJkLCBtZXRhZGF0YSB9O1xuXG4gICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgIHRoaXMucmVtb3ZlY2FyZC5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vZmYoKTtcbiAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaG9tZXBhZ2UpIHtcbiAgICAgICAgdGhpcy5ob21lcGFnZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuaG9tZXBhZ2UgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iXX0=