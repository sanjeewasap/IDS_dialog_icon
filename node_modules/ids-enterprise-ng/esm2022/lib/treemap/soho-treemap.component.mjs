import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Output, } from '@angular/core';
import * as i0 from "@angular/core";
export class SohoTreemapComponent {
    get isTreemap() {
        return true;
    }
    /** Defines the data to use, must be specified for this component. */
    set dataset(dataset) {
        this.options.dataset = dataset;
        if (this.treemap) {
            this.treemap.settings.dataset = dataset;
            this.updateRequired = true;
        }
    }
    /** If false, the component will not resize when resizing the page. */
    set redrawOnResize(value) {
        this.options.redrawOnResize = value;
        if (this.treemap) {
            this.treemap.settings.redrawOnResize = value;
            this.updateRequired = true;
        }
    }
    /** The margins of the SVG, which you may want to adjust depending on text location. */
    set margin(value) {
        this.options.margin = value;
        if (this.treemap) {
            this.treemap.settings.margin = value;
            this.updateRequired = true;
        }
    }
    /** An array of colors used in sequence from front to end of the array. */
    set colors(value) {
        this.options.colors = value;
        if (this.treemap) {
            this.treemap.settings.colors = value;
            this.updateRequired = true;
        }
    }
    /** If false then the percentage wont be shown in the blocks. */
    set showLabel(value) {
        this.options.showLabel = value;
        if (this.treemap) {
            this.treemap.settings.showLabel = value;
            this.updateRequired = true;
        }
    }
    /** The d3 formatter function for the value label. */
    set labelFormatter(value) {
        this.options.labelFormatter = value;
        if (this.treemap) {
            this.treemap.settings.labelFormatter = value;
            this.updateRequired = true;
        }
    }
    /** If true then the first name will be used for the title area. */
    set showTitle(value) {
        this.options.showTitle = value;
        if (this.treemap) {
            this.treemap.settings.showTitle = value;
            this.updateRequired = true;
        }
    }
    /** An empty message will be displayed when there is no chart data. */
    set emptyMessage(value) {
        this.options.emptyMessage = value;
        if (this.treemap) {
            this.treemap.settings.emptyMessage = value;
            this.updateRequired = true;
        }
    }
    /** Add extra attributes like id's to the component **/
    set attributes(value) {
        this.options.attributes = value;
        if (this.treemap) {
            this.treemap.settings.attributes = value;
            this.updateRequired = true;
        }
    }
    constructor(element, ngZone) {
        this.element = element;
        this.ngZone = ngZone;
        /** Options. */
        this.options = {};
        /** Events */
        this.rendered = new EventEmitter();
        this.updateRequired = false;
    }
    /** Setup */
    ngAfterViewInit() {
        this.ngZone.runOutsideAngular(() => {
            this.jQueryElement = jQuery(this.element.nativeElement);
            // this.options.type = 'treemap';
            this.jQueryElement.treemap(this.options);
            this.treemap = this.jQueryElement.data('treemap');
            // Setup the events
            this.jQueryElement.on('rendered', (...args) => this.ngZone.run(() => this.rendered.emit(args)));
        });
    }
    ngAfterViewChecked() {
        if (this.treemap && this.updateRequired) {
            this.ngZone.runOutsideAngular(() => this.treemap?.updated(this.treemap.settings));
            this.updateRequired = false;
        }
    }
    /** Tear Down */
    ngOnDestroy() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.treemap) {
                this.treemap.destroy();
                this.treemap = null;
            }
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTreemapComponent, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTreemapComponent, selector: "[soho-treemap]", inputs: { dataset: "dataset", redrawOnResize: "redrawOnResize", margin: "margin", colors: "colors", showLabel: "showLabel", labelFormatter: "labelFormatter", showTitle: "showTitle", emptyMessage: "emptyMessage", attributes: "attributes" }, outputs: { rendered: "rendered" }, host: { properties: { "class.chart-container.chart-treemap": "this.isTreemap" } }, ngImport: i0, template: '<ng-content></ng-content>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTreemapComponent, decorators: [{
            type: Component,
            args: [{
                    selector: '[soho-treemap]',
                    template: '<ng-content></ng-content>',
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { isTreemap: [{
                type: HostBinding,
                args: ['class.chart-container.chart-treemap']
            }], dataset: [{
                type: Input
            }], redrawOnResize: [{
                type: Input
            }], margin: [{
                type: Input
            }], colors: [{
                type: Input
            }], showLabel: [{
                type: Input
            }], labelFormatter: [{
                type: Input
            }], showTitle: [{
                type: Input
            }], emptyMessage: [{
                type: Input
            }], attributes: [{
                type: Input
            }], rendered: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby10cmVlbWFwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvdHJlZW1hcC9zb2hvLXRyZWVtYXAuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUVULFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUdMLE1BQU0sR0FDUCxNQUFNLGVBQWUsQ0FBQzs7QUFRdkIsTUFBTSxPQUFPLG9CQUFvQjtJQUkvQixJQUF3RCxTQUFTO1FBQy9ELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELHFFQUFxRTtJQUNyRSxJQUFhLE9BQU8sQ0FBQyxPQUFlO1FBQ2xDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUUvQixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDaEIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztZQUN4QyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztTQUM1QjtJQUNILENBQUM7SUFFRCxzRUFBc0U7SUFDdEUsSUFBYSxjQUFjLENBQUMsS0FBYztRQUN4QyxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7UUFFcEMsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7WUFDN0MsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7U0FDNUI7SUFDSCxDQUFDO0lBRUQsdUZBQXVGO0lBQ3ZGLElBQWEsTUFBTSxDQUFDLEtBQWU7UUFDakMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBRTVCLElBQUksSUFBSSxDQUFD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RyxJQUFJLENBQUM7YUFDckI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7OEdBakpVLG9CQUFvQjtrR0FBcEIsb0JBQW9CLDRaQUpyQiwyQkFBMkI7OzJGQUkxQixvQkFBb0I7a0JBTmhDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLGdCQUFnQjtvQkFDMUIsUUFBUSxFQUFFLDJCQUEyQjtvQkFDckMsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07aUJBQ2hEO3NIQU15RCxTQUFTO3NCQUFoRSxXQUFXO3VCQUFDLHFDQUFxQztnQkFLckMsT0FBTztzQkFBbkIsS0FBSztnQkFVTyxjQUFjO3NCQUExQixLQUFLO2dCQVVPLE1BQU07c0JBQWxCLEtBQUs7Z0JBVU8sTUFBTTtzQkFBbEIsS0FBSztnQkFVTyxTQUFTO3NCQUFyQixLQUFLO2dCQVVPLGNBQWM7c0JBQTFCLEtBQUs7Z0JBVU8sU0FBUztzQkFBckIsS0FBSztnQkFVTyxZQUFZO3NCQUF4QixLQUFLO2dCQVVPLFVBQVU7c0JBQXRCLEtBQUs7Z0JBVUksUUFBUTtzQkFBakIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0NoZWNrZWQsXG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSG9zdEJpbmRpbmcsXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnW3NvaG8tdHJlZW1hcF0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiAnPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PicsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXG59KVxuXG5leHBvcnQgY2xhc3MgU29ob1RyZWVtYXBDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3kge1xuICAvKiogT3B0aW9ucy4gKi9cbiAgcHJpdmF0ZSBvcHRpb25zOiBTb2hvVHJlZW1hcE9wdGlvbnMgPSB7fTtcblxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmNoYXJ0LWNvbnRhaW5lci5jaGFydC10cmVlbWFwJykgZ2V0IGlzVHJlZW1hcCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKiBEZWZpbmVzIHRoZSBkYXRhIHRvIHVzZSwgbXVzdCBiZSBzcGVjaWZpZWQgZm9yIHRoaXMgY29tcG9uZW50LiAqL1xuICBASW5wdXQoKSBzZXQgZGF0YXNldChkYXRhc2V0OiBPYmplY3QpIHtcbiAgICB0aGlzLm9wdGlvbnMuZGF0YXNldCA9IGRhdGFzZXQ7XG5cbiAgICBpZiAodGhpcy50cmVlbWFwKSB7XG4gICAgICB0aGlzLnRyZWVtYXAuc2V0dGluZ3MuZGF0YXNldCA9IGRhdGFzZXQ7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKiogSWYgZmFsc2UsIHRoZSBjb21wb25lbnQgd2lsbCBub3QgcmVzaXplIHdoZW4gcmVzaXppbmcgdGhlIHBhZ2UuICovXG4gIEBJbnB1dCgpIHNldCByZWRyYXdPblJlc2l6ZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMub3B0aW9ucy5yZWRyYXdPblJlc2l6ZSA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgdGhpcy50cmVlbWFwLnNldHRpbmdzLnJlZHJhd09uUmVzaXplID0gdmFsdWU7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKiogVGhlIG1hcmdpbnMgb2YgdGhlIFNWRywgd2hpY2ggeW91IG1heSB3YW50IHRvIGFkanVzdCBkZXBlbmRpbmcgb24gdGV4dCBsb2NhdGlvbi4gKi9cbiAgQElucHV0KCkgc2V0IG1hcmdpbih2YWx1ZTogT2JqZWN0W10pIHtcbiAgICB0aGlzLm9wdGlvbnMubWFyZ2luID0gdmFsdWU7XG5cbiAgICBpZiAodGhpcy50cmVlbWFwKSB7XG4gICAgICB0aGlzLnRyZWVtYXAuc2V0dGluZ3MubWFyZ2luID0gdmFsdWU7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKiogQW4gYXJyYXkgb2YgY29sb3JzIHVzZWQgaW4gc2VxdWVuY2UgZnJvbSBmcm9udCB0byBlbmQgb2YgdGhlIGFycmF5LiAqL1xuICBASW5wdXQoKSBzZXQgY29sb3JzKHZhbHVlOiBBcnJheTxhbnk+KSB7XG4gICAgdGhpcy5vcHRpb25zLmNvbG9ycyA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgdGhpcy50cmVlbWFwLnNldHRpbmdzLmNvbG9ycyA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIElmIGZhbHNlIHRoZW4gdGhlIHBlcmNlbnRhZ2Ugd29udCBiZSBzaG93biBpbiB0aGUgYmxvY2tzLiAqL1xuICBASW5wdXQoKSBzZXQgc2hvd0xhYmVsKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5vcHRpb25zLnNob3dMYWJlbCA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgdGhpcy50cmVlbWFwLnNldHRpbmdzLnNob3dMYWJlbCA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIFRoZSBkMyBmb3JtYXR0ZXIgZnVuY3Rpb24gZm9yIHRoZSB2YWx1ZSBsYWJlbC4gKi9cbiAgQElucHV0KCkgc2V0IGxhYmVsRm9ybWF0dGVyKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLm9wdGlvbnMubGFiZWxGb3JtYXR0ZXIgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLnRyZWVtYXApIHtcbiAgICAgIHRoaXMudHJlZW1hcC5zZXR0aW5ncy5sYWJlbEZvcm1hdHRlciA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIElmIHRydWUgdGhlbiB0aGUgZmlyc3QgbmFtZSB3aWxsIGJlIHVzZWQgZm9yIHRoZSB0aXRsZSBhcmVhLiAqL1xuICBASW5wdXQoKSBzZXQgc2hvd1RpdGxlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5vcHRpb25zLnNob3dUaXRsZSA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgdGhpcy50cmVlbWFwLnNldHRpbmdzLnNob3dUaXRsZSA9IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIEFuIGVtcHR5IG1lc3NhZ2Ugd2lsbCBiZSBkaXNwbGF5ZWQgd2hlbiB0aGVyZSBpcyBubyBjaGFydCBkYXRhLiAqL1xuICBASW5wdXQoKSBzZXQgZW1wdHlNZXNzYWdlKHZhbHVlOiBTb2hvRW1wdHlNZXNzYWdlT3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucy5lbXB0eU1lc3NhZ2UgPSB2YWx1ZTtcblxuICAgIGlmICh0aGlzLnRyZWVtYXApIHtcbiAgICAgIHRoaXMudHJlZW1hcC5zZXR0aW5ncy5lbXB0eU1lc3NhZ2UgPSB2YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBBZGQgZXh0cmEgYXR0cmlidXRlcyBsaWtlIGlkJ3MgdG8gdGhlIGNvbXBvbmVudCAqKi9cbiAgQElucHV0KCkgc2V0IGF0dHJpYnV0ZXModmFsdWU6IEFycmF5PE9iamVjdD4gfCBPYmplY3QpIHtcbiAgICB0aGlzLm9wdGlvbnMuYXR0cmlidXRlcyA9IHZhbHVlO1xuXG4gICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgdGhpcy50cmVlbWFwLnNldHRpbmdzLmF0dHJpYnV0ZXMgPSB2YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBFdmVudHMgKi9cbiAgQE91dHB1dCgpIHJlbmRlcmVkOiBFdmVudEVtaXR0ZXI8T2JqZWN0PiA9IG5ldyBFdmVudEVtaXR0ZXI8T2JqZWN0PigpO1xuXG4gIHByaXZhdGUgalF1ZXJ5RWxlbWVudD86IEpRdWVyeTtcbiAgcHJpdmF0ZSB0cmVlbWFwPzogU29ob1RyZWVtYXAgfCBudWxsO1xuICBwcml2YXRlIHVwZGF0ZVJlcXVpcmVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmUsXG4gICkgeyB9XG5cbiAgLyoqIFNldHVwICovXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSBqUXVlcnkodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xuXG4gICAgICAvLyB0aGlzLm9wdGlvbnMudHlwZSA9ICd0cmVlbWFwJztcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC50cmVlbWFwKHRoaXMub3B0aW9ucyk7XG4gICAgICB0aGlzLnRyZWVtYXAgPSB0aGlzLmpRdWVyeUVsZW1lbnQuZGF0YSgndHJlZW1hcCcpO1xuXG4gICAgICAvLyBTZXR1cCB0aGUgZXZlbnRzXG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ3JlbmRlcmVkJywgKC4uLmFyZ3MpID0+XG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLnJlbmRlcmVkLmVtaXQoYXJncykpKTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICBpZiAodGhpcy50cmVlbWFwICYmIHRoaXMudXBkYXRlUmVxdWlyZWQpIHtcbiAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMudHJlZW1hcD8udXBkYXRlZCh0aGlzLnRyZWVtYXAuc2V0dGluZ3MpKTtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKiogVGVhciBEb3duICovXG4gIG5nT25EZXN0cm95KCkge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vZmYoKTtcbiAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMudHJlZW1hcCkge1xuICAgICAgICB0aGlzLnRyZWVtYXAuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnRyZWVtYXAgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iXX0=