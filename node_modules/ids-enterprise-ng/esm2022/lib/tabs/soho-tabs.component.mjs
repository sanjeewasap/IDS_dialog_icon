import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Output } from '@angular/core';
import { DeprecatedEventEmitter } from '../utils/deprecated-event-emitter';
import * as i0 from "@angular/core";
/**
 * Internal component to support the tab title
 */
export class SohoTabTitleComponent {
    get hrefAttr() {
        return '#' + this.tabId;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabTitleComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabTitleComponent, selector: "a[soho-tab-title]", inputs: { tabId: "tabId" }, host: { properties: { "attr.href": "this.hrefAttr" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabTitleComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'a[soho-tab-title]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], propDecorators: { hrefAttr: [{
                type: HostBinding,
                args: ['attr.href']
            }], tabId: [{
                type: Input
            }] } });
/**
 * Internal component to support the tab with a 'count' on it.
 */
export class SohoTabCountComponent {
    // @ts-ignore
    constructor(_element) {
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element?.nativeElement.classList.add('count');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabCountComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabCountComponent, selector: "span[soho-tab-count]", ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabCountComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'span[soho-tab-count]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; } });
/**
 * Internal component to support a divider between tab items
 */
export class SohoTabSeparatorComponent {
    constructor(_element) {
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element.nativeElement.classList.add('separator');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabSeparatorComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabSeparatorComponent, selector: "li[soho-tab-separator]", ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabSeparatorComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-tab-separator]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; } });
/**
 * Internal component to support tab panel container content.
 */
export class SohoTabPanelContainerComponent {
    constructor(element) {
        this.element = element;
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        this.element.nativeElement.classList.add('tab-panel-container');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabPanelContainerComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabPanelContainerComponent, selector: "div[soho-tab-panel-container]", inputs: { verticalScrolling: "verticalScrolling" }, host: { properties: { "class.scrollable-y": "this.verticalScrolling" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabPanelContainerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'div[soho-tab-panel-container]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { verticalScrolling: [{
                type: HostBinding,
                args: ['class.scrollable-y']
            }, {
                type: Input
            }] } });
/**
 * Internal component to support tab panel content.
 */
export class SohoTabPanelComponent {
    constructor(_element) {
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element.nativeElement.classList.add('tab-panel');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabPanelComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabPanelComponent, selector: "div[soho-tab-panel]", inputs: { tabId: "tabId", contained: "contained" }, host: { properties: { "attr.id": "this.tabId", "attr.contained": "this.contained" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabPanelComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'div[soho-tab-panel]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { tabId: [{
                type: HostBinding,
                args: ['attr.id']
            }, {
                type: Input
            }], contained: [{
                type: HostBinding,
                args: ['attr.contained']
            }, {
                type: Input
            }] } });
/**
 * Internal component to support the tab list items
 */
export class SohoTabComponent {
    constructor(_element) {
        this.dismissible = false;
        this.selected = false;
        this.disabled = false;
        this.hidden = false;
        this.hasPopupMenu = false;
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element.nativeElement.classList.add('tab');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabComponent, selector: "li[soho-tab]", inputs: { dismissible: "dismissible", selected: "selected", disabled: "disabled", hidden: "hidden", hasPopupMenu: "hasPopupMenu" }, host: { properties: { "class.dismissible": "this.dismissible", "class.is-selected": "this.selected", "class.is-disabled": "this.disabled", "class.hidden": "this.hidden", "class.has-popupmenu": "this.hasPopupMenu" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'li[soho-tab]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { dismissible: [{
                type: HostBinding,
                args: ['class.dismissible']
            }, {
                type: Input
            }], selected: [{
                type: HostBinding,
                args: ['class.is-selected']
            }, {
                type: Input
            }], disabled: [{
                type: HostBinding,
                args: ['class.is-disabled']
            }, {
                type: Input
            }], hidden: [{
                type: HostBinding,
                args: ['class.hidden']
            }, {
                type: Input
            }], hasPopupMenu: [{
                type: HostBinding,
                args: ['class.has-popupmenu']
            }, {
                type: Input
            }] } });
/**
 * Main tabset header component
 */
export class SohoTabListComponent {
    constructor(_element) {
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element.nativeElement.classList.add('tab-list');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabListComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabListComponent, selector: "ul[soho-tab-list]", ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabListComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'ul[soho-tab-list]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; } });
/**
 * Main tabset header component
 */
export class SohoTabListContainerComponent {
    constructor(_element) {
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        _element.nativeElement.classList.add('tab-list-container');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabListContainerComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabListContainerComponent, selector: "div[soho-tab-list-container]", inputs: { verticalScrolling: "verticalScrolling" }, host: { properties: { "class.scrollable-y": "this.verticalScrolling" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabListContainerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'div[soho-tab-list-container]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { verticalScrolling: [{
                type: HostBinding,
                args: ['class.scrollable-y']
            }, {
                type: Input
            }] } });
/**
 * The main soho-tabs component
 */
export class SohoTabsComponent {
    get isVertical() {
        return this.vertical;
    }
    get isModuleTabs() {
        return this.moduleTabs;
    }
    get isHeaderTabs() {
        return this.headerTabs;
    }
    get isAlternate() {
        return this.alternate;
    }
    set tabsOptions(tabsOptions) {
        this._tabsOptions = tabsOptions;
        if (this.jQueryElement) {
            this.tabs.settings = tabsOptions;
            this.updateRequired = true;
        }
    }
    /**
     * If set to true, creates a button at the end of the tab list that can be used to add an empty tab and panel.
     *
     */
    set addTabButton(addTabButton) {
        this._tabsOptions.addTabButton = addTabButton;
        if (this.jQueryElement) {
            this.tabs.settings.addTabButton = addTabButton;
            this.updateRequired = true;
        }
    }
    /**
     * if defined as a function, will be used in-place of the default Tab Adding method
     * TODO: how to handle call back function?
     */
    set addTabButtonCallback(addTabButtonCallback) {
        this._tabsOptions.addTabButtonCallback = addTabButtonCallback;
        if (this.jQueryElement) {
            this.tabs.settings.addTabButtonCallback = addTabButtonCallback;
            this.updateRequired = true;
        }
    }
    /**
     * If set to true, will force an App Menu trigger to be present on Non-Vertical Tabs implementatations.
     */
    set appMenuTrigger(appMenuTrigger) {
        this._tabsOptions.appMenuTrigger = appMenuTrigger;
        if (this.jQueryElement) {
            this.tabs.settings.appMenuTrigger = appMenuTrigger;
            this.updateRequired = true;
        }
    }
    /**
     * If defined, replaces the default "Menu" text used in the app menu trigger.
     */
    set appMenuTriggerText(appMenuTriggerText) {
        this._tabsOptions.appMenuTriggerText = appMenuTriggerText;
        if (this.jQueryElement) {
            this.tabs.settings.appMenuTriggerText = appMenuTriggerText;
            this.updateRequired = true;
        }
    }
    /**
     *  If true, causes an app menu trigger's text content to be visually hidden (but still exists for accessiblity purposes)
     */
    set appMenuTriggerTextAudible(appMenuTriggerTextAudible) {
        this._tabsOptions.appMenuTriggerTextAudible = appMenuTriggerTextAudible;
        if (this.jQueryElement) {
            this.tabs.settings.appMenuTriggerTextAudible = appMenuTriggerTextAudible;
            this.updateRequired = true;
        }
    }
    /**
     *  If defined, will be used by any internal Tabs AJAX calls as the desired request settings.
     */
    set ajaxOptions(ajaxOptions) {
        this._tabsOptions.ajaxOptions = ajaxOptions;
        if (this.jQueryElement) {
            this.tabs.settings.ajaxOptions = ajaxOptions;
            this.updateRequired = true;
        }
    }
    /**
     * Defines a separate element to be used for containing the tab panels.  Defaults to the Tab Container itself
     */
    set containerElement(containerElement) {
        this._tabsOptions.containerElement = containerElement;
        if (this.jQueryElement) {
            this.tabs.settings.containerElement = containerElement;
            this.updateRequired = true;
        }
    }
    /**
     * If true, will change the selected tab on invocation based on the URL that exists after the hash
     *
     */
    set changeTabOnHashChange(changeTabOnHashChange) {
        this._tabsOptions.changeTabOnHashChange = changeTabOnHashChange;
        if (this.jQueryElement) {
            this.tabs.settings.changeTabOnHashChange = changeTabOnHashChange;
            this.updateRequired = true;
        }
    }
    /**
     * If defined as a function, provides an external method for adjusting the current page hash used by these tabs
     * TODO: how to handle call back function?
     */
    set hashChangeCallback(hashChangeCallback) {
        this._tabsOptions.hashChangeCallback = hashChangeCallback;
        if (this.jQueryElement) {
            this.tabs.settings.hashChangeCallback = hashChangeCallback;
            this.updateRequired = true;
        }
    }
    /**
     * If true, when using full URLs in tab HREFs, or when using Ajax calls, tabs will be loaded as needed instead of the markup
     * all being established at once.
     */
    set lazyLoad(lazyLoad) {
        this._tabsOptions.lazyLoad = lazyLoad;
        if (this.jQueryElement) {
            this.tabs.settings.lazyLoad = lazyLoad;
            this.updateRequired = true;
        }
    }
    /**
     * If true, will display a tooltip or Module Tabs with cut-off text content.
     */
    set moduleTabsTooltips(moduleTabsTooltips) {
        this._tabsOptions.moduleTabsTooltips = moduleTabsTooltips;
        if (this.jQueryElement) {
            this.tabs.settings.moduleTabsTooltips = moduleTabsTooltips;
            this.updateRequired = true;
        }
    }
    /**
     * If true, will display a tooltip on Multi Tabs with cut-off text content.
     */
    set multiTabsTooltips(multiTabsTooltips) {
        this._tabsOptions.multiTabsTooltips = multiTabsTooltips;
        if (this.jQueryElement) {
            this.tabs.settings.multiTabsTooltips = multiTabsTooltips;
            this.updateRequired = true;
        }
    }
    /**
     * If defined, it will display the position of counts.
     */
    set countsPosition(countsPosition) {
        this._tabsOptions.countsPosition = countsPosition;
        if (this.jQueryElement) {
            this.tabs.settings.countsPosition = countsPosition;
            this.updateRequired = true;
        }
    }
    /**
     * If defined, will serve as a way of pulling in external content to fill tabs.
     */
    set source(source) {
        this._tabsOptions.source = source;
        if (this.jQueryElement) {
            this.tabs.settings.source = source;
            this.updateRequired = true;
        }
    }
    /**
     * If a source method is defined, this flexible object can be passed into the source method, and augmented with
     * parameters specific to the implementation.
     */
    set sourceArguments(sourceArguments) {
        this._tabsOptions.sourceArguments = sourceArguments;
        if (this.jQueryElement) {
            this.tabs.settings.sourceArguments = sourceArguments;
            this.updateRequired = true;
        }
    }
    /**
     * set to true to allow tab count markup <span class=tabcount>#</span>.
     *
     */
    set tabCounts(tabCounts) {
        this._tabsOptions.tabCounts = tabCounts;
        if (this.jQueryElement) {
            this.tabs.settings.tabCounts = tabCounts;
            this.updateRequired = true;
        }
    }
    /**
     * If Vertical Tabs & true, will automatically switch to Horizontal Tabs on smaller breakpoints.
     *
     */
    set verticalResponsive(verticalResponsive) {
        this._tabsOptions.verticalResponsive = verticalResponsive;
        if (this.jQueryElement) {
            this.tabs.settings.verticalResponsive = verticalResponsive;
            this.updateRequired = true;
        }
    }
    /** Add extra attributes like id's to the component **/
    set attributes(attributes) {
        this._tabsOptions.attributes = attributes;
        if (this.jQueryElement) {
            this.tabs.settings.attributes = attributes;
            this.updateRequired = true;
        }
    }
    /** Sets the tabs to be sortable by drag and drop. **/
    set sortable(sortable) {
        this._tabsOptions.sortable = sortable;
        if (this.jQueryElement) {
            this.tabs.settings.sortable = sortable;
            this.updateRequired = true;
        }
    }
    /**
     * Constructor.
     *
     * @param elementRef - the element matching the component's selector.
     */
    constructor(_changeDetectorRef, element, ngZone) {
        this.element = element;
        this.ngZone = ngZone;
        // ------------------------------------------------------------------------
        // @Inputs
        // ------------------------------------------------------------------------
        /**
         * set to true to show a secondary style for the tabs
         *
         */
        this.alternate = false;
        /**
         * set to true to display the tabs vertically to the left of the tab-panel
         *
         */
        this.vertical = false;
        /**
         * set to true to display the tabs as module tabs
         *
         */
        this.moduleTabs = false;
        /**
         * set to true to display the tabs as header tabs
         *
         */
        this.headerTabs = false;
        /**
         * if you would like to run the updated() function yourself instead of having
         * this tabs component check for you set this input to true. The advantage to
         * this is that if you know when to update you can be more efficient.
         */
        this.disableAutoUpdatedCall = false;
        // ------------------------------------------------------------------------
        // @Outputs
        // ------------------------------------------------------------------------
        /**
         * The beforeactivated event is fired whenever a tab is selected giving the event handler a chance
         * to "veto" the tab selection change.
         *
         */
        this.beforeActivated = new EventEmitter();
        /**
         * The beforeactivate event is deprecated in favor of `beforeactivated`.
         *
         * @deprecated
         */
        this.beforeActivate = new DeprecatedEventEmitter('beforeactivate', 'beforeactivated');
        /**
         * The activated event is fired whenever a tab is selected (or "activated");
         */
        this.activated = new EventEmitter();
        /**
         * The afteractivate event is fired after the has been activated.
         */
        this.afterActivated = new EventEmitter();
        /**
         * fired before a tab closes
         */
        this.beforeClose = new EventEmitter();
        /**
         * fired when a tab closes
         *
         * @todo replace override of native element
         */
        // eslint-disable-next-line @angular-eslint/no-output-native
        this.close = new EventEmitter();
        /**
         * fired after a tab closes
         */
        this.afterClose = new EventEmitter();
        /**
         * fire when a new tab is added.
         *
         */
        this.tabAdded = new EventEmitter();
        // An internal tabsOptions object that gets updated by using
        // the component's Inputs()
        this._tabsOptions = {};
        /**
         * set to true when @input changes. This will cause the tabs.updated call
         * in the afterViewChecked. This technique has the advantage of only calling
         * updated once in the current angular cycle no matter how many inputs are
         * changed during that cycle.
         */
        this.updateRequired = false;
        // Adding the class this way to ensure that it is applied before the AfterViewInit.
        // Avoiding @HostBinding for this since an *ngIf causes bindings to be processed
        // after the AfterViewInit
        element.nativeElement.classList.add('tab-container');
    }
    ngAfterViewInit() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            // assign element to local variable
            this.jQueryElement = jQuery(this.element.nativeElement);
            // bind to jquery events and emit as angular events
            this.jQueryElement.on('beforeactivated', (event, tab) => this.onBeforeActivated(event, tab));
            this.jQueryElement.on('activated', (event, tab) => this.onActivated(event, tab));
            this.jQueryElement.on('afteractivated', (event, tab) => this.onAfterActivated(event, tab));
            this.jQueryElement.on('beforeclose', (event, tab) => this.onBeforeClose(event, tab));
            this.jQueryElement.on('close', (event, tab) => this.onClose(event, tab));
            this.jQueryElement.on('afterclose', (event, tab) => this.onAfterClose(event, tab));
            this.jQueryElement.on('tab-added', (event, tab) => this.onTabAdded(event, tab));
            // initialize the tabs plugin
            this.jQueryElement.tabs(this._tabsOptions);
            this.tabs = this.jQueryElement.data('tabs');
            this.updateTabInfo();
        });
    }
    ngAfterViewChecked() {
        if (!this.tabs || !this.jQueryElement) {
            return;
        }
        if (this.updateRequired) {
            // call outside the angular zone so change detection isn't triggered by the soho component.
            this.ngZone.runOutsideAngular(() => this.tabs?.updated());
            this.updateRequired = false;
        }
        if (this.disableAutoUpdatedCall) {
            return;
        }
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            const $liList = this.getTabLiList();
            const $activateTab = this.getActivatedTab();
            if (!$liList) {
                return;
            }
            const tabTitles = this.getTabTitles($liList);
            if (!tabTitles) {
                return;
            }
            const tabIds = this.getTabIds();
            if (!tabIds) {
                return;
            }
            if (this.tabCount !== $liList.length) {
                /* Must rebuild the tab control if the tab count changes */
                this.tabs?.updated();
                this.tabCount = $liList.length;
                this.tabTitles = this.getTabTitles($liList);
                this.tabIds = tabIds;
                this.activateTab($activateTab);
                return;
            }
            for (let i = 0; i < tabIds.length; i++) {
                if (this.tabIds && tabIds[i] !== this.tabIds[i]) {
                    this.tabs?.updated();
                    this.tabIds = tabIds;
                    this.tabTitles = this.getTabTitles($liList);
                    this.activateTab($activateTab);
                    return;
                }
            }
            /*
             * if only tab titles change then call handleResize.
             * It will update the tabs selection style and the overflow
             */
            for (let j = 0; j < tabTitles.length; j++) {
                if (this.tabTitles && tabTitles[j] !== this.tabTitles[j]) {
                    this.tabs?.handleResize();
                    this.tabTitles = tabTitles;
                    return;
                }
            }
        });
    }
    ngOnDestroy() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => {
            if (this.jQueryElement) {
                this.jQueryElement.off();
                this.jQueryElement = undefined;
            }
            if (this.tabs) {
                this.tabs.destroy();
                this.tabs = null;
            }
        });
    }
    updateTabInfo() {
        if (this.disableAutoUpdatedCall) {
            return;
        }
        /**
         * Used to auto update the control when projected content changes. Use wisely
         * as this can be slower than normal.
         */
        this.ngZone.runOutsideAngular(() => {
            const $liList = this.getTabLiList();
            this.tabCount = $liList.length;
            this.tabTitles = this.getTabTitles($liList);
            this.tabIds = this.getTabIds();
        });
    }
    getTabLiList() {
        // call outside the angular zone since angular doesn't need to know about this.
        return this.ngZone.runOutsideAngular(() => this.jQueryElement?.find('.tab-list').find('li'));
    }
    getActivatedTab() {
        // get the current selected tab outside of the angular zone
        return this.ngZone.runOutsideAngular(() => this.jQueryElement?.siblings('.tab-panel-container').find('.tab-panel.is-visible'));
    }
    getTabIds() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        return this.ngZone.runOutsideAngular(() => {
            const anchorList = this.jQueryElement?.find('.tab-list').find('a').toArray();
            return anchorList.map((anchor) => anchor.getAttribute('href').substring(1));
        });
    }
    getTabTitles($liList) {
        // call outside the angular zone
        return this.ngZone.runOutsideAngular(() => {
            if (!$liList) {
                $liList = this.getTabLiList();
            }
            const tabTitles = [];
            const $anchorList = $liList?.find('a');
            // eslint-disable-next-line @typescript-eslint/prefer-for-of
            for (let i = 0; i < $anchorList.length; i++) {
                tabTitles.push($($anchorList[i]).html());
            }
            return tabTitles;
        });
    }
    /**
     * Causes the tabs component view to be rebuilt
     */
    updated() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.updated());
    }
    /**
     * @param tab The tab element in the list that needs to be activated
     * @returns
     */
    activateTab(tab) {
        return this.ngZone.runOutsideAngular(() => {
            if (!tab) {
                return;
            }
            const tabHref = `#${tab?.attr('id')}`;
            this.tabs?.activate(tabHref);
        });
    }
    /**
     * Call resize manually when tab titles change so that the underline width matches.
     */
    handleResize(doResponsiveCheck) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.handleResize(doResponsiveCheck));
    }
    /**
     * Manually call updated and refresh out of the zone.
     */
    refresh() {
        this.ngZone.runOutsideAngular(() => {
            setTimeout(() => {
                this.tabs?.updated();
            }, 1);
        });
    }
    /**
     * Adds a new tab into the tab component
     *
     * @param tabId The tabId of the tab to be added
     * @param options ?
     * @param atIndex The index location where the tab is to be added.
     */
    add(tabId, options, atIndex) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.add(tabId, options, atIndex));
    }
    /**
     * Removes a tab
     *
     * @param tabId The tabId of the tab to be removed.
     * @param disableBeforeClose If true, the beforeClose callback should be called
     * before removing the tab.
     */
    remove(tabId, disableBeforeClose) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.remove(tabId, disableBeforeClose));
    }
    /**
     * Hides a tab for the given tabId
     *
     * @param tabId The id of the tab to hide
     */
    hide(tabId) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.hide(tabId));
    }
    show(tabId) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.show(tabId));
    }
    disableTab(tabId) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.disableTab(tabId));
    }
    enableTab(tabId) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.enableTab(tabId));
    }
    rename(tabId, name) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs?.rename(tabId, name));
    }
    /**
     * Gets a tab given either an event or a tabId
     *
     * @param event And event from a tab that will allow tab retrieval
     * @param tabId The tabId of the tab to be retrieved.
     */
    getTab(event, tabId) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        // TODO: getTab seems to return a jQuery object, what to return instead?
        return this.ngZone.runOutsideAngular(() => this.tabs?.getTab(event, tabId));
    }
    /**
     * Return the currenlty active/selected tab.
     *
     * @return  A JQuery object of the active tab element.
     */
    getActiveTab() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        // TODO: getActiveTab seems to return a jQuery object, what to return instead?
        return this.ngZone.runOutsideAngular(() => this.tabs.getActiveTab());
    }
    /**
     * Returns the visible tabs
     *
     * @return  An array of JQuery objects of the visible tab elements
     */
    getVisibleTabs() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        // TODO: getVisibleTabs seems to return a jQuery array, what to return instead?
        return this.ngZone.runOutsideAngular(() => this.tabs.getVisibleTabs());
    }
    /**
     * Returns the overflow tabs
     *
     * @return  An array of JQuery objects of the overflow tab elements
     */
    getOverflowTabs() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        // TODO: getVisibleTabs seems to return a jQuery array, what to return instead?
        return this.ngZone.runOutsideAngular(() => this.tabs.getOverflowTabs());
    }
    /**
     * Selects the tab given an href
     *
     * @param href an href used to find the tab to select
     */
    select(href) {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs.select(href));
    }
    /**
     * Disables the entire tab component
     */
    disable() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs.disable());
    }
    /**
     * enables the entire tab component
     */
    enable() {
        // call outside the angular zone so change detection isn't triggered by the soho component.
        this.ngZone.runOutsideAngular(() => this.tabs.enable());
    }
    onBeforeActivated(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.beforeActivated.emit(event);
        });
    }
    onActivated(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.activated.emit(event);
        });
    }
    onAfterActivated(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.afterActivated.emit(event);
        });
    }
    onBeforeClose(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.beforeClose.emit(event);
            if (this.beforeCloseCallback) {
                return this.beforeCloseCallback(event, tab);
            }
        });
    }
    onClose(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.close.emit(event);
        });
    }
    onAfterClose(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.afterClose.emit(event);
        });
    }
    onTabAdded(event, tab) {
        // ensure we are back in the angular zone
        this.ngZone.run(() => {
            event.tab = tab[0];
            this.tabAdded.emit(event);
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabsComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.4", type: SohoTabsComponent, selector: "div[soho-tabs]", inputs: { alternate: "alternate", vertical: "vertical", moduleTabs: "moduleTabs", headerTabs: "headerTabs", beforeCloseCallback: "beforeCloseCallback", tabsOptions: "tabsOptions", addTabButton: "addTabButton", addTabButtonCallback: "addTabButtonCallback", appMenuTrigger: "appMenuTrigger", appMenuTriggerText: "appMenuTriggerText", appMenuTriggerTextAudible: "appMenuTriggerTextAudible", ajaxOptions: "ajaxOptions", containerElement: "containerElement", changeTabOnHashChange: "changeTabOnHashChange", hashChangeCallback: "hashChangeCallback", lazyLoad: "lazyLoad", moduleTabsTooltips: "moduleTabsTooltips", multiTabsTooltips: "multiTabsTooltips", countsPosition: "countsPosition", source: "source", sourceArguments: "sourceArguments", tabCounts: "tabCounts", verticalResponsive: "verticalResponsive", attributes: "attributes", sortable: "sortable", disableAutoUpdatedCall: "disableAutoUpdatedCall" }, outputs: { beforeActivated: "beforeActivated", beforeActivate: "beforeActivate", activated: "activated", afterActivated: "afterActivated", beforeClose: "beforeClose", close: "close", afterClose: "afterClose", tabAdded: "tabAdded" }, host: { properties: { "class.vertical": "this.isVertical", "class.module-tabs": "this.isModuleTabs", "class.header-tabs": "this.isHeaderTabs", "class.alternate": "this.isAlternate" } }, ngImport: i0, template: `<ng-content></ng-content>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.4", ngImport: i0, type: SohoTabsComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'div[soho-tabs]',
                    template: `<ng-content></ng-content>`,
                    changeDetection: ChangeDetectionStrategy.OnPush
                }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.NgZone }]; }, propDecorators: { isVertical: [{
                type: HostBinding,
                args: ['class.vertical']
            }], isModuleTabs: [{
                type: HostBinding,
                args: ['class.module-tabs']
            }], isHeaderTabs: [{
                type: HostBinding,
                args: ['class.header-tabs']
            }], isAlternate: [{
                type: HostBinding,
                args: ['class.alternate']
            }], alternate: [{
                type: Input
            }], vertical: [{
                type: Input
            }], moduleTabs: [{
                type: Input
            }], headerTabs: [{
                type: Input
            }], beforeCloseCallback: [{
                type: Input
            }], tabsOptions: [{
                type: Input
            }], addTabButton: [{
                type: Input
            }], addTabButtonCallback: [{
                type: Input
            }], appMenuTrigger: [{
                type: Input
            }], appMenuTriggerText: [{
                type: Input
            }], appMenuTriggerTextAudible: [{
                type: Input
            }], ajaxOptions: [{
                type: Input
            }], containerElement: [{
                type: Input
            }], changeTabOnHashChange: [{
                type: Input
            }], hashChangeCallback: [{
                type: Input
            }], lazyLoad: [{
                type: Input
            }], moduleTabsTooltips: [{
                type: Input
            }], multiTabsTooltips: [{
                type: Input
            }], countsPosition: [{
                type: Input
            }], source: [{
                type: Input
            }], sourceArguments: [{
                type: Input
            }], tabCounts: [{
                type: Input
            }], verticalResponsive: [{
                type: Input
            }], attributes: [{
                type: Input
            }], sortable: [{
                type: Input
            }], disableAutoUpdatedCall: [{
                type: Input
            }], beforeActivated: [{
                type: Output
            }], beforeActivate: [{
                type: Output
            }], activated: [{
                type: Output
            }], afterActivated: [{
                type: Output
            }], beforeClose: [{
                type: Output
            }], close: [{
                type: Output
            }], afterClose: [{
                type: Output
            }], tabAdded: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29oby10YWJzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lkcy1lbnRlcnByaXNlLW5nL3NyYy9saWIvdGFicy9zb2hvLXRhYnMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCx1QkFBdUIsRUFFdkIsU0FBUyxFQUVULFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUdMLE1BQU0sRUFDUCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQ0wsc0JBQXNCLEVBQ3ZCLE1BQU0sbUNBQW1DLENBQUM7O0FBRTNDOztHQUVHO0FBTUgsTUFBTSxPQUFPLHFCQUFxQjtJQUNoQyxJQUE4QixRQUFRO1FBQ3BDLE9BQU8sR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDMUIsQ0FBQzs4R0FIVSxxQkFBcUI7a0dBQXJCLHFCQUFxQiw2SUFIdEIsMkJBQTJCOzsyRkFHMUIscUJBQXFCO2tCQUxqQyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxtQkFBbUI7b0JBQzdCLFFBQVEsRUFBRSwyQkFBMkI7b0JBQ3JDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNO2lCQUNoRDs4QkFFK0IsUUFBUTtzQkFBckMsV0FBVzt1QkFBQyxXQUFXO2dCQUdmLEtBQUs7c0JBQWIsS0FBSzs7QUFHUjs7R0FFRztBQU1ILE1BQU0sT0FBTyxxQkFBcUI7SUFDaEMsYUFBYTtJQUNiLFlBQVksUUFBb0I7UUFDOUIsbUZBQW1GO1FBQ25GLGdGQUFnRjtRQUNoRiwwQkFBMEI7UUFDMUIsUUFBUSxFQUFFLGFBQWEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2pELENBQUM7OEdBUFUscUJBQXFCO2tHQUFyQixxQkFBcUIsNERBSHRCLDJCQUEyQjs7MkZBRzFCLHFCQUFxQjtrQkFMakMsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUs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V0ksZUFBZTtzQkFBeEIsTUFBTTtnQkFPRyxjQUFjO3NCQUF2QixNQUFNO2dCQUtHLFNBQVM7c0JBQWxCLE1BQU07Z0JBS0csY0FBYztzQkFBdkIsTUFBTTtnQkFLRyxXQUFXO3NCQUFwQixNQUFNO2dCQVFHLEtBQUs7c0JBQWQsTUFBTTtnQkFLRyxVQUFVO3NCQUFuQixNQUFNO2dCQU1HLFFBQVE7c0JBQWpCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdDaGVja2VkLFxuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBIb3N0QmluZGluZyxcbiAgSW5wdXQsXG4gIE5nWm9uZSxcbiAgT25EZXN0cm95LFxuICBPdXRwdXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7XG4gIERlcHJlY2F0ZWRFdmVudEVtaXR0ZXJcbn0gZnJvbSAnLi4vdXRpbHMvZGVwcmVjYXRlZC1ldmVudC1lbWl0dGVyJztcblxuLyoqXG4gKiBJbnRlcm5hbCBjb21wb25lbnQgdG8gc3VwcG9ydCB0aGUgdGFiIHRpdGxlXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Fbc29oby10YWItdGl0bGVdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgU29ob1RhYlRpdGxlQ29tcG9uZW50IHtcbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmhyZWYnKSBnZXQgaHJlZkF0dHIoKSB7XG4gICAgcmV0dXJuICcjJyArIHRoaXMudGFiSWQ7XG4gIH1cbiAgQElucHV0KCkgdGFiSWQ/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogSW50ZXJuYWwgY29tcG9uZW50IHRvIHN1cHBvcnQgdGhlIHRhYiB3aXRoIGEgJ2NvdW50JyBvbiBpdC5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc3Bhbltzb2hvLXRhYi1jb3VudF0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvVGFiQ291bnRDb21wb25lbnQge1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0cnVjdG9yKF9lbGVtZW50OiBFbGVtZW50UmVmKSB7XG4gICAgLy8gQWRkaW5nIHRoZSBjbGFzcyB0aGlzIHdheSB0byBlbnN1cmUgdGhhdCBpdCBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgQWZ0ZXJWaWV3SW5pdC5cbiAgICAvLyBBdm9pZGluZyBASG9zdEJpbmRpbmcgZm9yIHRoaXMgc2luY2UgYW4gKm5nSWYgY2F1c2VzIGJpbmRpbmdzIHRvIGJlIHByb2Nlc3NlZFxuICAgIC8vIGFmdGVyIHRoZSBBZnRlclZpZXdJbml0XG4gICAgX2VsZW1lbnQ/Lm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY291bnQnKTtcbiAgfVxufVxuXG4vKipcbiAqIEludGVybmFsIGNvbXBvbmVudCB0byBzdXBwb3J0IGEgZGl2aWRlciBiZXR3ZWVuIHRhYiBpdGVtc1xuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdsaVtzb2hvLXRhYi1zZXBhcmF0b3JdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgU29ob1RhYlNlcGFyYXRvckNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKF9lbGVtZW50OiBFbGVtZW50UmVmKSB7IC8vIEB0cy1pZ25vcmVcbiAgICAvLyBBZGRpbmcgdGhlIGNsYXNzIHRoaXMgd2F5IHRvIGVuc3VyZSB0aGF0IGl0IGlzIGFwcGxpZWQgYmVmb3JlIHRoZSBBZnRlclZpZXdJbml0LlxuICAgIC8vIEF2b2lkaW5nIEBIb3N0QmluZGluZyBmb3IgdGhpcyBzaW5jZSBhbiAqbmdJZiBjYXVzZXMgYmluZGluZ3MgdG8gYmUgcHJvY2Vzc2VkXG4gICAgLy8gYWZ0ZXIgdGhlIEFmdGVyVmlld0luaXRcbiAgICBfZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NlcGFyYXRvcicpO1xuICB9XG59XG5cbi8qKlxuICogSW50ZXJuYWwgY29tcG9uZW50IHRvIHN1cHBvcnQgdGFiIHBhbmVsIGNvbnRhaW5lciBjb250ZW50LlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdkaXZbc29oby10YWItcGFuZWwtY29udGFpbmVyXScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9UYWJQYW5lbENvbnRhaW5lckNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZikge1xuICAgIC8vIEFkZGluZyB0aGUgY2xhc3MgdGhpcyB3YXkgdG8gZW5zdXJlIHRoYXQgaXQgaXMgYXBwbGllZCBiZWZvcmUgdGhlIEFmdGVyVmlld0luaXQuXG4gICAgLy8gQXZvaWRpbmcgQEhvc3RCaW5kaW5nIGZvciB0aGlzIHNpbmNlIGFuICpuZ0lmIGNhdXNlcyBiaW5kaW5ncyB0byBiZSBwcm9jZXNzZWRcbiAgICAvLyBhZnRlciB0aGUgQWZ0ZXJWaWV3SW5pdFxuICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3RhYi1wYW5lbC1jb250YWluZXInKTtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2Nyb2xsYWJsZS15JykgQElucHV0KCkgdmVydGljYWxTY3JvbGxpbmc6IGFueTtcbn1cblxuLyoqXG4gKiBJbnRlcm5hbCBjb21wb25lbnQgdG8gc3VwcG9ydCB0YWIgcGFuZWwgY29udGVudC5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZGl2W3NvaG8tdGFiLXBhbmVsXScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9UYWJQYW5lbENvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKF9lbGVtZW50OiBFbGVtZW50UmVmKSB7XG4gICAgLy8gQWRkaW5nIHRoZSBjbGFzcyB0aGlzIHdheSB0byBlbnN1cmUgdGhhdCBpdCBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgQWZ0ZXJWaWV3SW5pdC5cbiAgICAvLyBBdm9pZGluZyBASG9zdEJpbmRpbmcgZm9yIHRoaXMgc2luY2UgYW4gKm5nSWYgY2F1c2VzIGJpbmRpbmdzIHRvIGJlIHByb2Nlc3NlZFxuICAgIC8vIGFmdGVyIHRoZSBBZnRlclZpZXdJbml0XG4gICAgX2VsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCd0YWItcGFuZWwnKTtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnYXR0ci5pZCcpIEBJbnB1dCgpIHRhYklkPzogc3RyaW5nO1xuICBASG9zdEJpbmRpbmcoJ2F0dHIuY29udGFpbmVkJykgQElucHV0KCkgY29udGFpbmVkPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIEludGVybmFsIGNvbXBvbmVudCB0byBzdXBwb3J0IHRoZSB0YWIgbGlzdCBpdGVtc1xuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdsaVtzb2hvLXRhYl0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvVGFiQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoX2VsZW1lbnQ6IEVsZW1lbnRSZWYpIHtcbiAgICAvLyBBZGRpbmcgdGhlIGNsYXNzIHRoaXMgd2F5IHRvIGVuc3VyZSB0aGF0IGl0IGlzIGFwcGxpZWQgYmVmb3JlIHRoZSBBZnRlclZpZXdJbml0LlxuICAgIC8vIEF2b2lkaW5nIEBIb3N0QmluZGluZyBmb3IgdGhpcyBzaW5jZSBhbiAqbmdJZiBjYXVzZXMgYmluZGluZ3MgdG8gYmUgcHJvY2Vzc2VkXG4gICAgLy8gYWZ0ZXIgdGhlIEFmdGVyVmlld0luaXRcbiAgICBfZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3RhYicpO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5kaXNtaXNzaWJsZScpIEBJbnB1dCgpIGRpc21pc3NpYmxlID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MuaXMtc2VsZWN0ZWQnKSBASW5wdXQoKSBzZWxlY3RlZCA9IGZhbHNlO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmlzLWRpc2FibGVkJykgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oaWRkZW4nKSBASW5wdXQoKSBoaWRkZW4gPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYXMtcG9wdXBtZW51JykgQElucHV0KCkgaGFzUG9wdXBNZW51ID0gZmFsc2U7XG59XG5cbi8qKlxuICogTWFpbiB0YWJzZXQgaGVhZGVyIGNvbXBvbmVudFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd1bFtzb2hvLXRhYi1saXN0XScsIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgdGVtcGxhdGU6IGA8bmctY29udGVudD48L25nLWNvbnRlbnQ+YCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIFNvaG9UYWJMaXN0Q29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoX2VsZW1lbnQ6IEVsZW1lbnRSZWYpIHtcbiAgICAvLyBBZGRpbmcgdGhlIGNsYXNzIHRoaXMgd2F5IHRvIGVuc3VyZSB0aGF0IGl0IGlzIGFwcGxpZWQgYmVmb3JlIHRoZSBBZnRlclZpZXdJbml0LlxuICAgIC8vIEF2b2lkaW5nIEBIb3N0QmluZGluZyBmb3IgdGhpcyBzaW5jZSBhbiAqbmdJZiBjYXVzZXMgYmluZGluZ3MgdG8gYmUgcHJvY2Vzc2VkXG4gICAgLy8gYWZ0ZXIgdGhlIEFmdGVyVmlld0luaXRcbiAgICBfZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3RhYi1saXN0Jyk7XG4gIH1cbn1cblxuLyoqXG4gKiBNYWluIHRhYnNldCBoZWFkZXIgY29tcG9uZW50XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Rpdltzb2hvLXRhYi1saXN0LWNvbnRhaW5lcl0nLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvVGFiTGlzdENvbnRhaW5lckNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKF9lbGVtZW50OiBFbGVtZW50UmVmKSB7XG4gICAgLy8gQWRkaW5nIHRoZSBjbGFzcyB0aGlzIHdheSB0byBlbnN1cmUgdGhhdCBpdCBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgQWZ0ZXJWaWV3SW5pdC5cbiAgICAvLyBBdm9pZGluZyBASG9zdEJpbmRpbmcgZm9yIHRoaXMgc2luY2UgYW4gKm5nSWYgY2F1c2VzIGJpbmRpbmdzIHRvIGJlIHByb2Nlc3NlZFxuICAgIC8vIGFmdGVyIHRoZSBBZnRlclZpZXdJbml0XG4gICAgX2VsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCd0YWItbGlzdC1jb250YWluZXInKTtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3Muc2Nyb2xsYWJsZS15JykgQElucHV0KCkgdmVydGljYWxTY3JvbGxpbmc6IGFueTtcbn1cblxuLyoqXG4gKiBUaGUgbWFpbiBzb2hvLXRhYnMgY29tcG9uZW50XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Rpdltzb2hvLXRhYnNdJywgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICB0ZW1wbGF0ZTogYDxuZy1jb250ZW50PjwvbmctY29udGVudD5gLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBTb2hvVGFic0NvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQsIE9uRGVzdHJveSB7XG4gIEBIb3N0QmluZGluZygnY2xhc3MudmVydGljYWwnKSBnZXQgaXNWZXJ0aWNhbCgpIHtcbiAgICByZXR1cm4gdGhpcy52ZXJ0aWNhbDtcbiAgfVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLm1vZHVsZS10YWJzJykgZ2V0IGlzTW9kdWxlVGFicygpIHtcbiAgICByZXR1cm4gdGhpcy5tb2R1bGVUYWJzO1xuICB9XG4gIEBIb3N0QmluZGluZygnY2xhc3MuaGVhZGVyLXRhYnMnKSBnZXQgaXNIZWFkZXJUYWJzKCkge1xuICAgIHJldHVybiB0aGlzLmhlYWRlclRhYnM7XG4gIH1cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5hbHRlcm5hdGUnKSBnZXQgaXNBbHRlcm5hdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWx0ZXJuYXRlO1xuICB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEBJbnB1dHNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIHNldCB0byB0cnVlIHRvIHNob3cgYSBzZWNvbmRhcnkgc3R5bGUgZm9yIHRoZSB0YWJzXG4gICAqXG4gICAqL1xuICBASW5wdXQoKSBhbHRlcm5hdGUgPSBmYWxzZTtcblxuICAvKipcbiAgICogc2V0IHRvIHRydWUgdG8gZGlzcGxheSB0aGUgdGFicyB2ZXJ0aWNhbGx5IHRvIHRoZSBsZWZ0IG9mIHRoZSB0YWItcGFuZWxcbiAgICpcbiAgICovXG4gIEBJbnB1dCgpIHZlcnRpY2FsID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIHNldCB0byB0cnVlIHRvIGRpc3BsYXkgdGhlIHRhYnMgYXMgbW9kdWxlIHRhYnNcbiAgICpcbiAgICovXG4gIEBJbnB1dCgpIG1vZHVsZVRhYnMgPSBmYWxzZTtcblxuICAvKipcbiAgICogc2V0IHRvIHRydWUgdG8gZGlzcGxheSB0aGUgdGFicyBhcyBoZWFkZXIgdGFic1xuICAgKlxuICAgKi9cbiAgQElucHV0KCkgaGVhZGVyVGFicyA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBUaGUgY2FsbGJhY2sgZnVuY3Rpb24gY2FsbGVkIGJlZm9yZSBhIHRhYiBpcyBjbG9zZWQuXG4gICAqIFJldHVybiBmYWxzZSB0byBwcmV2ZW50IHRoZSB0YWIgZnJvbSBjbG9zaW5nLlxuICAgKi9cbiAgQElucHV0KCkgYmVmb3JlQ2xvc2VDYWxsYmFjaz86IEZ1bmN0aW9uO1xuXG4gIEBJbnB1dCgpIHNldCB0YWJzT3B0aW9ucyh0YWJzT3B0aW9uczogU29ob1RhYnNPcHRpb25zKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMgPSB0YWJzT3B0aW9ucztcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MgPSB0YWJzT3B0aW9ucztcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogSWYgc2V0IHRvIHRydWUsIGNyZWF0ZXMgYSBidXR0b24gYXQgdGhlIGVuZCBvZiB0aGUgdGFiIGxpc3QgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gZW1wdHkgdGFiIGFuZCBwYW5lbC5cbiAgICpcbiAgICovXG4gIEBJbnB1dCgpIHNldCBhZGRUYWJCdXR0b24oYWRkVGFiQnV0dG9uOiBib29sZWFuKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuYWRkVGFiQnV0dG9uID0gYWRkVGFiQnV0dG9uO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5hZGRUYWJCdXR0b24gPSBhZGRUYWJCdXR0b247XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogaWYgZGVmaW5lZCBhcyBhIGZ1bmN0aW9uLCB3aWxsIGJlIHVzZWQgaW4tcGxhY2Ugb2YgdGhlIGRlZmF1bHQgVGFiIEFkZGluZyBtZXRob2RcbiAgICogVE9ETzogaG93IHRvIGhhbmRsZSBjYWxsIGJhY2sgZnVuY3Rpb24/XG4gICAqL1xuICBASW5wdXQoKSBzZXQgYWRkVGFiQnV0dG9uQ2FsbGJhY2soYWRkVGFiQnV0dG9uQ2FsbGJhY2s6IEZ1bmN0aW9uKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuYWRkVGFiQnV0dG9uQ2FsbGJhY2sgPSBhZGRUYWJCdXR0b25DYWxsYmFjaztcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MuYWRkVGFiQnV0dG9uQ2FsbGJhY2sgPSBhZGRUYWJCdXR0b25DYWxsYmFjaztcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiBzZXQgdG8gdHJ1ZSwgd2lsbCBmb3JjZSBhbiBBcHAgTWVudSB0cmlnZ2VyIHRvIGJlIHByZXNlbnQgb24gTm9uLVZlcnRpY2FsIFRhYnMgaW1wbGVtZW50YXRhdGlvbnMuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgYXBwTWVudVRyaWdnZXIoYXBwTWVudVRyaWdnZXI6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl90YWJzT3B0aW9ucy5hcHBNZW51VHJpZ2dlciA9IGFwcE1lbnVUcmlnZ2VyO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5hcHBNZW51VHJpZ2dlciA9IGFwcE1lbnVUcmlnZ2VyO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIElmIGRlZmluZWQsIHJlcGxhY2VzIHRoZSBkZWZhdWx0IFwiTWVudVwiIHRleHQgdXNlZCBpbiB0aGUgYXBwIG1lbnUgdHJpZ2dlci5cbiAgICovXG4gIEBJbnB1dCgpIHNldCBhcHBNZW51VHJpZ2dlclRleHQoYXBwTWVudVRyaWdnZXJUZXh0OiBzdHJpbmcpIHtcbiAgICB0aGlzLl90YWJzT3B0aW9ucy5hcHBNZW51VHJpZ2dlclRleHQgPSBhcHBNZW51VHJpZ2dlclRleHQ7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmFwcE1lbnVUcmlnZ2VyVGV4dCA9IGFwcE1lbnVUcmlnZ2VyVGV4dDtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiAgSWYgdHJ1ZSwgY2F1c2VzIGFuIGFwcCBtZW51IHRyaWdnZXIncyB0ZXh0IGNvbnRlbnQgdG8gYmUgdmlzdWFsbHkgaGlkZGVuIChidXQgc3RpbGwgZXhpc3RzIGZvciBhY2Nlc3NpYmxpdHkgcHVycG9zZXMpXG4gICAqL1xuICBASW5wdXQoKSBzZXQgYXBwTWVudVRyaWdnZXJUZXh0QXVkaWJsZShhcHBNZW51VHJpZ2dlclRleHRBdWRpYmxlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuYXBwTWVudVRyaWdnZXJUZXh0QXVkaWJsZSA9IGFwcE1lbnVUcmlnZ2VyVGV4dEF1ZGlibGU7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmFwcE1lbnVUcmlnZ2VyVGV4dEF1ZGlibGUgPSBhcHBNZW51VHJpZ2dlclRleHRBdWRpYmxlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqICBJZiBkZWZpbmVkLCB3aWxsIGJlIHVzZWQgYnkgYW55IGludGVybmFsIFRhYnMgQUpBWCBjYWxscyBhcyB0aGUgZGVzaXJlZCByZXF1ZXN0IHNldHRpbmdzLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGFqYXhPcHRpb25zKGFqYXhPcHRpb25zOiBvYmplY3QpIHtcbiAgICB0aGlzLl90YWJzT3B0aW9ucy5hamF4T3B0aW9ucyA9IGFqYXhPcHRpb25zO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5hamF4T3B0aW9ucyA9IGFqYXhPcHRpb25zO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlZmluZXMgYSBzZXBhcmF0ZSBlbGVtZW50IHRvIGJlIHVzZWQgZm9yIGNvbnRhaW5pbmcgdGhlIHRhYiBwYW5lbHMuICBEZWZhdWx0cyB0byB0aGUgVGFiIENvbnRhaW5lciBpdHNlbGZcbiAgICovXG4gIEBJbnB1dCgpIHNldCBjb250YWluZXJFbGVtZW50KGNvbnRhaW5lckVsZW1lbnQ6IHN0cmluZykge1xuICAgIHRoaXMuX3RhYnNPcHRpb25zLmNvbnRhaW5lckVsZW1lbnQgPSBjb250YWluZXJFbGVtZW50O1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5jb250YWluZXJFbGVtZW50ID0gY29udGFpbmVyRWxlbWVudDtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0cnVlLCB3aWxsIGNoYW5nZSB0aGUgc2VsZWN0ZWQgdGFiIG9uIGludm9jYXRpb24gYmFzZWQgb24gdGhlIFVSTCB0aGF0IGV4aXN0cyBhZnRlciB0aGUgaGFzaFxuICAgKlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGNoYW5nZVRhYk9uSGFzaENoYW5nZShjaGFuZ2VUYWJPbkhhc2hDaGFuZ2U6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl90YWJzT3B0aW9ucy5jaGFuZ2VUYWJPbkhhc2hDaGFuZ2UgPSBjaGFuZ2VUYWJPbkhhc2hDaGFuZ2U7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmNoYW5nZVRhYk9uSGFzaENoYW5nZSA9IGNoYW5nZVRhYk9uSGFzaENoYW5nZTtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiBkZWZpbmVkIGFzIGEgZnVuY3Rpb24sIHByb3ZpZGVzIGFuIGV4dGVybmFsIG1ldGhvZCBmb3IgYWRqdXN0aW5nIHRoZSBjdXJyZW50IHBhZ2UgaGFzaCB1c2VkIGJ5IHRoZXNlIHRhYnNcbiAgICogVE9ETzogaG93IHRvIGhhbmRsZSBjYWxsIGJhY2sgZnVuY3Rpb24/XG4gICAqL1xuICBASW5wdXQoKSBzZXQgaGFzaENoYW5nZUNhbGxiYWNrKGhhc2hDaGFuZ2VDYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICB0aGlzLl90YWJzT3B0aW9ucy5oYXNoQ2hhbmdlQ2FsbGJhY2sgPSBoYXNoQ2hhbmdlQ2FsbGJhY2s7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmhhc2hDaGFuZ2VDYWxsYmFjayA9IGhhc2hDaGFuZ2VDYWxsYmFjaztcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0cnVlLCB3aGVuIHVzaW5nIGZ1bGwgVVJMcyBpbiB0YWIgSFJFRnMsIG9yIHdoZW4gdXNpbmcgQWpheCBjYWxscywgdGFicyB3aWxsIGJlIGxvYWRlZCBhcyBuZWVkZWQgaW5zdGVhZCBvZiB0aGUgbWFya3VwXG4gICAqIGFsbCBiZWluZyBlc3RhYmxpc2hlZCBhdCBvbmNlLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IGxhenlMb2FkKGxhenlMb2FkOiBib29sZWFuKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMubGF6eUxvYWQgPSBsYXp5TG9hZDtcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MubGF6eUxvYWQgPSBsYXp5TG9hZDtcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0cnVlLCB3aWxsIGRpc3BsYXkgYSB0b29sdGlwIG9yIE1vZHVsZSBUYWJzIHdpdGggY3V0LW9mZiB0ZXh0IGNvbnRlbnQuXG4gICAqL1xuICBASW5wdXQoKSBzZXQgbW9kdWxlVGFic1Rvb2x0aXBzKG1vZHVsZVRhYnNUb29sdGlwczogYm9vbGVhbikge1xuICAgIHRoaXMuX3RhYnNPcHRpb25zLm1vZHVsZVRhYnNUb29sdGlwcyA9IG1vZHVsZVRhYnNUb29sdGlwcztcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MubW9kdWxlVGFic1Rvb2x0aXBzID0gbW9kdWxlVGFic1Rvb2x0aXBzO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHdpbGwgZGlzcGxheSBhIHRvb2x0aXAgb24gTXVsdGkgVGFicyB3aXRoIGN1dC1vZmYgdGV4dCBjb250ZW50LlxuICAgKi9cbiAgQElucHV0KCkgc2V0IG11bHRpVGFic1Rvb2x0aXBzKG11bHRpVGFic1Rvb2x0aXBzOiBib29sZWFuKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMubXVsdGlUYWJzVG9vbHRpcHMgPSBtdWx0aVRhYnNUb29sdGlwcztcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MubXVsdGlUYWJzVG9vbHRpcHMgPSBtdWx0aVRhYnNUb29sdGlwcztcbiAgICAgIHRoaXMudXBkYXRlUmVxdWlyZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZiBkZWZpbmVkLCBpdCB3aWxsIGRpc3BsYXkgdGhlIHBvc2l0aW9uIG9mIGNvdW50cy5cbiAgICovXG4gIEBJbnB1dCgpIHNldCBjb3VudHNQb3NpdGlvbihjb3VudHNQb3NpdGlvbjogdW5kZWZpbmVkIHwgJ3RvcCcgfCAnYm90dG9tJykge1xuICAgIHRoaXMuX3RhYnNPcHRpb25zLmNvdW50c1Bvc2l0aW9uID0gY291bnRzUG9zaXRpb247XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmNvdW50c1Bvc2l0aW9uID0gY291bnRzUG9zaXRpb247XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSWYgZGVmaW5lZCwgd2lsbCBzZXJ2ZSBhcyBhIHdheSBvZiBwdWxsaW5nIGluIGV4dGVybmFsIGNvbnRlbnQgdG8gZmlsbCB0YWJzLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IHNvdXJjZShzb3VyY2U6IEZ1bmN0aW9uKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuc291cmNlID0gc291cmNlO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSWYgYSBzb3VyY2UgbWV0aG9kIGlzIGRlZmluZWQsIHRoaXMgZmxleGlibGUgb2JqZWN0IGNhbiBiZSBwYXNzZWQgaW50byB0aGUgc291cmNlIG1ldGhvZCwgYW5kIGF1Z21lbnRlZCB3aXRoXG4gICAqIHBhcmFtZXRlcnMgc3BlY2lmaWMgdG8gdGhlIGltcGxlbWVudGF0aW9uLlxuICAgKi9cbiAgQElucHV0KCkgc2V0IHNvdXJjZUFyZ3VtZW50cyhzb3VyY2VBcmd1bWVudHM6IEZ1bmN0aW9uKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuc291cmNlQXJndW1lbnRzID0gc291cmNlQXJndW1lbnRzO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy5zb3VyY2VBcmd1bWVudHMgPSBzb3VyY2VBcmd1bWVudHM7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogc2V0IHRvIHRydWUgdG8gYWxsb3cgdGFiIGNvdW50IG1hcmt1cCA8c3BhbiBjbGFzcz10YWJjb3VudD4jPC9zcGFuPi5cbiAgICpcbiAgICovXG4gIEBJbnB1dCgpIHNldCB0YWJDb3VudHModGFiQ291bnRzOiBib29sZWFuKSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMudGFiQ291bnRzID0gdGFiQ291bnRzO1xuICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICh0aGlzLnRhYnMgYXMgYW55KS5zZXR0aW5ncy50YWJDb3VudHMgPSB0YWJDb3VudHM7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSWYgVmVydGljYWwgVGFicyAmIHRydWUsIHdpbGwgYXV0b21hdGljYWxseSBzd2l0Y2ggdG8gSG9yaXpvbnRhbCBUYWJzIG9uIHNtYWxsZXIgYnJlYWtwb2ludHMuXG4gICAqXG4gICAqL1xuICBASW5wdXQoKSBzZXQgdmVydGljYWxSZXNwb25zaXZlKHZlcnRpY2FsUmVzcG9uc2l2ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3RhYnNPcHRpb25zLnZlcnRpY2FsUmVzcG9uc2l2ZSA9IHZlcnRpY2FsUmVzcG9uc2l2ZTtcbiAgICBpZiAodGhpcy5qUXVlcnlFbGVtZW50KSB7XG4gICAgICAodGhpcy50YWJzIGFzIGFueSkuc2V0dGluZ3MudmVydGljYWxSZXNwb25zaXZlID0gdmVydGljYWxSZXNwb25zaXZlO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIEFkZCBleHRyYSBhdHRyaWJ1dGVzIGxpa2UgaWQncyB0byB0aGUgY29tcG9uZW50ICoqL1xuICBASW5wdXQoKSBzZXQgYXR0cmlidXRlcyhhdHRyaWJ1dGVzOiBBcnJheTxPYmplY3Q+IHwgT2JqZWN0KSB7XG4gICAgdGhpcy5fdGFic09wdGlvbnMuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgICAgdGhpcy51cGRhdGVSZXF1aXJlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgLyoqIFNldHMgdGhlIHRhYnMgdG8gYmUgc29ydGFibGUgYnkgZHJhZyBhbmQgZHJvcC4gKiovXG4gIEBJbnB1dCgpIHNldCBzb3J0YWJsZShzb3J0YWJsZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3RhYnNPcHRpb25zLnNvcnRhYmxlID0gc29ydGFibGU7XG4gICAgaWYgKHRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgKHRoaXMudGFicyBhcyBhbnkpLnNldHRpbmdzLnNvcnRhYmxlID0gc29ydGFibGU7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogaWYgeW91IHdvdWxkIGxpa2UgdG8gcnVuIHRoZSB1cGRhdGVkKCkgZnVuY3Rpb24geW91cnNlbGYgaW5zdGVhZCBvZiBoYXZpbmdcbiAgICogdGhpcyB0YWJzIGNvbXBvbmVudCBjaGVjayBmb3IgeW91IHNldCB0aGlzIGlucHV0IHRvIHRydWUuIFRoZSBhZHZhbnRhZ2UgdG9cbiAgICogdGhpcyBpcyB0aGF0IGlmIHlvdSBrbm93IHdoZW4gdG8gdXBkYXRlIHlvdSBjYW4gYmUgbW9yZSBlZmZpY2llbnQuXG4gICAqL1xuICBASW5wdXQoKSBkaXNhYmxlQXV0b1VwZGF0ZWRDYWxsID0gZmFsc2U7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEBPdXRwdXRzXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8qKlxuICAgKiBUaGUgYmVmb3JlYWN0aXZhdGVkIGV2ZW50IGlzIGZpcmVkIHdoZW5ldmVyIGEgdGFiIGlzIHNlbGVjdGVkIGdpdmluZyB0aGUgZXZlbnQgaGFuZGxlciBhIGNoYW5jZVxuICAgKiB0byBcInZldG9cIiB0aGUgdGFiIHNlbGVjdGlvbiBjaGFuZ2UuXG4gICAqXG4gICAqL1xuICBAT3V0cHV0KCkgYmVmb3JlQWN0aXZhdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvVGFic0V2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBUaGUgYmVmb3JlYWN0aXZhdGUgZXZlbnQgaXMgZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBgYmVmb3JlYWN0aXZhdGVkYC5cbiAgICpcbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIEBPdXRwdXQoKSBiZWZvcmVBY3RpdmF0ZSA9IG5ldyBEZXByZWNhdGVkRXZlbnRFbWl0dGVyPFNvaG9UYWJzRXZlbnQ+KCdiZWZvcmVhY3RpdmF0ZScsICdiZWZvcmVhY3RpdmF0ZWQnKTtcblxuICAvKipcbiAgICogVGhlIGFjdGl2YXRlZCBldmVudCBpcyBmaXJlZCB3aGVuZXZlciBhIHRhYiBpcyBzZWxlY3RlZCAob3IgXCJhY3RpdmF0ZWRcIik7XG4gICAqL1xuICBAT3V0cHV0KCkgYWN0aXZhdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvVGFic0V2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBUaGUgYWZ0ZXJhY3RpdmF0ZSBldmVudCBpcyBmaXJlZCBhZnRlciB0aGUgaGFzIGJlZW4gYWN0aXZhdGVkLlxuICAgKi9cbiAgQE91dHB1dCgpIGFmdGVyQWN0aXZhdGVkID0gbmV3IEV2ZW50RW1pdHRlcjxTb2hvVGFic0V2ZW50PigpO1xuXG4gIC8qKlxuICAgKiBmaXJlZCBiZWZvcmUgYSB0YWIgY2xvc2VzXG4gICAqL1xuICBAT3V0cHV0KCkgYmVmb3JlQ2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9UYWJzRXZlbnQ+KCk7XG5cbiAgLyoqXG4gICAqIGZpcmVkIHdoZW4gYSB0YWIgY2xvc2VzXG4gICAqXG4gICAqIEB0b2RvIHJlcGxhY2Ugb3ZlcnJpZGUgb2YgbmF0aXZlIGVsZW1lbnRcbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8tb3V0cHV0LW5hdGl2ZVxuICBAT3V0cHV0KCkgY2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9UYWJzRXZlbnQ+KCk7XG5cbiAgLyoqXG4gICAqIGZpcmVkIGFmdGVyIGEgdGFiIGNsb3Nlc1xuICAgKi9cbiAgQE91dHB1dCgpIGFmdGVyQ2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9UYWJzRXZlbnQ+KCk7XG5cbiAgLyoqXG4gICAqIGZpcmUgd2hlbiBhIG5ldyB0YWIgaXMgYWRkZWQuXG4gICAqXG4gICAqL1xuICBAT3V0cHV0KCkgdGFiQWRkZWQgPSBuZXcgRXZlbnRFbWl0dGVyPFNvaG9UYWJzRXZlbnQ+KCk7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gUmVmZXJlbmNlIHRvIHRoZSBqUXVlcnkgY29udHJvbC5cbiAgcHJpdmF0ZSBqUXVlcnlFbGVtZW50PzogSlF1ZXJ5O1xuXG4gIC8vIFJlZmVyZW5jZSB0byB0aGUgc29obyB0YWJzIGNvbnRyb2wgYXBpLlxuICBwcml2YXRlIHRhYnM/OiBTb2hvVGFic1N0YXRpYyB8IG51bGw7XG5cbiAgLy8gQW4gaW50ZXJuYWwgdGFic09wdGlvbnMgb2JqZWN0IHRoYXQgZ2V0cyB1cGRhdGVkIGJ5IHVzaW5nXG4gIC8vIHRoZSBjb21wb25lbnQncyBJbnB1dHMoKVxuICBwcml2YXRlIF90YWJzT3B0aW9uczogU29ob1RhYnNPcHRpb25zID0ge30gYXMgU29ob1RhYnNPcHRpb25zO1xuXG4gIC8qKlxuICAgKiBLZWVwIHRyYWNrIG9mIGN1cnJlbnQgdGFiIGNvbnRlbnQgZm9yIGNoYW5nZSBkZXRlY3Rpb24uXG4gICAqIElmIHRoZSBudW1iZXIgb2YgdGFiIGNoYW5nZSB3ZSBtdXN0IGNhbGwgdGFicy51cGRhdGVkKCkgdG9cbiAgICogcmVidWlsZCB0ZWgganF1ZXJ5IHRhYiBjb250cm9sLCBpZiBvbmx5IHRoZSB0aXRsZXMgY2hhbmdlZFxuICAgKiB0aGVuIHdlIGNhbiBjYWxsIHRhYnMuaGFuZGxlUmVzaXplIHRvIHVwZGF0ZSB0aGUgc2VsZWN0aW9uXG4gICAqIHN0eWxlIGFuZCB0aGUgb3ZlcmZsb3cuXG4gICAqIE5PVEU6IG9ubHkgdXNlZCB3aGVuIGRpc2FibGVBdXRvVXBkYXRlZENhbGwgaXMgZmFsc2VcbiAgICovXG4gIHByaXZhdGUgdGFiQ291bnQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE5PVEU6IG9ubHkgdXNlZCB3aGVuIGRpc2FibGVBdXRvVXBkYXRlZENhbGwgaXMgZmFsc2VcbiAgICovXG4gIHByaXZhdGUgdGFiSWRzPzogQXJyYXk8c3RyaW5nPjtcblxuICAvKipcbiAgICogTk9URTogb25seSB1c2VkIHdoZW4gZGlzYWJsZUF1dG9VcGRhdGVkQ2FsbCBpcyBmYWxzZVxuICAgKi9cbiAgcHJpdmF0ZSB0YWJUaXRsZXM/OiBBcnJheTxzdHJpbmc+O1xuXG4gIC8qKlxuICAgKiBzZXQgdG8gdHJ1ZSB3aGVuIEBpbnB1dCBjaGFuZ2VzLiBUaGlzIHdpbGwgY2F1c2UgdGhlIHRhYnMudXBkYXRlZCBjYWxsXG4gICAqIGluIHRoZSBhZnRlclZpZXdDaGVja2VkLiBUaGlzIHRlY2huaXF1ZSBoYXMgdGhlIGFkdmFudGFnZSBvZiBvbmx5IGNhbGxpbmdcbiAgICogdXBkYXRlZCBvbmNlIGluIHRoZSBjdXJyZW50IGFuZ3VsYXIgY3ljbGUgbm8gbWF0dGVyIGhvdyBtYW55IGlucHV0cyBhcmVcbiAgICogY2hhbmdlZCBkdXJpbmcgdGhhdCBjeWNsZS5cbiAgICovXG4gIHByaXZhdGUgdXBkYXRlUmVxdWlyZWQgPSBmYWxzZTtcblxuICAvKipcbiAgICogQ29uc3RydWN0b3IuXG4gICAqXG4gICAqIEBwYXJhbSBlbGVtZW50UmVmIC0gdGhlIGVsZW1lbnQgbWF0Y2hpbmcgdGhlIGNvbXBvbmVudCdzIHNlbGVjdG9yLlxuICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgX2NoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcbiAgKSB7XG4gICAgLy8gQWRkaW5nIHRoZSBjbGFzcyB0aGlzIHdheSB0byBlbnN1cmUgdGhhdCBpdCBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgQWZ0ZXJWaWV3SW5pdC5cbiAgICAvLyBBdm9pZGluZyBASG9zdEJpbmRpbmcgZm9yIHRoaXMgc2luY2UgYW4gKm5nSWYgY2F1c2VzIGJpbmRpbmdzIHRvIGJlIHByb2Nlc3NlZFxuICAgIC8vIGFmdGVyIHRoZSBBZnRlclZpZXdJbml0XG4gICAgZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3RhYi1jb250YWluZXInKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgLy8gYXNzaWduIGVsZW1lbnQgdG8gbG9jYWwgdmFyaWFibGVcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudCA9IGpRdWVyeSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIC8vIGJpbmQgdG8ganF1ZXJ5IGV2ZW50cyBhbmQgZW1pdCBhcyBhbmd1bGFyIGV2ZW50c1xuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9uKCdiZWZvcmVhY3RpdmF0ZWQnLCAoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYikgPT4gdGhpcy5vbkJlZm9yZUFjdGl2YXRlZChldmVudCwgdGFiKSk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ2FjdGl2YXRlZCcsIChldmVudDogU29ob1RhYnNFdmVudCwgdGFiKSA9PiB0aGlzLm9uQWN0aXZhdGVkKGV2ZW50LCB0YWIpKTtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignYWZ0ZXJhY3RpdmF0ZWQnLCAoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYikgPT4gdGhpcy5vbkFmdGVyQWN0aXZhdGVkKGV2ZW50LCB0YWIpKTtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignYmVmb3JlY2xvc2UnLCAoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYikgPT4gdGhpcy5vbkJlZm9yZUNsb3NlKGV2ZW50LCB0YWIpKTtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignY2xvc2UnLCAoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYikgPT4gdGhpcy5vbkNsb3NlKGV2ZW50LCB0YWIpKTtcbiAgICAgIHRoaXMualF1ZXJ5RWxlbWVudC5vbignYWZ0ZXJjbG9zZScsIChldmVudDogU29ob1RhYnNFdmVudCwgdGFiKSA9PiB0aGlzLm9uQWZ0ZXJDbG9zZShldmVudCwgdGFiKSk7XG4gICAgICB0aGlzLmpRdWVyeUVsZW1lbnQub24oJ3RhYi1hZGRlZCcsIChldmVudDogU29ob1RhYnNFdmVudCwgdGFiKSA9PiB0aGlzLm9uVGFiQWRkZWQoZXZlbnQsIHRhYikpO1xuXG4gICAgICAvLyBpbml0aWFsaXplIHRoZSB0YWJzIHBsdWdpblxuICAgICAgdGhpcy5qUXVlcnlFbGVtZW50LnRhYnModGhpcy5fdGFic09wdGlvbnMpO1xuICAgICAgdGhpcy50YWJzID0gdGhpcy5qUXVlcnlFbGVtZW50LmRhdGEoJ3RhYnMnKTtcblxuICAgICAgdGhpcy51cGRhdGVUYWJJbmZvKCk7XG4gICAgfSk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnRhYnMgfHwgIXRoaXMualF1ZXJ5RWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnVwZGF0ZVJlcXVpcmVkKSB7XG4gICAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLnRhYnM/LnVwZGF0ZWQoKSk7XG4gICAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGlzYWJsZUF1dG9VcGRhdGVkQ2FsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBjb25zdCAkbGlMaXN0ID0gdGhpcy5nZXRUYWJMaUxpc3QoKTtcbiAgICAgIGNvbnN0ICRhY3RpdmF0ZVRhYiA9IHRoaXMuZ2V0QWN0aXZhdGVkVGFiKCk7XG5cbiAgICAgIGlmICghJGxpTGlzdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhYlRpdGxlcyA9IHRoaXMuZ2V0VGFiVGl0bGVzKCRsaUxpc3QpO1xuICAgICAgaWYgKCF0YWJUaXRsZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0YWJJZHMgPSB0aGlzLmdldFRhYklkcygpO1xuICAgICAgaWYgKCF0YWJJZHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy50YWJDb3VudCAhPT0gJGxpTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgLyogTXVzdCByZWJ1aWxkIHRoZSB0YWIgY29udHJvbCBpZiB0aGUgdGFiIGNvdW50IGNoYW5nZXMgKi9cbiAgICAgICAgdGhpcy50YWJzPy51cGRhdGVkKCk7XG4gICAgICAgIHRoaXMudGFiQ291bnQgPSAkbGlMaXN0Lmxlbmd0aDtcbiAgICAgICAgdGhpcy50YWJUaXRsZXMgPSB0aGlzLmdldFRhYlRpdGxlcygkbGlMaXN0KTtcbiAgICAgICAgdGhpcy50YWJJZHMgPSB0YWJJZHM7XG4gICAgICAgIHRoaXMuYWN0aXZhdGVUYWIoJGFjdGl2YXRlVGFiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhYklkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodGhpcy50YWJJZHMgJiYgdGFiSWRzW2ldICE9PSB0aGlzLnRhYklkc1tpXSkge1xuICAgICAgICAgIHRoaXMudGFicz8udXBkYXRlZCgpO1xuICAgICAgICAgIHRoaXMudGFiSWRzID0gdGFiSWRzO1xuICAgICAgICAgIHRoaXMudGFiVGl0bGVzID0gdGhpcy5nZXRUYWJUaXRsZXMoJGxpTGlzdCk7XG4gICAgICAgICAgdGhpcy5hY3RpdmF0ZVRhYigkYWN0aXZhdGVUYWIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKlxuICAgICAgICogaWYgb25seSB0YWIgdGl0bGVzIGNoYW5nZSB0aGVuIGNhbGwgaGFuZGxlUmVzaXplLlxuICAgICAgICogSXQgd2lsbCB1cGRhdGUgdGhlIHRhYnMgc2VsZWN0aW9uIHN0eWxlIGFuZCB0aGUgb3ZlcmZsb3dcbiAgICAgICAqL1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0YWJUaXRsZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKHRoaXMudGFiVGl0bGVzICYmIHRhYlRpdGxlc1tqXSAhPT0gdGhpcy50YWJUaXRsZXNbal0pIHtcbiAgICAgICAgICB0aGlzLnRhYnM/LmhhbmRsZVJlc2l6ZSgpO1xuICAgICAgICAgIHRoaXMudGFiVGl0bGVzID0gdGFiVGl0bGVzO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvbiBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLmpRdWVyeUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5qUXVlcnlFbGVtZW50Lm9mZigpO1xuICAgICAgICB0aGlzLmpRdWVyeUVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy50YWJzKSB7XG4gICAgICAgIHRoaXMudGFicy5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMudGFicyA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVRhYkluZm8oKSB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZUF1dG9VcGRhdGVkQ2FsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gYXV0byB1cGRhdGUgdGhlIGNvbnRyb2wgd2hlbiBwcm9qZWN0ZWQgY29udGVudCBjaGFuZ2VzLiBVc2Ugd2lzZWx5XG4gICAgICogYXMgdGhpcyBjYW4gYmUgc2xvd2VyIHRoYW4gbm9ybWFsLlxuICAgICAqL1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGNvbnN0ICRsaUxpc3Q6IGFueSB8IEpRdWVyeSA9IHRoaXMuZ2V0VGFiTGlMaXN0KCk7XG4gICAgICB0aGlzLnRhYkNvdW50ID0gJGxpTGlzdC5sZW5ndGg7XG4gICAgICB0aGlzLnRhYlRpdGxlcyA9IHRoaXMuZ2V0VGFiVGl0bGVzKCRsaUxpc3QpO1xuICAgICAgdGhpcy50YWJJZHMgPSB0aGlzLmdldFRhYklkcygpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUYWJMaUxpc3QoKSB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc2luY2UgYW5ndWxhciBkb2Vzbid0IG5lZWQgdG8ga25vdyBhYm91dCB0aGlzLlxuICAgIHJldHVybiB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLmpRdWVyeUVsZW1lbnQ/LmZpbmQoJy50YWItbGlzdCcpLmZpbmQoJ2xpJykpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRBY3RpdmF0ZWRUYWIoKTogSlF1ZXJ5IHwgdW5kZWZpbmVkIHtcbiAgICAvLyBnZXQgdGhlIGN1cnJlbnQgc2VsZWN0ZWQgdGFiIG91dHNpZGUgb2YgdGhlIGFuZ3VsYXIgem9uZVxuICAgIHJldHVybiB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLmpRdWVyeUVsZW1lbnQ/LnNpYmxpbmdzKCcudGFiLXBhbmVsLWNvbnRhaW5lcicpLmZpbmQoJy50YWItcGFuZWwuaXMtdmlzaWJsZScpKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VGFiSWRzKCk6IEFycmF5PHN0cmluZz4ge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICByZXR1cm4gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgY29uc3QgYW5jaG9yTGlzdCA9IHRoaXMualF1ZXJ5RWxlbWVudD8uZmluZCgnLnRhYi1saXN0JykuZmluZCgnYScpLnRvQXJyYXkoKTtcbiAgICAgIHJldHVybiAoYW5jaG9yTGlzdCBhcyBhbnkpLm1hcCgoYW5jaG9yOiBhbnkpID0+IChhbmNob3IgYXMgYW55KS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKS5zdWJzdHJpbmcoMSkpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUYWJUaXRsZXMoJGxpTGlzdD86IEpRdWVyeSk6IEFycmF5PHN0cmluZz4ge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lXG4gICAgcmV0dXJuIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGlmICghJGxpTGlzdCkge1xuICAgICAgICAkbGlMaXN0ID0gdGhpcy5nZXRUYWJMaUxpc3QoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGFiVGl0bGVzOiBBcnJheTxzdHJpbmc+ID0gW107XG4gICAgICBjb25zdCAkYW5jaG9yTGlzdDogYW55IHwgSlF1ZXJ5ID0gJGxpTGlzdD8uZmluZCgnYScpO1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVmZXItZm9yLW9mXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICRhbmNob3JMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRhYlRpdGxlcy5wdXNoKCQoJGFuY2hvckxpc3RbaV0pLmh0bWwoKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFiVGl0bGVzO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhdXNlcyB0aGUgdGFicyBjb21wb25lbnQgdmlldyB0byBiZSByZWJ1aWx0XG4gICAqL1xuICBwdWJsaWMgdXBkYXRlZCgpOiB2b2lkIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy50YWJzPy51cGRhdGVkKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB0YWIgVGhlIHRhYiBlbGVtZW50IGluIHRoZSBsaXN0IHRoYXQgbmVlZHMgdG8gYmUgYWN0aXZhdGVkXG4gICAqIEByZXR1cm5zIFxuICAgKi9cbiAgcHVibGljIGFjdGl2YXRlVGFiKHRhYjogSlF1ZXJ5IHwgdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGlmICghdGFiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGFiSHJlZiA9IGAjJHt0YWI/LmF0dHIoJ2lkJyl9YDtcbiAgICAgIHRoaXMudGFicz8uYWN0aXZhdGUodGFiSHJlZik7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCByZXNpemUgbWFudWFsbHkgd2hlbiB0YWIgdGl0bGVzIGNoYW5nZSBzbyB0aGF0IHRoZSB1bmRlcmxpbmUgd2lkdGggbWF0Y2hlcy5cbiAgICovXG4gIHB1YmxpYyBoYW5kbGVSZXNpemUoZG9SZXNwb25zaXZlQ2hlY2s/OiBib29sZWFuKTogdm9pZCB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvbiBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMudGFicz8uaGFuZGxlUmVzaXplKGRvUmVzcG9uc2l2ZUNoZWNrKSk7XG4gIH1cblxuICAvKipcbiAgICogTWFudWFsbHkgY2FsbCB1cGRhdGVkIGFuZCByZWZyZXNoIG91dCBvZiB0aGUgem9uZS5cbiAgICovXG4gIHB1YmxpYyByZWZyZXNoKCk6IHZvaWQge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnRhYnM/LnVwZGF0ZWQoKTtcbiAgICAgIH0sIDEpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBuZXcgdGFiIGludG8gdGhlIHRhYiBjb21wb25lbnRcbiAgICpcbiAgICogQHBhcmFtIHRhYklkIFRoZSB0YWJJZCBvZiB0aGUgdGFiIHRvIGJlIGFkZGVkXG4gICAqIEBwYXJhbSBvcHRpb25zID9cbiAgICogQHBhcmFtIGF0SW5kZXggVGhlIGluZGV4IGxvY2F0aW9uIHdoZXJlIHRoZSB0YWIgaXMgdG8gYmUgYWRkZWQuXG4gICAqL1xuICBwdWJsaWMgYWRkKHRhYklkOiBzdHJpbmcsIG9wdGlvbnM6IGFueSwgYXRJbmRleDogbnVtYmVyKTogdm9pZCB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvbiBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMudGFicz8uYWRkKHRhYklkLCBvcHRpb25zLCBhdEluZGV4KSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIHRhYlxuICAgKlxuICAgKiBAcGFyYW0gdGFiSWQgVGhlIHRhYklkIG9mIHRoZSB0YWIgdG8gYmUgcmVtb3ZlZC5cbiAgICogQHBhcmFtIGRpc2FibGVCZWZvcmVDbG9zZSBJZiB0cnVlLCB0aGUgYmVmb3JlQ2xvc2UgY2FsbGJhY2sgc2hvdWxkIGJlIGNhbGxlZFxuICAgKiBiZWZvcmUgcmVtb3ZpbmcgdGhlIHRhYi5cbiAgICovXG4gIHJlbW92ZSh0YWJJZDogc3RyaW5nLCBkaXNhYmxlQmVmb3JlQ2xvc2U/OiBib29sZWFuKTogdm9pZCB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvbiBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHRoaXMudGFicz8ucmVtb3ZlKHRhYklkLCBkaXNhYmxlQmVmb3JlQ2xvc2UpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRlcyBhIHRhYiBmb3IgdGhlIGdpdmVuIHRhYklkXG4gICAqXG4gICAqIEBwYXJhbSB0YWJJZCBUaGUgaWQgb2YgdGhlIHRhYiB0byBoaWRlXG4gICAqL1xuICBoaWRlKHRhYklkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy50YWJzPy5oaWRlKHRhYklkKSk7XG4gIH1cblxuICBzaG93KHRhYklkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy50YWJzPy5zaG93KHRhYklkKSk7XG4gIH1cblxuICBkaXNhYmxlVGFiKHRhYklkOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy50YWJzPy5kaXNhYmxlVGFiKHRhYklkKSk7XG4gIH1cblxuICBlbmFibGVUYWIodGFiSWQ6IG51bWJlcik6IHZvaWQge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLnRhYnM/LmVuYWJsZVRhYih0YWJJZCkpO1xuICB9XG5cbiAgcmVuYW1lKHRhYklkOiBzdHJpbmcsIG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB0aGlzLnRhYnM/LnJlbmFtZSh0YWJJZCwgbmFtZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgYSB0YWIgZ2l2ZW4gZWl0aGVyIGFuIGV2ZW50IG9yIGEgdGFiSWRcbiAgICpcbiAgICogQHBhcmFtIGV2ZW50IEFuZCBldmVudCBmcm9tIGEgdGFiIHRoYXQgd2lsbCBhbGxvdyB0YWIgcmV0cmlldmFsXG4gICAqIEBwYXJhbSB0YWJJZCBUaGUgdGFiSWQgb2YgdGhlIHRhYiB0byBiZSByZXRyaWV2ZWQuXG4gICAqL1xuICBnZXRUYWIoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYklkOiBzdHJpbmcpOiBhbnkge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICAvLyBUT0RPOiBnZXRUYWIgc2VlbXMgdG8gcmV0dXJuIGEgalF1ZXJ5IG9iamVjdCwgd2hhdCB0byByZXR1cm4gaW5zdGVhZD9cbiAgICByZXR1cm4gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gdGhpcy50YWJzPy5nZXRUYWIoZXZlbnQsIHRhYklkKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBjdXJyZW5sdHkgYWN0aXZlL3NlbGVjdGVkIHRhYi5cbiAgICpcbiAgICogQHJldHVybiAgQSBKUXVlcnkgb2JqZWN0IG9mIHRoZSBhY3RpdmUgdGFiIGVsZW1lbnQuXG4gICAqL1xuICBnZXRBY3RpdmVUYWIoKTogSlF1ZXJ5IHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgLy8gVE9ETzogZ2V0QWN0aXZlVGFiIHNlZW1zIHRvIHJldHVybiBhIGpRdWVyeSBvYmplY3QsIHdoYXQgdG8gcmV0dXJuIGluc3RlYWQ/XG4gICAgcmV0dXJuIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+ICh0aGlzLnRhYnMgYXMgYW55KS5nZXRBY3RpdmVUYWIoKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdmlzaWJsZSB0YWJzXG4gICAqXG4gICAqIEByZXR1cm4gIEFuIGFycmF5IG9mIEpRdWVyeSBvYmplY3RzIG9mIHRoZSB2aXNpYmxlIHRhYiBlbGVtZW50c1xuICAgKi9cbiAgZ2V0VmlzaWJsZVRhYnMoKTogQXJyYXk8SlF1ZXJ5PiB7XG4gICAgLy8gY2FsbCBvdXRzaWRlIHRoZSBhbmd1bGFyIHpvbmUgc28gY2hhbmdlIGRldGVjdGlvbiBpc24ndCB0cmlnZ2VyZWQgYnkgdGhlIHNvaG8gY29tcG9uZW50LlxuICAgIC8vIFRPRE86IGdldFZpc2libGVUYWJzIHNlZW1zIHRvIHJldHVybiBhIGpRdWVyeSBhcnJheSwgd2hhdCB0byByZXR1cm4gaW5zdGVhZD9cbiAgICByZXR1cm4gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gKHRoaXMudGFicyBhcyBhbnkpLmdldFZpc2libGVUYWJzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIG92ZXJmbG93IHRhYnNcbiAgICpcbiAgICogQHJldHVybiAgQW4gYXJyYXkgb2YgSlF1ZXJ5IG9iamVjdHMgb2YgdGhlIG92ZXJmbG93IHRhYiBlbGVtZW50c1xuICAgKi9cbiAgZ2V0T3ZlcmZsb3dUYWJzKCk6IEFycmF5PEpRdWVyeT4ge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICAvLyBUT0RPOiBnZXRWaXNpYmxlVGFicyBzZWVtcyB0byByZXR1cm4gYSBqUXVlcnkgYXJyYXksIHdoYXQgdG8gcmV0dXJuIGluc3RlYWQ/XG4gICAgcmV0dXJuIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+ICh0aGlzLnRhYnMgYXMgYW55KS5nZXRPdmVyZmxvd1RhYnMoKSk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyB0aGUgdGFiIGdpdmVuIGFuIGhyZWZcbiAgICpcbiAgICogQHBhcmFtIGhyZWYgYW4gaHJlZiB1c2VkIHRvIGZpbmQgdGhlIHRhYiB0byBzZWxlY3RcbiAgICovXG4gIHNlbGVjdChocmVmOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAvLyBjYWxsIG91dHNpZGUgdGhlIGFuZ3VsYXIgem9uZSBzbyBjaGFuZ2UgZGV0ZWN0aW9uIGlzbid0IHRyaWdnZXJlZCBieSB0aGUgc29obyBjb21wb25lbnQuXG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4gKHRoaXMudGFicyBhcyBhbnkpLnNlbGVjdChocmVmKSk7XG4gIH1cblxuICAvKipcbiAgICogRGlzYWJsZXMgdGhlIGVudGlyZSB0YWIgY29tcG9uZW50XG4gICAqL1xuICBkaXNhYmxlKCk6IHZvaWQge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiAodGhpcy50YWJzIGFzIGFueSkuZGlzYWJsZSgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBlbmFibGVzIHRoZSBlbnRpcmUgdGFiIGNvbXBvbmVudFxuICAgKi9cbiAgZW5hYmxlKCk6IHZvaWQge1xuICAgIC8vIGNhbGwgb3V0c2lkZSB0aGUgYW5ndWxhciB6b25lIHNvIGNoYW5nZSBkZXRlY3Rpb24gaXNuJ3QgdHJpZ2dlcmVkIGJ5IHRoZSBzb2hvIGNvbXBvbmVudC5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiAodGhpcy50YWJzIGFzIGFueSkuZW5hYmxlKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkJlZm9yZUFjdGl2YXRlZChldmVudDogU29ob1RhYnNFdmVudCwgdGFiOiBhbnkpIHtcbiAgICAvLyBlbnN1cmUgd2UgYXJlIGJhY2sgaW4gdGhlIGFuZ3VsYXIgem9uZVxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICBldmVudC50YWIgPSB0YWJbMF07XG4gICAgICB0aGlzLmJlZm9yZUFjdGl2YXRlZC5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgb25BY3RpdmF0ZWQoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYjogYW55KSB7XG4gICAgLy8gZW5zdXJlIHdlIGFyZSBiYWNrIGluIHRoZSBhbmd1bGFyIHpvbmVcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgZXZlbnQudGFiID0gdGFiWzBdO1xuICAgICAgdGhpcy5hY3RpdmF0ZWQuZW1pdChldmVudCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9uQWZ0ZXJBY3RpdmF0ZWQoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYjogYW55KSB7XG4gICAgLy8gZW5zdXJlIHdlIGFyZSBiYWNrIGluIHRoZSBhbmd1bGFyIHpvbmVcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgZXZlbnQudGFiID0gdGFiWzBdO1xuICAgICAgdGhpcy5hZnRlckFjdGl2YXRlZC5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgb25CZWZvcmVDbG9zZShldmVudDogU29ob1RhYnNFdmVudCwgdGFiOiBhbnkpIHtcbiAgICAvLyBlbnN1cmUgd2UgYXJlIGJhY2sgaW4gdGhlIGFuZ3VsYXIgem9uZVxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICBldmVudC50YWIgPSB0YWJbMF07XG4gICAgICB0aGlzLmJlZm9yZUNsb3NlLmVtaXQoZXZlbnQpO1xuXG4gICAgICBpZiAodGhpcy5iZWZvcmVDbG9zZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJlZm9yZUNsb3NlQ2FsbGJhY2soZXZlbnQsIHRhYik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9uQ2xvc2UoZXZlbnQ6IFNvaG9UYWJzRXZlbnQsIHRhYjogYW55KSB7XG4gICAgLy8gZW5zdXJlIHdlIGFyZSBiYWNrIGluIHRoZSBhbmd1bGFyIHpvbmVcbiAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgZXZlbnQudGFiID0gdGFiWzBdO1xuICAgICAgdGhpcy5jbG9zZS5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgb25BZnRlckNsb3NlKGV2ZW50OiBTb2hvVGFic0V2ZW50LCB0YWI6IGFueSkge1xuICAgIC8vIGVuc3VyZSB3ZSBhcmUgYmFjayBpbiB0aGUgYW5ndWxhciB6b25lXG4gICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgIGV2ZW50LnRhYiA9IHRhYlswXTtcbiAgICAgIHRoaXMuYWZ0ZXJDbG9zZS5lbWl0KGV2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgb25UYWJBZGRlZChldmVudDogU29ob1RhYnNFdmVudCwgdGFiOiBhbnkpIHtcbiAgICAvLyBlbnN1cmUgd2UgYXJlIGJhY2sgaW4gdGhlIGFuZ3VsYXIgem9uZVxuICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XG4gICAgICBldmVudC50YWIgPSB0YWJbMF07XG4gICAgICB0aGlzLnRhYkFkZGVkLmVtaXQoZXZlbnQpO1xuICAgIH0pO1xuICB9XG59XG4iXX0=